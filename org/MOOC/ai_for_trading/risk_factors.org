#+TITLE: Risk Factors
#+OPTIONS: H:3 toc:2 num:2 ^:nil
#+AUTHOR: ChrisChen
#+EMAIL: ChrisChen3121@gmail.com
* Goal
  The goal of a risk factor model is to measure, control and possibly neutralize a portfolio's exposure to major sources of risk.
   [[../../resources/MOOC/Trading/risk_model_goal.png]]

* Types of Risk Models
  - Time Series Risk Model
    - Capital Asset Pricing Model
    - Fama French 3 Factor Model(multifactor)
  - Cross-Sectional Risk Model
  - PCA Risk Model

** CAPM model
   - Single Factor: $f=r_m-r_f$
   - Linear Regression Model: $r_i-r_f=\beta_{i,1}(r_m-r_f)+c_i$
   [[../../resources/MOOC/Trading/CAPM_model.png]]

* Time Series Risk Factor Model
** Steps
   1. Calculate the factor return and factor *covariance matrix*.
   1. Use regression(not settled science) to estimate *factor exposure matrix*.
   1. Calculate the time series for the specific return(residual) and its *variance matrix* (not settled science).
   1. Calculate the variance of portfolio.

   Reference: Lesson 25 1,2,3,4

** Factor Model of Asset Return
  - 1 stock, 1 factor
  [[../../resources/MOOC/Trading/simple_risk_factor_model.png]]
  - 1 stock, K factors
  [[../../resources/MOOC/Trading/risk_multifactor_model.png]]

** Factor Model of Portfolio Return
   - Factor exposures of each stock to Factor "k"
     $$\beta_{1,k},\beta_{2,k},...,\beta_{N,k}$$
   - Stock weights in portfolio
     $$x_1,x_2,...,x_N$$
   - Factor exposures of portfolio to Factor "k" (so-called *Contribution of Factors*)
     $$\beta_{p,k}=(x_1\times\beta_{1,k})+(x_2\times\beta_{2,k})+\cdots+(x_N\times\beta_{\beta_{N,k}})=\sum_{i=1}^N(x_i\times\beta_{i,k})$$
   - Modeling portfolio return
     $$r_p=(\beta_{p,1}\times f_1)+(\beta_{p,2}\times f_2)+\cdots+(\beta_{p,k}\times f_k)+s_p$$
     $$r_p=\sum_{k=1}^{K}(\beta_{p,k}\times f_k)+\sum_{i=1}^N(x_i\times s_{i})$$

** Variance of One Asset Return
   $$\begin{align*}
   Var(r_i) & = Var(\beta_{i,1}f_1 + \beta_{i,2}f_2+s_i) \\
   & = Var(\beta_{i,1}f_1) + Var(\beta_{i,2}f_2) + 2Cov(\beta_{i,1}f_1, \beta_{i,2}f_2) + Var(s_i) \\
   & = \beta_{i,1}^2 Var(f_1) + \beta_{i,2}^2 Var(f_2) + 2\beta_{i,1}\beta_{i,2}Cov(f_1, f_2) + Var(s_i)
   \end{align*}$$

   - Systematic Variance: $\beta_{i,1}^2 Var(f_1) + \beta_{i,2}^2 Var(f_2) + 2\beta_{i,1}\beta_{i,2}Cov(f_1, f_2)$
   - Specific Variance: $Var(s_i)$

** Variance of Two Asset Return
   - $Cov(r_i, r_j)$
     $$\begin{align*}
     Cov(r_i, r_j) & = Cov(\beta_{i,1}f_1 + \beta_{i,2}f_2+s_i, \beta_{j,1}f_1 + \beta_{j,2}f_2 + s_j) \\
     & = \beta_{i,1}\beta_{j,1}Var(f_1) + \beta_{i,1}\beta_{j,2}Cov(f_1, f_2) + \beta_{i,2}\beta_{j,1}Cov(f_1, f_2) + \beta_{i,2}\beta_{j,2}Var(f_2)
     \end{align*}$$
     [[../../resources/MOOC/Trading/cov_of_two_explaination.png]]

   - Covariance Matrix of Assets
     $$\begin{pmatrix}
     Var(r_i) & Cov(r_i, r_j) \\
     Cov(r_i, r_j) & Var(r_j)
     \end{pmatrix}$$


** Factor Model of Portfolio Variance
   $$Var(r_p)=x_i^2 Var(r_i) + x_j^2 Var(r_j) + 2x_i x_j Cov(r_i, j_i)$$
   [[../../resources/MOOC/Trading/var_of_p_return_process.png]]
   $$Var(r_p)=\boldsymbol{X^T(BFB^T+S)X}$$
   [[../../resources/MOOC/Trading/factor_model_portfolio_var.png]]


* Cross-Sectional Risk Model
* PCA Risk Model
