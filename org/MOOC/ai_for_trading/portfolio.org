#+TITLE: Portfolio
#+OPTIONS: H:2 toc:2 num:2 ^:nil
#+AUTHOR: ChrisChen
#+EMAIL: ChrisChen3121@gmail.com
* Cumulative Returns
  Two ways to calculate cumulative returns
** Using Returns
   #+begin_src python
     returns = prices / prices.shift(1) - 1
     returns = returns.fillna(0) # opntional
     cum_returns = (returns + 1).cumprod()
     cum_return = cum_returns.iloc[-1] - 1
   #+end_src

** Using Log Returns
   #+begin_src python
     import numpy as np
     log_returns = np.log(prices) - np.log(prices.shift(1))
     log_returns = log_returns.fillna(0) # optional
     cum_log_returns = log_returns.cumsum()
     cum_return = np.exp(cum_log_returns.iloc[-1]) - 1
   #+end_src

* Relative Returns
  - Fund Returns - Benchmark Returns
  - For Active Fund: *Active Returns*
  - For Passive Fund: *Tracking Error*

** Tracking Error
   Operationalize the tracking error.
   #+begin_src python
     import numpy as np
     excess_returns = portfolio_returns - benchmark_returns
     daily_tracking_errors = excess_returns.std(ddof=1)
     annualized_tracking_error = np.sqrt(252) *  daily_tracking_errors
   #+end_src

* Absolute Returns
  - Benchmark: Cash Interest Rate e.g. US Treasury, LIBOR
  - Because the benchmark is relatively small, Hedge funds are evaluated by their performance alone.

* Covariance Matrix
  $$P=\begin{bmatrix}
  Cov(r_A, r_A) & Cov(r_A, r_B) \\
  Cov(r_B, r_A) & Cov(r_B, r_B)
  \end{bmatrix}$$

  covariance is:
  $$\begin{align*}
  Cov(r_A, r_B) &= E[(r_A-\bar{r_A})(r_B-\bar{r_B})] \\
  & = \frac{1}{n-1}\sum_{i=1}^n(r_{Ai}-\bar{r_A})(r_{Bi}-\bar{r_B}) \\
  & = \frac{1}{n-1}\sum_{i=1}^{n}r_{Ai}r_{Bi}\text{ (if }\bar{r_A}=\bar{r_B}=0\text{)} \\
  & = \frac{1}{n-1}\boldsymbol{r}_A^T \boldsymbol{r}_B
  \end{align*}$$

  $$\boldsymbol{r}^T\boldsymbol{r} = \begin{bmatrix}
  \cdots & \boldsymbol{r}_A & \cdots \\
  \cdots & \boldsymbol{r}_B & \cdots \end{bmatrix}\begin{bmatrix}
  \vdots & \vdots \\
  \boldsymbol{r}_A & \boldsymbol{r}_B \\
  \vdots & \vdots\end{bmatrix} = \begin{bmatrix}
  \boldsymbol{r}_A^T \boldsymbol{r}_A & \boldsymbol{r}_A^T \boldsymbol{r}_B \\
  \boldsymbol{r}_B^T \boldsymbol{r}_A & \boldsymbol{r}_B^T \boldsymbol{r}_B \\
  \end{bmatrix}
  $$

  So if each vector of observations in your data matrix has mean 0, the covariance matrix is:
  $$\frac{1}{n-1}\boldsymbol{r}_T\boldsymbol{r}$$

* Summary
  - Portfolio Expected Return
  $$\mu_P=\sum_{i=1}^{N}w_i \mu_i=\boldsymbol{w^T\mu}$$
  - Portfolio Variance
  $$\sigma_P^2=\sum_{i=1}^N\sum_{j=1}^N w_i Cov(r_i, r_j)w_j=\boldsymbol{w^TPx}$$
  - $P_x$ is the covariance matrix.
