<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
<!-- 2021-09-09 Thu 22:31 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>elisp</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="ChrisChen" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
	     margin-bottom: .2em; }
  .subtitle { text-align: center;
	      font-size: medium;
	      font-weight: bold;
	      margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
	    padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://gongzhitaao.org/orgcss/org.css">
</head>
<body>
<div id="content">
<h1 class="title">elisp</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org9bc4492">1. Basic</a>
<ul>
<li><a href="#orgfdf012b">1.1. Char Representation</a></li>
<li><a href="#orgce6db98">1.2. Symbol</a></li>
<li><a href="#orgd1c5ff0">1.3. Sequence</a></li>
<li><a href="#org54090f9">1.4. Special Forms</a></li>
<li><a href="#org9110597">1.5. defs</a></li>
<li><a href="#org9f1c6cd">1.6. examples</a></li>
<li><a href="#org63c7384">1.7. Function Pointer[#']</a></li>
</ul>
</li>
<li><a href="#orgbaa7fb1">2. Print &amp; Read</a>
<ul>
<li><a href="#org6fe18e6">2.1. Print</a></li>
<li><a href="#orgabc41b7">2.2. Read</a></li>
<li><a href="#orgbde1212">2.3. <code>terpri</code> newline</a></li>
</ul>
</li>
<li><a href="#orgc71a994">3. Code &amp; Data</a></li>
<li><a href="#org05520ed">4. List</a>
<ul>
<li><a href="#orgaabc4d1">4.1. List Functions</a></li>
<li><a href="#org1eec3c8">4.2. Dotted List</a></li>
<li><a href="#orgfab4908">4.3. Circular Lists</a></li>
<li><a href="#org86d5d04">4.4. Association List(alist)</a></li>
</ul>
</li>
<li><a href="#org27ef3dd">5. Data Structures</a>
<ul>
<li><a href="#orgf73a5fc">5.1. Arrays</a></li>
<li><a href="#orgb48f54d">5.2. Hash Tables</a></li>
<li><a href="#org8c713d3">5.3. Return Multiple Values</a></li>
<li><a href="#org60838cd">5.4. Structure(OOP)</a></li>
</ul>
</li>
<li><a href="#orgd3451e1">6. Generic Functions</a>
<ul>
<li><a href="#org1881594">6.1. Creating Generic Functions</a></li>
</ul>
</li>
<li><a href="#orgdb34f7b">7. Functional Programming</a>
<ul>
<li><a href="#org9f3f249">7.1. Pros</a></li>
<li><a href="#org179df2a">7.2. Cons</a></li>
<li><a href="#orgb477b7e">7.3. Summary</a></li>
</ul>
</li>
<li><a href="#org403683d">8. Meta Programming</a>
<ul>
<li><a href="#orge1bebe4">8.1. Quasiquoting[`]</a></li>
<li><a href="#org44ed074">8.2. Macro programming</a></li>
</ul>
</li>
<li><a href="#orge08d0de">9. Useful Functions &amp; Marcos</a>
<ul>
<li><a href="#org7d5350f">9.1. Generic Functions</a></li>
<li><a href="#org73b4a58">9.2. conditionals</a></li>
<li><a href="#org4f23a25">9.3. <code>push/assoc</code> idiom</a></li>
<li><a href="#orgbb0a0c5">9.4. <code>loop</code> Macro</a></li>
<li><a href="#orga5bafc8">9.5. <code>format</code> function</a></li>
</ul>
</li>
<li><a href="#org407c94f">10. Profiling</a></li>
<li><a href="#orga55c312">11. Loading Process</a>
<ul>
<li><a href="#org3dff1ed">11.1. autoload</a></li>
<li><a href="#orgb3f072c">11.2. Eval after load</a></li>
<li><a href="#org861b869">11.3. use-package</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org9bc4492" class="outline-2">
<h2 id="org9bc4492"><span class="section-number-2">1</span> Basic</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgfdf012b" class="outline-3">
<h3 id="orgfdf012b"><span class="section-number-3">1.1</span> Char Representation</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li><code>?\U, ?\u, ?\x, ?\101</code></li>
<li><code>?^I, ?\C-I, ?\M-I ?\S-I</code></li>
</ul>
</div>
</div>

<div id="outline-container-orgce6db98" class="outline-3">
<h3 id="orgce6db98"><span class="section-number-3">1.2</span> Symbol</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Symbols are a fundamental type of data in Lisp and are used extensively. A
symbol in Lisp is a stand-alone word.
</p>
</div>
<div id="outline-container-orge66556e" class="outline-4">
<h4 id="orge66556e">Creating Symbols</h4>
<div class="outline-text-4" id="text-orge66556e">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>symbol-name 'foo<span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">returns a newly-allocated, uninterned symbol whose name is NAME (which must be a string)</span>
<span style="color: #3a81c3;">(</span>make-symbol <span style="color: #2d9574;">"foo"</span><span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">returns the interned symbol.  If OBARRAY is omitted, the value of the global variable 'obarray' is used</span>
<span style="color: #3a81c3;">(</span>intern <span style="color: #2d9574;">"foo"</span> other-obarray<span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">returns the symbol in OBARRAY whose name is NAME, or&#8216;</span><span style="color: #4e3163; background-color: #ecf3ec;">nil</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8217; if OBARRAY has no symbol with that name.</span>
<span style="color: #3a81c3;">(</span>intern-soft <span style="color: #2d9574;">"foo"</span><span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">map on obarray</span>
<span style="color: #3a81c3;">(</span>mapatoms functions <span style="color: #ba2f59; font-weight: bold;">&amp;optional</span> obarray<span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">deletes SYMBOL from the obarray OBARRAY</span>
<span style="color: #3a81c3;">(</span>unintern symbol obarray<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org41fa4f0" class="outline-4">
<h4 id="org41fa4f0">Special Symbols</h4>
<div class="outline-text-4" id="text-org41fa4f0">
<p>
<code>'nil</code>, <code>'t</code>
</p>
</div>
</div>
</div>
<div id="outline-container-orgd1c5ff0" class="outline-3">
<h3 id="orgd1c5ff0"><span class="section-number-3">1.3</span> Sequence</h3>
<div class="outline-text-3" id="text-1-3">
<p>
an ordered set of elements
</p>
</div>
<div id="outline-container-org9693784" class="outline-4">
<h4 id="org9693784">lists</h4>
<div class="outline-text-4" id="text-org9693784">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>eq <span style="color: #6c3163;">()</span> nil<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; t</span>
<span style="color: #3a81c3;">(</span>A 2 <span style="color: #2d9574;">"A"</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">A list of three elements.</span>
</pre>
</div>
<p>
A cons cell is made for each element.  The CAR slot of the cons cell holds
the element, and its CDR slot refers to the next cons cell of the list, which
holds the next element in the list. The CDR slot of the last cons cell is set
to hold 'nil'.
</p>
</div>
</div>
</div>
<div id="outline-container-org54090f9" class="outline-3">
<h3 id="org54090f9"><span class="section-number-3">1.4</span> Special Forms</h3>
<div class="outline-text-3" id="text-1-4">
<p>
Special forms are something like built-in macros, examples: <code>if</code>, <code>progn</code>
</p>
</div>
</div>

<div id="outline-container-org9110597" class="outline-3">
<h3 id="org9110597"><span class="section-number-3">1.5</span> defs</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li><code>defconst</code>: <code>defconst symbol value [doc-string]</code>, should not be changed by the user or by other programs.</li>
<li><code>defvar</code>: <code>defvar symbol [value [doc-string]]</code>, define global variables</li>
<li><code>defun</code>: define global functions</li>
<li><code>let</code>: define local variables</li>
<li><code>flet</code>: define local functions</li>
<li><code>defstruct</code></li>
<li><code>cl-defgeneric</code>: replacement for <code>defmethod</code>, define generic functions</li>
</ul>
</div>
</div>

<div id="outline-container-org9f1c6cd" class="outline-3">
<h3 id="org9f1c6cd"><span class="section-number-3">1.6</span> examples</h3>
<div class="outline-text-3" id="text-1-6">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">bar</span> 23
  <span style="color: #da8b55;">"The normal weight of a bar."</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">defconst</span> <span style="color: #715ab1;">float-pi</span> 3.141592653589793
  <span style="color: #da8b55;">"The value of Pi."</span><span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(let ((variable value)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;;       </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(variable value)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;;       </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8230;)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;;   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">body&#8230;)</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #6c3163;">(</span><span style="color: #2d9574;">(</span>a 5<span style="color: #2d9574;">)</span>
      <span style="color: #2d9574;">(</span>b 6<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span>
  <span style="color: #6c3163;">(</span>+ a b<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(flet ((function_name (arguments)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;;                       </span><span style="color: #2aa1ae; background-color: #ecf3ec;">...function body...))</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;;   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">...body...)</span>
<span style="color: #3a81c3;">(</span>flet <span style="color: #6c3163;">(</span><span style="color: #2d9574;">(</span>f <span style="color: #67b11d;">(</span>n<span style="color: #67b11d;">)</span>
	  <span style="color: #67b11d;">(</span>+ n 10<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
       <span style="color: #2d9574;">(</span>g <span style="color: #67b11d;">(</span>n<span style="color: #67b11d;">)</span>
	  <span style="color: #67b11d;">(</span>- n 3<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span>
  <span style="color: #6c3163;">(</span>g <span style="color: #2d9574;">(</span>f 5<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org63c7384" class="outline-3">
<h3 id="org63c7384"><span class="section-number-3">1.7</span> Function Pointer[#']</h3>
<div class="outline-text-3" id="text-1-7">
<p>
<code>#'sqrt</code> will be converted to <code>(function sqrt)</code> by Lisp reader
</p>
</div>
</div>
</div>

<div id="outline-container-orgbaa7fb1" class="outline-2">
<h2 id="orgbaa7fb1"><span class="section-number-2">2</span> Print &amp; Read</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org6fe18e6" class="outline-3">
<h3 id="org6fe18e6"><span class="section-number-3">2.1</span> Print</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li><code>print</code>: computer-friendly print</li>
<li><code>prin1</code>: like <code>print</code> but not print <code>#/newline</code></li>
<li><code>princ</code>: human-friendly print</li>
<li><code>prin1-to-string</code></li>
</ul>
</div>
</div>

<div id="outline-container-orgabc41b7" class="outline-3">
<h3 id="orgabc41b7"><span class="section-number-3">2.2</span> Read</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li><code>read</code>: computer-friendly read</li>
<li><code>read-line</code>: human-friendly read(common lisp)</li>
</ul>
</div>
</div>
<div id="outline-container-orgbde1212" class="outline-3">
<h3 id="orgbde1212"><span class="section-number-3">2.3</span> <code>terpri</code> newline</h3>
</div>
</div>
<div id="outline-container-orgc71a994" class="outline-2">
<h2 id="orgc71a994"><span class="section-number-2">3</span> Code &amp; Data</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre class="src src-elisp">'<span style="color: #3a81c3;">(</span>+ 1 2<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">;</span><span style="color: #2aa1ae; background-color: #ecf3ec;">data mode</span>
<span style="color: #3a81c3;">(</span>+ 1 2<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">;</span><span style="color: #2aa1ae; background-color: #ecf3ec;">code mode</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">*foo*</span> '<span style="color: #6c3163;">(</span>+ 1 2<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>eval *foo*<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org05520ed" class="outline-2">
<h2 id="org05520ed"><span class="section-number-2">4</span> List</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orgaabc4d1" class="outline-3">
<h3 id="orgaabc4d1"><span class="section-number-3">4.1</span> List Functions</h3>
<div class="outline-text-3" id="text-4-1">
</div>
<div id="outline-container-org9af7aed" class="outline-4">
<h4 id="org9af7aed"><code>cons</code></h4>
<div class="outline-text-4" id="text-org9af7aed">
<p>
When you call <code>cons</code>, the Lisp compiler typically allocates a small chunk of memory, the <code>cons cell</code>,
that can hold two references to the objects being linked.
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>cons 'chicken 'cat<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; (CHICKEN . CAT) The dot in the middle makes this a cons cell</span>
<span style="color: #3a81c3;">(</span>cons 'chicken 'nil<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; (CHICKEN) nil is a special symbol that is used to terminate a list in Lisp</span>
<span style="color: #3a81c3;">(</span>cons 'chicken <span style="color: #6c3163;">()</span><span style="color: #3a81c3;">)</span>   <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; (CHICKEN)</span>
<span style="color: #3a81c3;">(</span>cons 'pork '<span style="color: #6c3163;">(</span>beef chicken<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>                 <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; (PORK BEEF CHICKEN)</span>
<span style="color: #3a81c3;">(</span>cons 'pork <span style="color: #6c3163;">(</span>cons 'beef <span style="color: #2d9574;">(</span>cons 'chicken <span style="color: #67b11d;">()</span><span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; what is really happening underneath</span>

</pre>
</div>
<p>
<b>In Lisp, a chain of cons cells and a list are exactly the same thing.</b>
</p>
</div>
</div>

<div id="outline-container-orga3e0a75" class="outline-4">
<h4 id="orga3e0a75"><code>car</code> and <code>cdr</code></h4>
<div class="outline-text-4" id="text-orga3e0a75">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>car '<span style="color: #6c3163;">(</span>pork beef chicken<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>              <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; PORK</span>
<span style="color: #3a81c3;">(</span>cdr '<span style="color: #6c3163;">(</span>pork beef chicken<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>              <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; (BEEF CHICKEN)</span>
<span style="color: #3a81c3;">(</span>car <span style="color: #6c3163;">(</span>cdr '<span style="color: #2d9574;">(</span>pork beef chicken<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>        <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; BEEF</span>
<span style="color: #3a81c3;">(</span>cadr '<span style="color: #6c3163;">(</span>pork beef chicken<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>             <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; BEEF shortcut</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf593059" class="outline-4">
<h4 id="orgf593059">others</h4>
<div class="outline-text-4" id="text-orgf593059">
<p>
For convenience, Common Lisp has many functions built on top of the basic three,
<code>cons</code>, <code>car</code>, and <code>cdr</code>
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>list 'pork 'beef 'chicken<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">does the dirty work of creating all the cons cells</span>
'<span style="color: #3a81c3;">(</span>pork beef chiken<span style="color: #3a81c3;">)</span>         <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">the same</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org1eec3c8" class="outline-3">
<h3 id="org1eec3c8"><span class="section-number-3">4.2</span> Dotted List</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-org69d68a4" class="outline-4">
<h4 id="org69d68a4">a list without nil</h4>
<div class="outline-text-4" id="text-org69d68a4">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>cons 1 <span style="color: #6c3163;">(</span>cons 2 3<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; (1 2 . 3)</span>
</pre>
</div>
<p>
This dot is basically Lisp’s way of saying, “I tried to print this structure you entered
using list notation, but the last item in the list didn’t contain the usual nil I expected;
instead, it contained 3.
</p>
</div>
</div>

<div id="outline-container-org83f6a89" class="outline-4">
<h4 id="org83f6a89">alternative syntax for <code>cons</code></h4>
<div class="outline-text-4" id="text-org83f6a89">
<p>
Another way of thinking about this dot notation is to consider it as simply an
alternate syntax for the cons command
</p>
<div class="org-src-container">
<pre class="src src-elisp">'<span style="color: #3a81c3;">(</span>1 . <span style="color: #6c3163;">(</span>2 . <span style="color: #2d9574;">(</span>3 . nil<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; (1 2 3)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0a0ccd8" class="outline-4">
<h4 id="org0a0ccd8">elegant represent pairs</h4>
<div class="outline-text-4" id="text-org0a0ccd8">
<p>
<code>(cons 2 3)</code> -&gt; <code>(2 . 3)</code>
</p>
</div>
</div>
</div>

<div id="outline-container-orgfab4908" class="outline-3">
<h3 id="orgfab4908"><span class="section-number-3">4.3</span> Circular Lists</h3>
<div class="outline-text-3" id="text-4-3">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>defparameter foo '<span style="color: #6c3163;">(</span>1 2 3<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">setf</span> <span style="color: #6c3163;">(</span>cdddr foo<span style="color: #6c3163;">)</span> foo<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org86d5d04" class="outline-3">
<h3 id="org86d5d04"><span class="section-number-3">4.4</span> Association List(alist)</h3>
<div class="outline-text-3" id="text-4-4">
<p>
They are not a very efficient way to store and retrieve data.
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">*dict*</span> '<span style="color: #6c3163;">(</span><span style="color: #2d9574;">(</span>key1 value1<span style="color: #2d9574;">)</span>
		 <span style="color: #2d9574;">(</span>key2 value2<span style="color: #2d9574;">)</span>
		 <span style="color: #2d9574;">(</span>key3 value3<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>

<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">push</span> '<span style="color: #6c3163;">(</span>key1 . value4<span style="color: #6c3163;">)</span> *dict*<span style="color: #3a81c3;">)</span>          <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">add new item to the front</span>
<span style="color: #3a81c3;">(</span>assoc 'key1 *dict*<span style="color: #3a81c3;">)</span>                    <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">to look up from the front and returns the first one</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org27ef3dd" class="outline-2">
<h2 id="org27ef3dd"><span class="section-number-2">5</span> Data Structures</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgf73a5fc" class="outline-3">
<h3 id="orgf73a5fc"><span class="section-number-3">5.1</span> Arrays</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">setf</span> primes <span style="color: #6c3163;">[</span>2 3 5 7 11 13<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>arrayp primes<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; T</span>
<span style="color: #3a81c3;">(</span>aref primes 1<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; 3</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">setf</span> <span style="color: #6c3163;">(</span>aref primes 1<span style="color: #6c3163;">)</span> 5<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">primes -&gt; [2 5 5 7 11 13]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb48f54d" class="outline-3">
<h3 id="orgb48f54d"><span class="section-number-3">5.2</span> Hash Tables</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">setf</span> x <span style="color: #6c3163;">(</span>make-hash-table<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>gethash 'nope x<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; nil</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">setf</span> <span style="color: #6c3163;">(</span>gethash 'nope x<span style="color: #6c3163;">)</span> 5<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8c713d3" class="outline-3">
<h3 id="org8c713d3"><span class="section-number-3">5.3</span> Return Multiple Values</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">foo</span> <span style="color: #6c3163;">()</span>
  <span style="color: #6c3163;">(</span>values 3 7<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>multiple-value-bind <span style="color: #6c3163;">(</span>a b<span style="color: #6c3163;">)</span> <span style="color: #6c3163;">(</span>foo<span style="color: #6c3163;">)</span> <span style="color: #6c3163;">(</span>* a b<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org60838cd" class="outline-3">
<h3 id="org60838cd"><span class="section-number-3">5.4</span> Structure(OOP)</h3>
<div class="outline-text-3" id="text-5-4">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>defstruct person name age gender<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">setf</span> john <span style="color: #6c3163;">(</span>make-person <span style="color: #3a81c3;">:name</span> <span style="color: #2d9574;">"john"</span>
			<span style="color: #3a81c3;">:age</span> 37
			<span style="color: #3a81c3;">:gender</span> <span style="color: #2d9574;">"male"</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>person-age john<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">setf</span> <span style="color: #6c3163;">(</span>person-age john<span style="color: #6c3163;">)</span> 38<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd3451e1" class="outline-2">
<h2 id="orgd3451e1"><span class="section-number-2">6</span> Generic Functions</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org1881594" class="outline-3">
<h3 id="org1881594"><span class="section-number-3">6.1</span> Creating Generic Functions</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">cl-defgeneric</span> <span style="color: #6c3163; font-weight: bold;">add</span> <span style="color: #6c3163;">(</span><span style="color: #2d9574;">(</span>a number<span style="color: #2d9574;">)</span> <span style="color: #2d9574;">(</span>b number<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span>
  <span style="color: #6c3163;">(</span>+ a b<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">cl-defgeneric</span> <span style="color: #6c3163; font-weight: bold;">add</span> <span style="color: #6c3163;">(</span><span style="color: #2d9574;">(</span>a list<span style="color: #2d9574;">)</span> <span style="color: #2d9574;">(</span>b list<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span>
  <span style="color: #6c3163;">(</span>append a b<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>add 3 4<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>add '<span style="color: #6c3163;">(</span>a b<span style="color: #6c3163;">)</span> '<span style="color: #6c3163;">(</span>c d<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgdb34f7b" class="outline-2">
<h2 id="orgdb34f7b"><span class="section-number-2">7</span> Functional Programming</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org9f3f249" class="outline-3">
<h3 id="org9f3f249"><span class="section-number-3">7.1</span> Pros</h3>
<div class="outline-text-3" id="text-7-1">
<ul class="org-ul">
<li>Reduces Bugs(no side effect)</li>
<li>More Compact</li>
<li>More Elegant(try to keep 80% function "clean")</li>
</ul>
</div>
</div>

<div id="outline-container-org179df2a" class="outline-3">
<h3 id="org179df2a"><span class="section-number-3">7.2</span> Cons</h3>
<div class="outline-text-3" id="text-7-2">
<p>
Performance has always been a huge concern with functional programs.
Functional programmers have developed optimization techniques that
can solve the vast majority of performance problems. These include
memoization, tail call optimization, lazy evaluation, and higher-order
programming
</p>
</div>

<div id="outline-container-org28f02cd" class="outline-4">
<h4 id="org28f02cd">Memoization</h4>
<div class="outline-text-4" id="text-org28f02cd">
<p>
Memoization makes use of closures. <b>Lexical variables</b> are used for memoization.
</p>
</div>
</div>

<div id="outline-container-org52f8715" class="outline-4">
<h4 id="org52f8715">Tail Call Optimization</h4>
<div class="outline-text-4" id="text-org52f8715">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">my-length</span> <span style="color: #6c3163;">(</span>lst<span style="color: #6c3163;">)</span>
  <span style="color: #6c3163;">(</span><span style="color: #3a81c3; font-weight: bold;">if</span> lst <span style="color: #2d9574;">(</span>1+ <span style="color: #67b11d;">(</span>my-length <span style="color: #b1951d;">(</span>cdr lst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span> 0<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">inefficient</span>

<span style="color: #3a81c3;">(</span>my-length '<span style="color: #6c3163;">(</span>a b c d<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>

<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">my-length</span> <span style="color: #6c3163;">(</span>lst<span style="color: #6c3163;">)</span>
  <span style="color: #6c3163;">(</span>labels <span style="color: #2d9574;">(</span><span style="color: #67b11d;">(</span>f <span style="color: #b1951d;">(</span>lst acc<span style="color: #b1951d;">)</span>
	      <span style="color: #b1951d;">(</span><span style="color: #3a81c3; font-weight: bold;">if</span> lst <span style="color: #3a81c3;">(</span>f <span style="color: #6c3163;">(</span>cdr lst<span style="color: #6c3163;">)</span>
			 <span style="color: #6c3163;">(</span>1+ acc<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #dc752f; background-color: #fbf8ef;">acc</span><span style="color: #b1951d; background-color: #fbf8ef;">)</span><span style="color: #67b11d; background-color: #fbf8ef;">)</span><span style="color: #2d9574; background-color: #fbf8ef;">)</span>
    <span style="color: #2d9574;">(</span>f lst 0<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>                         <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">tail call optimization</span>
</pre>
</div>
<p>
When a function in Lisp calls itself as its very last action, we call this action a <b>tail call</b>.
A smart Lisp compiler, when seeing a tail call, can then say to itself, “Hey, since I don’t need
to do anything more after calling f again, I can just go straight to f, without needing to put
the current program context on the stack.” This is actually similar to performing a a <b>longjmp</b> in C++.
</p>
</div>
</div>
</div>

<div id="outline-container-orgb477b7e" class="outline-3">
<h3 id="orgb477b7e"><span class="section-number-3">7.3</span> Summary</h3>
<div class="outline-text-3" id="text-7-3">
<ul class="org-ul">
<li>Programs written in the functional style always give the same result when they are given the same values in their arguments.</li>
<li>Functional programs do not contain side effects.</li>
<li>A good strategy for writing Lisp programs is to break them into a clean, functional part and a dirty, imperative part.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org403683d" class="outline-2">
<h2 id="org403683d"><span class="section-number-2">8</span> Meta Programming</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orge1bebe4" class="outline-3">
<h3 id="orge1bebe4"><span class="section-number-3">8.1</span> Quasiquoting[`]</h3>
<div class="outline-text-3" id="text-8-1">
<p>
Quasiquoting is a technique that allows you to insert small bits of computer
code into larger pieces of data.
</p>
<div class="org-src-container">
<pre class="src src-elisp">`<span style="color: #3a81c3;">(</span>there are ,<span style="color: #6c3163;">(</span>+ 1 4<span style="color: #6c3163;">)</span> apples<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; there are 5 apples</span>
`<span style="color: #3a81c3;">(</span>there are <span style="color: #6c3163;">(</span>+ 1 4<span style="color: #6c3163;">)</span> apples<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; there are (+ 1 4) apples</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org44ed074" class="outline-3">
<h3 id="org44ed074"><span class="section-number-3">8.2</span> Macro programming</h3>
<div class="outline-text-3" id="text-8-2">
</div>
<div id="outline-container-org2f83b70" class="outline-4">
<h4 id="org2f83b70">A Simple Macro</h4>
<div class="outline-text-4" id="text-org2f83b70">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #6c3163;">(</span><span style="color: #2d9574;">(</span>foo <span style="color: #67b11d;">(</span>+ 2 3<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span>
  <span style="color: #6c3163;">(</span>* foo foo<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>

<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">defmacro</span> <span style="color: #6c3163; font-weight: bold;">let1</span> <span style="color: #6c3163;">(</span>var val <span style="color: #ba2f59; font-weight: bold;">&amp;rest</span> body<span style="color: #6c3163;">)</span>
  `<span style="color: #6c3163;">(</span><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #2d9574;">(</span><span style="color: #67b11d;">(</span>,var ,val<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
     ,@body<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">get rid of the superfluous parentheses</span>

<span style="color: #3a81c3;">(</span>let1 foo <span style="color: #6c3163;">(</span>+ 2 3<span style="color: #6c3163;">)</span>
      <span style="color: #6c3163;">(</span>princ <span style="color: #2d9574;">"Lisp is awesome!"</span><span style="color: #6c3163;">)</span>
      <span style="color: #6c3163;">(</span>* foo foo<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>

<span style="color: #3a81c3;">(</span>macroexpand '<span style="color: #6c3163;">(</span>let1 foo <span style="color: #2d9574;">(</span>+ 2 3<span style="color: #2d9574;">)</span>
		    <span style="color: #2d9574;">(</span>* foo foo<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">for debug</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orge08d0de" class="outline-2">
<h2 id="orge08d0de"><span class="section-number-2">9</span> Useful Functions &amp; Marcos</h2>
<div class="outline-text-2" id="text-9">
<ul class="org-ul">
<li><code>ash</code>: shift</li>
<li><code>car</code>, <code>cdr</code>, <code>cons</code>, <code>cadr</code>, <code>cadadr</code>, &#x2026;</li>
<li><code>defvar</code>, <code>setq</code>, <code>setf</code>, <code>let</code></li>
<li><code>cl-flet</code>: defining local function, <code>cl-labels</code></li>
<li><code>()</code>, <code>'()</code>, <code>'nil</code>, <code>nil</code> are all false</li>
<li><code>mapcar</code>, <code>apply</code></li>
<li><code>substitute-if</code></li>
<li>set ops: <code>set-difference</code>, <code>intersection</code>, <code>remove-duplicates</code></li>
</ul>
</div>
<div id="outline-container-org7d5350f" class="outline-3">
<h3 id="org7d5350f"><span class="section-number-3">9.1</span> Generic Functions</h3>
<div class="outline-text-3" id="text-9-1">
<p>
<code>length</code>, <code>find-if</code>, <code>count</code>, <code>position</code>, <code>some</code>, <code>every</code>, <code>reduce</code>, <code>map/mapcar</code>
<code>subseq</code>, <code>sort</code>
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>length '<span style="color: #6c3163;">(</span>a b c<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>length <span style="color: #2d9574;">"blub"</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>find-if #'numberp '<span style="color: #6c3163;">(</span>a b 5 d<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>count 4 <span style="color: #6c3163;">[</span>1 4 4 5<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>some #'numberp '<span style="color: #6c3163;">(</span>a b 5 d<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>every #'numberp '<span style="color: #6c3163;">(</span>a b 5 d<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>map 'list <span style="color: #6c3163;">(</span><span style="color: #3a81c3; font-weight: bold;">lambda</span> <span style="color: #2d9574;">(</span>x<span style="color: #2d9574;">)</span> <span style="color: #2d9574;">(</span>* 2 x<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span> '<span style="color: #6c3163;">(</span>3 4 6 5 2<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>reduce #'+ '<span style="color: #6c3163;">(</span>3 4 6 5 2<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>subseq <span style="color: #2d9574;">"america"</span> 2 6<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>sort '<span style="color: #6c3163;">(</span>5 8 2 4 9 3 6<span style="color: #6c3163;">)</span> #'&lt;<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org73b4a58" class="outline-3">
<h3 id="org73b4a58"><span class="section-number-3">9.2</span> conditionals</h3>
<div class="outline-text-3" id="text-9-2">
<p>
<code>if</code>, <code>when</code>, <code>unless</code>, <code>cond</code>, <code>or</code>, <code>case</code>, <code>and</code>
</p>
</div>
<div id="outline-container-orgf41c35c" class="outline-4">
<h4 id="orgf41c35c"><code>when</code>, <code>unless</code></h4>
<div class="outline-text-4" id="text-orgf41c35c">
<p>
Eliminates the pain of <code>progn</code>
</p>
</div>
</div>
<div id="outline-container-org3f7f12f" class="outline-4">
<h4 id="org3f7f12f"><code>cond</code></h4>
<div class="outline-text-4" id="text-org3f7f12f">
<p>
The <code>cond</code> form is the classic way to do branching in
Lisp. Through the liberal use of parentheses, it allows for an
implicit <code>progn</code>, can handle more than one branch, and can even
evaluate several conditions in succession.
</p>
<ul class="org-ul">
<li>using last <code>t</code> condition to guarantee that at least the last
branch will be evaluated.</li>
</ul>
</div>
</div>
<div id="outline-container-org0f43fdb" class="outline-4">
<h4 id="org0f43fdb"><code>case</code></h4>
<div class="outline-text-4" id="text-org0f43fdb">
<ul class="org-ul">
<li><code>otherwise</code> like <code>default</code> in other language</li>
</ul>
</div>
</div>

<div id="outline-container-orged5e49e" class="outline-4">
<h4 id="orged5e49e"><code>eq</code>, <code>equal</code>, etc.</h4>
<div class="outline-text-4" id="text-orged5e49e">
<ul class="org-ul">
<li><code>eq</code>: reference comparison</li>
<li><code>equal</code>: content comparison (look the same)</li>
<li><code>eql</code>: like <code>eq</code>, but handles comparisons of numbers and characters (compare these types by value)</li>
<li><code>equalp</code>:like <code>equal</code>, and it can compare strings with different capitalizations and</li>
</ul>
<p>
can compare integers against floating-point numbers
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>equal 'apple 'apple<span style="color: #3a81c3;">)</span>                   <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; T</span>
<span style="color: #3a81c3;">(</span>equal <span style="color: #6c3163;">(</span>list 1 2 3<span style="color: #6c3163;">)</span>
       <span style="color: #6c3163;">(</span>list 1 2 3<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>                    <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; T</span>
<span style="color: #3a81c3;">(</span>eq <span style="color: #6c3163;">(</span>list 1 2 3<span style="color: #6c3163;">)</span>
    <span style="color: #6c3163;">(</span>list 1 2 3<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>                       <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; NIL</span>
<span style="color: #3a81c3;">(</span>eq 3.4 3.4<span style="color: #3a81c3;">)</span>                            <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; NIL</span>
<span style="color: #3a81c3;">(</span>eql 3.4 3.4<span style="color: #3a81c3;">)</span>                           <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; T</span>
<span style="color: #3a81c3;">(</span>equalp <span style="color: #2d9574;">"Bob Smith"</span> <span style="color: #2d9574;">"bob smith"</span><span style="color: #3a81c3;">)</span>        <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; T strange!</span>
<span style="color: #3a81c3;">(</span>equalp 0 0.0<span style="color: #3a81c3;">)</span>                          <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; T</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4f23a25" class="outline-3">
<h3 id="org4f23a25"><span class="section-number-3">9.3</span> <code>push/assoc</code> idiom</h3>
<div class="outline-text-3" id="text-9-3">
<p>
The <code>assoc</code> command always returns the first item it finds in a list. Using
the <code>push</code> and <code>assoc</code> commands together allows us to pretend that values in
an alist are changing, while still preserving old values(keep history of all
old values).
</p>
</div>
</div>

<div id="outline-container-orgbb0a0c5" class="outline-3">
<h3 id="orgbb0a0c5"><span class="section-number-3">9.4</span> <code>loop</code> Macro</h3>
<div class="outline-text-3" id="text-9-4">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>loop for i from 2 below 5 sum i<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>loop for i in '<span style="color: #6c3163;">(</span>100 20 3<span style="color: #6c3163;">)</span> sum i<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">(</span>loop for i below 5 do <span style="color: #6c3163;">(</span>print i<span style="color: #6c3163;">)</span> sum i<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">do other things</span>
<span style="color: #3a81c3;">(</span>loop for i below 10 when <span style="color: #6c3163;">(</span>oddp i<span style="color: #6c3163;">)</span> sum i<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">do when ...</span>
<span style="color: #3a81c3;">(</span>loop for i from 0
      do <span style="color: #6c3163;">(</span>print i<span style="color: #6c3163;">)</span>
      when <span style="color: #6c3163;">(</span>= i 5<span style="color: #6c3163;">)</span>
      return 'finished<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">break loop</span>
<span style="color: #3a81c3;">(</span>loop for i in '<span style="color: #6c3163;">(</span>2 3 4 5 6<span style="color: #6c3163;">)</span> collect <span style="color: #6c3163;">(</span>* i i<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">return a list</span>
<span style="color: #3a81c3;">(</span>loop for x below 10 for y below 10 collect<span style="color: #6c3163;">(</span>+ x y<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; (0, 2, 4, 6, ...)</span>
<span style="color: #3a81c3;">(</span>loop for x below 10
      collect <span style="color: #6c3163;">(</span>loop for y below 10
		    collect <span style="color: #2d9574;">(</span>+ x y<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Cartesian product</span>
<span style="color: #3a81c3;">(</span>loop for i
      from 0
      for day
      in '<span style="color: #6c3163;">(</span>monday tuesday wednesday thursday friday saturday sunday<span style="color: #6c3163;">)</span>
      collect <span style="color: #6c3163;">(</span>cons i day<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">-&gt; ((0 . monday) (1 . tuesday) ...)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga5bafc8" class="outline-3">
<h3 id="orga5bafc8"><span class="section-number-3">9.5</span> <code>format</code> function</h3>
<div class="outline-text-3" id="text-9-5">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>format <span style="color: #2d9574;">"Add onion rings for only %.2f dollars more!"</span> 1.5<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org407c94f" class="outline-2">
<h2 id="org407c94f"><span class="section-number-2">10</span> Profiling</h2>
<div class="outline-text-2" id="text-10">
<p>
see benchmark.el
</p>
</div>
</div>
<div id="outline-container-orga55c312" class="outline-2">
<h2 id="orga55c312"><span class="section-number-2">11</span> Loading Process</h2>
<div class="outline-text-2" id="text-11">
<ul class="org-ul">
<li>add to <code>load-path</code></li>
<li><code>load-file</code></li>
<li><code>provide</code>, <code>require</code></li>
</ul>
</div>
<div id="outline-container-org3dff1ed" class="outline-3">
<h3 id="org3dff1ed"><span class="section-number-3">11.1</span> autoload</h3>
<div class="outline-text-3" id="text-11-1">
<p>
Things that can be auto-loaded generally involve anything "definable",
such as functions, macros, major or minor modes, groups, classes, and
so on.
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span>autoload 'some-function <span style="color: #2d9574;">"some-file"</span><span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">;;;</span><span style="color: #2aa1ae; background-color: #ecf3ec;">###</span><span style="color: #dc752f; background-color: #fbf8ef;">autoload</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">my-function</span> <span style="color: #6c3163;">()</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Source code...</span>
  <span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">;;;</span><span style="color: #2aa1ae; background-color: #ecf3ec;">###</span><span style="color: #dc752f; background-color: #fbf8ef;">autoload</span>
<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">require</span> '<span style="color: #4e3163;">helm</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb3f072c" class="outline-3">
<h3 id="orgb3f072c"><span class="section-number-3">11.2</span> Eval after load</h3>
<div class="outline-text-3" id="text-11-2">
<div class="org-src-container">
<pre class="src src-elisp"><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">with-eval-after-load</span> 'helm
  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Code</span>
  <span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org861b869" class="outline-3">
<h3 id="org861b869"><span class="section-number-3">11.3</span> use-package</h3>
</div>
</div>
</div>
</body>
</html>
