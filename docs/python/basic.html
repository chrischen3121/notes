<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<!-- 2021-03-10 Wed 13:44 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Python 基础参考</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="ChrisChen" />
<meta name="keywords" content="python" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
	     margin-bottom: .2em; }
  .subtitle { text-align: center;
	      font-size: medium;
	      font-weight: bold;
	      margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
	    padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://gongzhitaao.org/orgcss/org.css"/>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
	displayAlign: "left",
	displayIndent: "2em",

	"HTML-CSS": { scale: 100,
			linebreaks: { automatic: "false" },
			webFont: "TeX"
		       },
	SVG: {scale: 100,
	      linebreaks: { automatic: "false" },
	      font: "TeX"},
	NativeMML: {scale: 100},
	TeX: { equationNumbers: {autoNumber: "AMS"},
	       MultLineWidth: "85%",
	       TagSide: "left",
	       TagIndent: ".8em"
	     }
});
</script>
<script type="text/javascript"
	src="https://cdn.bootcdn.net/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Python 基础参考</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org86a749a">1. 入门知识</a></li>
<li><a href="#org7486629">2. 数据结构</a>
<ul>
<li><a href="#orgd1fa778">2.1. 序列</a></li>
<li><a href="#orgf16127e">2.2. 列表</a></li>
<li><a href="#orgc8684e5">2.3. 元组</a></li>
<li><a href="#org8b4383c">2.4. 字符串</a></li>
<li><a href="#org4384f81">2.5. 字典</a></li>
<li><a href="#org61ba760">2.6. 其他</a></li>
</ul>
</li>
<li><a href="#orgc04e4a8">3. 语句</a>
<ul>
<li><a href="#orge953a1e">3.1. 赋值语句</a></li>
<li><a href="#org9ed0468">3.2. if 语句</a></li>
<li><a href="#org9cae9de">3.3. 断言语句</a></li>
<li><a href="#orge22204b">3.4. while 语句</a></li>
<li><a href="#orgf1bcc6c">3.5. for 语句</a></li>
<li><a href="#orgf087d49">3.6. 拓展</a></li>
</ul>
</li>
<li><a href="#orgdc276ce">4. 函数</a>
<ul>
<li><a href="#org7116a3b">4.1. 定义函数</a></li>
<li><a href="#orgecf41a7">4.2. 参数</a></li>
<li><a href="#orge25c6a3">4.3. 查看函数说明</a></li>
<li><a href="#orga65df0b">4.4. 空返回值</a></li>
<li><a href="#orgf5dce98">4.5. 闭包</a></li>
<li><a href="#org029f06e">4.6. 函数柯里化</a></li>
<li><a href="#org8310e5a">4.7. 拓展</a></li>
</ul>
</li>
<li><a href="#org8ba4022">5. 类</a>
<ul>
<li><a href="#orgb66bd42">5.1. 定义类</a></li>
<li><a href="#org6ce9f13">5.2. 类成员变量(非实例成员)</a></li>
<li><a href="#org839a59b">5.3. 类静态方法和类方法</a></li>
<li><a href="#orgd379c73">5.4. 属性</a></li>
<li><a href="#orgad7c284">5.5. 继承</a></li>
<li><a href="#org6e8059a">5.6. 多重继承</a></li>
<li><a href="#org56cd1e5">5.7. 接口和内省</a></li>
<li><a href="#orgcecd3d2">5.8. 类的特殊特性总结</a></li>
</ul>
</li>
<li><a href="#org9a7234c">6. 异常</a>
<ul>
<li><a href="#org4610089">6.1. 抛出异常</a></li>
<li><a href="#orgb8e5d75">6.2. 内建异常类</a></li>
<li><a href="#org0002e70">6.3. 自定义异常类</a></li>
<li><a href="#org478fc19">6.4. 捕捉异常</a></li>
<li><a href="#orgcba519e">6.5. 常用异常类列表</a></li>
<li><a href="#org928eb35">6.6. DB 相关异常列表</a></li>
</ul>
</li>
<li><a href="#orgacfa166">7. 高级特性和隐藏特性</a>
<ul>
<li><a href="#orge79a24c">7.1. __init__、__del__</a></li>
<li><a href="#org62d40a1">7.2. 集合相关__len__、__getitem__等</a></li>
<li><a href="#org1211bd0">7.3. 迭代器__iter__</a></li>
<li><a href="#org37744eb">7.4. 生成器 yield 语句</a></li>
</ul>
</li>
<li><a href="#org56a3522">8. 模块</a>
<ul>
<li><a href="#orgf383541">8.1. 导入自定义模块</a></li>
<li><a href="#org4c5b1bd">8.2. 仅导入定义，不运行模块内程序</a></li>
<li><a href="#org66c5c9e">8.3. 包</a></li>
<li><a href="#org2cccc63">8.4. 查看模块说明</a></li>
<li><a href="#orgfb79bf2">8.5. 核心模块</a></li>
<li><a href="#org6264dd0">8.6. 其他常用模块</a></li>
<li><a href="#org3f9f300">8.7. 集成其他语言模块</a></li>
<li><a href="#org0ee8ceb">8.8. 可在 PyPI 上寻找 python 的最新的拓展包</a></li>
</ul>
</li>
<li><a href="#org5560b5e">9. 文件</a>
<ul>
<li><a href="#orgc948632">9.1. Open</a></li>
<li><a href="#orgf659e73">9.2. 文件对象的基本方法</a></li>
<li><a href="#org82d305d">9.3. 迭代处理读取内容</a></li>
</ul>
</li>
<li><a href="#org24dd384">10. 网络</a>
<ul>
<li><a href="#orga005000">10.1. socket</a></li>
<li><a href="#org70b6407">10.2. urllib, urllib2</a></li>
<li><a href="#org1ef02aa">10.3. webservice</a></li>
<li><a href="#org2cb1237">10.4. 其他网络模块</a></li>
</ul>
</li>
<li><a href="#org09fbdde">11. 测试</a>
<ul>
<li><a href="#orgcef2b1c">11.1. 调试</a></li>
<li><a href="#org1b61b1a">11.2. doctest</a></li>
<li><a href="#orgd880107">11.3. unittest</a></li>
<li><a href="#orge22d6c5">11.4. 代码检查</a></li>
<li><a href="#org8977b3e">11.5. 性能测试</a></li>
<li><a href="#org6f77055">11.6. 其他可选工具</a></li>
</ul>
</li>
<li><a href="#org0d4fe58">12. 发布程序</a>
<ul>
<li><a href="#orgb90c06e">12.1. 制作安装脚本</a></li>
<li><a href="#org458dc93">12.2. 制作安装包</a></li>
<li><a href="#org36c6f00">12.3. py2exe</a></li>
</ul>
</li>
<li><a href="#org2e79f14">13. 实用的内建函数</a>
<ul>
<li><a href="#orgcfa74aa">13.1. pass</a></li>
<li><a href="#org6c90c28">13.2. del</a></li>
<li><a href="#org148672d">13.3. exec 和 eval</a></li>
</ul>
</li>
<li><a href="#org57647a5">14. ipython magicfunc</a>
<ul>
<li><a href="#orgf1c5192">14.1. 常用</a></li>
<li><a href="#org5fe3092">14.2. log</a></li>
<li><a href="#orgc182599">14.3. system-related</a></li>
<li><a href="#org815541d">14.4. debuger</a></li>
<li><a href="#org3c55767">14.5. %lprun</a></li>
</ul>
</li>
<li><a href="#org0db8454">15. 一些提示</a></li>
</ul>
</div>
</div>
<div id="outline-container-org86a749a" class="outline-2">
<h2 id="org86a749a"><span class="section-number-2">1</span> 入门知识</h2>
</div>
<div id="outline-container-org7486629" class="outline-2">
<h2 id="org7486629"><span class="section-number-2">2</span> 数据结构</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgd1fa778" class="outline-3">
<h3 id="orgd1fa778"><span class="section-number-3">2.1</span> 序列</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org3553227" class="outline-4">
<h4 id="org3553227"><span class="section-number-4">2.1.1</span> 序列包括列表、字符串 、元组</h4>
</div>
<div id="outline-container-orge07b09c" class="outline-4">
<h4 id="orge07b09c"><span class="section-number-4">2.1.2</span> 基本操作</h4>
<div class="outline-text-4" id="text-2-1-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">numbers</span> = <span style="color: #3a81c3;">[</span>1,2,3,4,5,6,7,8,9,10<span style="color: #3a81c3;">]</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#22768;&#26126;</span>

numbers<span style="color: #3a81c3;">[</span>3:6<span style="color: #3a81c3;">]</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">Slice &#20998;&#29255;&#25805;&#20316;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [4,5,6] &#31532;&#20108;&#20010;&#32034;&#24341;&#21495;&#30340;&#20803;&#32032;&#19981;&#21253;&#21547;</span>

numbers<span style="color: #3a81c3;">[</span>-3:<span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [8,9,10]</span>

numbers<span style="color: #3a81c3;">[</span>0:10:2<span style="color: #3a81c3;">]</span>
 <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [1,3,5,7,9]</span>

numbers<span style="color: #3a81c3;">[</span>10:0:-2<span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [10,8,6,4,2]</span>

<span style="color: #3a81c3;">[</span>1,2,3<span style="color: #3a81c3;">]</span> + <span style="color: #3a81c3;">[</span>4,5,6<span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [1,2,3,4,5,6]</span>

<span style="color: #3a81c3;">[</span>42<span style="color: #3a81c3;">]</span> *6
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [42,42,42,42,42,42]</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf16127e" class="outline-3">
<h3 id="orgf16127e"><span class="section-number-3">2.2</span> 列表</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">helloList</span> = <span style="color: #3a81c3;">list</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'Hello'</span><span style="color: #3a81c3;">)</span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#23383;&#31526;&#20018;&#36716;&#25442;&#25104;&#23383;&#31526;&#21015;&#34920;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;['H','e','l','l','o']</span>
<span style="color: #da8b55;">''</span>.join<span style="color: #3a81c3;">(</span>helloList<span style="color: #3a81c3;">)</span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#23558;&#23383;&#31526;&#21015;&#34920;&#36716;&#25442;&#25104;&#23383;&#31526;&#20018;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;'Hello'</span>
</pre>
</div>
</div>
<div id="outline-container-org6c9a893" class="outline-4">
<h4 id="org6c9a893"><span class="section-number-4">2.2.1</span> 列表可以修改</h4>
<div class="outline-text-4" id="text-2-2-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">delete element</span>
<span style="color: #715ab1;">numbers</span><span style="color: #3a81c3;">[</span>5<span style="color: #3a81c3;">]</span> = 64
<span style="color: #3a81c3; font-weight: bold;">del</span> numbers<span style="color: #3a81c3;">[</span>5<span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#20998;&#29255;&#25554;&#20837;&#20803;&#32032;</span>
<span style="color: #715ab1;">numbers</span><span style="color: #3a81c3;">[</span>5:5<span style="color: #3a81c3;">]</span> = <span style="color: #3a81c3;">[</span>6,6<span style="color: #3a81c3;">]</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#20998;&#29255;&#21024;&#38500;&#20803;&#32032;</span>
<span style="color: #715ab1;">numbers</span><span style="color: #3a81c3;">[</span>2:8<span style="color: #3a81c3;">]</span> = <span style="color: #3a81c3;">[]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">name</span> = <span style="color: #3a81c3;">list</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'perl'</span><span style="color: #3a81c3;">)</span>
<span style="color: #715ab1;">name</span><span style="color: #3a81c3;">[</span>2:<span style="color: #3a81c3;">]</span> = <span style="color: #3a81c3;">list</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'ar'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">name =&gt; ['p', 'e', 'a', 'r']</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org317180d" class="outline-4">
<h4 id="org317180d"><span class="section-number-4">2.2.2</span> 列表方法</h4>
<div class="outline-text-4" id="text-2-2-2">
</div>
<ul class="org-ul">
<li><a id="org5b92eb3"></a>append<br />
<div class="outline-text-5" id="text-org5b92eb3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">lst</span>= <span style="color: #3a81c3;">[</span>1,2,3<span style="color: #3a81c3;">]</span>
lst.append<span style="color: #3a81c3;">(</span>4<span style="color: #3a81c3;">)</span>
lst
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [1,2,3,4]</span>
</pre>
</div>
</div>
</li>
<li><a id="orga035c07"></a>count<br />
<div class="outline-text-5" id="text-orga035c07">
<p>
某个元素出现的次数
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">[</span>1,5,6,7,53,1,5<span style="color: #3a81c3;">]</span>.count<span style="color: #3a81c3;">(</span>1<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; 2</span>
</pre>
</div>
</div>
</li>
<li><a id="orgaa470d9"></a>extend<br />
<div class="outline-text-5" id="text-orgaa470d9">
<p>
比 lst1=lst1+lst2 效率高
</p>
<div class="org-src-container">
<pre class="src src-python">lst1.extend<span style="color: #3a81c3;">(</span>lst2<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</li>
<li><a id="org9b08e3e"></a>index<br />
<div class="outline-text-5" id="text-org9b08e3e">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">[</span><span style="color: #da8b55;">'who'</span>,<span style="color: #da8b55;">'where'</span><span style="color: #3a81c3;">]</span>.index<span style="color: #3a81c3;">(</span><span style="color: #da8b55;">'who'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; 0</span>
</pre>
</div>
</div>
</li>
<li><a id="org62072a1"></a>insert<br />
<div class="outline-text-5" id="text-org62072a1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">[</span>1,2,3,4,5<span style="color: #3a81c3;">]</span>.insert<span style="color: #3a81c3;">(</span>2, <span style="color: #2d9574;">'e'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [1,2,'e',3,4,5]</span>
</pre>
</div>
</div>
</li>
<li><a id="org0f7c318"></a>pop<br />
<div class="outline-text-5" id="text-org0f7c318">
<p>
移除列表中的一个元素(默认最后一个)，并返回该元素的值
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">x</span>=<span style="color: #3a81c3;">[</span>1,2,3<span style="color: #3a81c3;">]</span>
x.pop<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; 3</span>
x
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [1,2]</span>
</pre>
</div>
<p>
注：使用 pop 可以实现数据结构——栈
</p>
</div>
</li>
<li><a id="org1853106"></a>remove<br />
<div class="outline-text-5" id="text-org1853106">
<p>
移除第一个匹配项
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">[</span>1,2,3,4,5,6,7,8<span style="color: #3a81c3;">]</span>.remove<span style="color: #3a81c3;">(</span>5<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [1,2,3,4,6,7,8]</span>
</pre>
</div>
</div>
</li>
<li><a id="org9f91a93"></a>reverse<br /></li>
<li><a id="org7469a54"></a>sort<br />
<div class="outline-text-5" id="text-org7469a54">
<div class="org-src-container">
<pre class="src src-python">x.sort<span style="color: #3a81c3;">()</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">x &#39034;&#24207;&#24050;&#25913;&#21464;</span>
<span style="color: #715ab1;">y</span> = <span style="color: #3a81c3;">sorted</span><span style="color: #3a81c3;">(</span>x<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">y &#20026; x &#25490;&#24207;&#21518;&#30340;&#21015;&#34920;</span>
</pre>
</div>

<p class="verse">
sort 可选参数(也适用于 sorted)：<br />
一、比较函数（见下一节）<br />
二、key<br />
x.sort(key=len)<br />
三、reverse<br />
x.sort(reverse=True)<br />
</p>
</div>
</li>
<li><a id="org2acc7d4"></a>自定义排序(比较函数)<br />
<div class="outline-text-5" id="text-org2acc7d4">
<p class="verse">
自定义 compare(x, y)<br />
x&lt;y 时返回负数，x&gt;y 时返回正数，x=y 时返回 0<br />
内建 cmp 函数例子：<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">cmp</span><span style="color: #3a81c3;">(</span>42, 32<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; 1</span>
<span style="color: #3a81c3;">cmp</span><span style="color: #3a81c3;">(</span>99, 100<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; -1</span>
<span style="color: #3a81c3;">cmp</span><span style="color: #3a81c3;">(</span>5,5<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; 0</span>
numbers.sort<span style="color: #3a81c3;">(</span><span style="color: #3a81c3;">cmp</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</li>
</ul>
</div>
<div id="outline-container-orgbef9725" class="outline-4">
<h4 id="orgbef9725"><span class="section-number-4">2.2.3</span> 空列表 []</h4>
</div>
<div id="outline-container-org7d6c33b" class="outline-4">
<h4 id="org7d6c33b"><span class="section-number-4">2.2.4</span> 空元素列表 [None]</h4>
</div>
</div>
<div id="outline-container-orgc8684e5" class="outline-3">
<h3 id="orgc8684e5"><span class="section-number-3">2.3</span> 元组</h3>
<div class="outline-text-3" id="text-2-3">
<p>
元组不能被修改
</p>
</div>
<div id="outline-container-orgf8d9e10" class="outline-4">
<h4 id="orgf8d9e10"><span class="section-number-4">2.3.1</span> 声明</h4>
<div class="outline-text-4" id="text-2-3-1">
<div class="org-src-container">
<pre class="src src-python">1,2,3 <span style="color: #3a81c3; font-weight: bold;">or</span> <span style="color: #3a81c3;">(</span>1,2,3<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; (1,2,3)</span>
<span style="color: #3a81c3;">()</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#31354;&#20803;&#32452;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; ()</span>
<span style="color: #3a81c3;">(</span>1,<span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">or</span> 1,
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; (1,)</span>
3*<span style="color: #3a81c3;">(</span>40+2,<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;(42,42,42)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd6c6114" class="outline-4">
<h4 id="orgd6c6114"><span class="section-number-4">2.3.2</span> tuple 函数</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
传入序列，返回元组
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">tuple</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163;">[</span>1,2,3<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; (1,2,3)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf940c62" class="outline-4">
<h4 id="orgf940c62"><span class="section-number-4">2.3.3</span> 使用元组的场合</h4>
<div class="outline-text-4" id="text-2-3-3">
<ul class="org-ul">
<li>元组可以在映射中当作键使用，列表不行(详见第四章)</li>
<li>元组是很多内建方法的返回值。必须处理他们。</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org8b4383c" class="outline-3">
<h3 id="org8b4383c"><span class="section-number-3">2.4</span> 字符串</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-org3d1356c" class="outline-4">
<h4 id="org3d1356c"><span class="section-number-4">2.4.1</span> 基本操作</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
所有标准的序列操作对字符串同样适用，唯一需要记住，字符串是不可变的。
</p>
</div>
</div>
<div id="outline-container-orge6dadc8" class="outline-4">
<h4 id="orge6dadc8"><span class="section-number-4">2.4.2</span> 格式化操作符</h4>
<div class="outline-text-4" id="text-2-4-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">format</span> = <span style="color: #2d9574;">"Hello, %s. %s enough for ya?"</span>
<span style="color: #715ab1;">values</span> = <span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'world'</span>, <span style="color: #2d9574;">'Hot'</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #3a81c3;">format</span> % values
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Hello, world. Hot enough for ya?</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8caf947" class="outline-4">
<h4 id="org8caf947"><span class="section-number-4">2.4.3</span> 常用方法</h4>
<div class="outline-text-4" id="text-2-4-3">
</div>
<ul class="org-ul">
<li><a id="org2321e4a"></a>list, tuple<br />
<div class="outline-text-5" id="text-org2321e4a">
<p>
list 将字符串转为列表，tuple 转为元组
</p>
</div>
</li>
<li><a id="org062f734"></a>find<br />
<div class="outline-text-5" id="text-org062f734">
<div class="org-src-container">
<pre class="src src-python">x.find<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"abc"</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&#36820;&#22238; index</span>
</pre>
</div>
</div>
</li>

<li><a id="orgb8481d0"></a>join<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup><br />
<div class="outline-text-5" id="text-orgb8481d0">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">seq</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'1'</span>,<span style="color: #2d9574;">'2'</span>,<span style="color: #2d9574;">'3'</span><span style="color: #3a81c3;">]</span>
<span style="color: #715ab1;">sep</span> = <span style="color: #2d9574;">'+'</span>
sep.join<span style="color: #3a81c3;">(</span>seq<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; '1+2+3'</span>
</pre>
</div>
</div>
</li>

<li><a id="org2cd3908"></a>lower,upper,title<br />
<div class="outline-text-5" id="text-org2cd3908">
<p>
title 功能： 单词首字母大写
</p>
</div>
</li>

<li><a id="org434a5e0"></a>replace<br />
<div class="outline-text-5" id="text-org434a5e0">
<div class="org-src-container">
<pre class="src src-python">x.replace<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'123'</span>, <span style="color: #2d9574;">'456'</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</li>

<li><a id="org47fae24"></a>split 是 join 的逆方法<br />
<div class="outline-text-5" id="text-org47fae24">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #da8b55;">'/usr/bin/env'</span>.split<span style="color: #3a81c3;">(</span><span style="color: #da8b55;">'/'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;['','usr','bin','env']</span>
</pre>
</div>
<p>
split 不提供参数时，默认根据空白字符分割，包括 tab、换行符等。
</p>
</div>
</li>

<li><a id="org9dc68b1"></a>strip<br />
<div class="outline-text-5" id="text-org9dc68b1">
<p>
去除两侧空格，也可传参数，去除指定的头尾字符
</p>
</div>
</li>

<li><a id="orgc82243a"></a>translate<br />
<div class="outline-text-5" id="text-orgc82243a">
<p class="verse">
同 replace 区别在于只处理单个字符。同时进行多个替换。<br />
有时比 replace 效率高的多。<br />
转换之前，需要完成一张转换表。可用 string 中的 maketrans<br />
</p>
<div class="org-src-container">
<pre class="src src-python">maketrans<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'cs'</span>, <span style="color: #2d9574;">'kz'</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</li>
</ul>
</div>

<div id="outline-container-orge1c8825" class="outline-4">
<h4 id="orge1c8825"><span class="section-number-4">2.4.4</span> 原始字符串(raw string)</h4>
<div class="outline-text-4" id="text-2-4-4">
<p class="verse">
使字符串中的转义符无效<br />
r'c:\newtest.txt'<br />
\n 不会被解释为换行符<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org4384f81" class="outline-3">
<h3 id="org4384f81"><span class="section-number-3">2.5</span> 字典</h3>
<div class="outline-text-3" id="text-2-5">
<p>
当索引不好用时使用
</p>
</div>
<div id="outline-container-org8d47223" class="outline-4">
<h4 id="org8d47223"><span class="section-number-4">2.5.1</span> 创建</h4>
<div class="outline-text-4" id="text-2-5-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">phonebook</span>=<span style="color: #3a81c3;">{</span><span style="color: #2d9574;">'Alice'</span>: <span style="color: #2d9574;">'2341'</span>, <span style="color: #2d9574;">'Beth'</span>: <span style="color: #2d9574;">'9102'</span>, <span style="color: #2d9574;">'Cecil'</span>: <span style="color: #2d9574;">'3258'</span><span style="color: #3a81c3;">}</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#30452;&#25509;&#21019;&#24314;</span>
phonebook<span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'Cecil'</span><span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; '3258'</span>

<span style="color: #715ab1;">phonebook</span>=<span style="color: #3a81c3;">{}</span>
<span style="color: #715ab1;">phonebook</span><span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'Denver'</span><span style="color: #3a81c3;">]</span> = <span style="color: #2d9574;">'5345'</span>
phonebook
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; { 'Denver': '5345' }</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga3bba7f" class="outline-4">
<h4 id="orga3bba7f"><span class="section-number-4">2.5.2</span> 使用 dict 函数初始化</h4>
<div class="outline-text-4" id="text-2-5-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">items</span> = <span style="color: #3a81c3;">[</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">'name'</span>, <span style="color: #2d9574;">'Gumby'</span><span style="color: #6c3163;">)</span>, <span style="color: #6c3163;">(</span><span style="color: #2d9574;">'age'</span>, 42<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">]</span>
<span style="color: #715ab1;">d</span> = <span style="color: #3a81c3;">dict</span><span style="color: #3a81c3;">(</span>items<span style="color: #3a81c3;">)</span>
d
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; {'age': 42, 'name': 'Gumby'}</span>

<span style="color: #715ab1;">d</span>=<span style="color: #3a81c3;">dict</span><span style="color: #3a81c3;">(</span>name=<span style="color: #2d9574;">'Gumby'</span>, age=42<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21478;&#19968;&#31181;&#22768;&#26126;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb72851b" class="outline-4">
<h4 id="orgb72851b"><span class="section-number-4">2.5.3</span> 基本字典操作</h4>
<div class="outline-text-4" id="text-2-5-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">len</span><span style="color: #3a81c3;">(</span>d<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">del</span> d<span style="color: #3a81c3;">[</span>k<span style="color: #3a81c3;">]</span>
k <span style="color: #3a81c3; font-weight: bold;">in</span> d<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">(&#26816;&#26597;&#26159;&#21542;&#23384;&#22312; k &#38190;)</span>
</pre>
</div>
<p>
自动添加，对不存在的键复制等于创建了一个新项
</p>
</div>
</div>

<div id="outline-container-org8d059c4" class="outline-4">
<h4 id="org8d059c4"><span class="section-number-4">2.5.4</span> 字典的字符串格式化</h4>
<div class="outline-text-4" id="text-2-5-4">
<p>
字符串 % 字典名
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #da8b55;">"Cecil's phone number is %(Cecil)s."</span> % phonebook
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;"Cecil's phone number is 3258."</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8121cad" class="outline-4">
<h4 id="org8121cad"><span class="section-number-4">2.5.5</span> 字典方法</h4>
<div class="outline-text-4" id="text-2-5-5">
</div>
<ul class="org-ul">
<li><a id="org323f851"></a>clear<br />
<div class="outline-text-5" id="text-org323f851">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">x</span>=<span style="color: #3a81c3;">{}</span>
<span style="color: #715ab1;">y</span>=x
<span style="color: #715ab1;">x</span><span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'key'</span><span style="color: #3a81c3;">]</span> = <span style="color: #2d9574;">'value'</span>
y
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; {'key': 'value'}</span>
</pre>
</div>
<p class="verse">
一、x = {} =&gt;y 没变<br />
二、x.clear() =&gt; y {}<br />
</p>
</div>
</li>

<li><a id="org2a3124e"></a>copy &amp; deepcopy<br />
<div class="outline-text-5" id="text-org2a3124e">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">x</span> = <span style="color: #3a81c3;">{</span><span style="color: #2d9574;">'key1'</span>: <span style="color: #2d9574;">'value1'</span>, <span style="color: #2d9574;">'key2'</span>: <span style="color: #2d9574;">'value2'</span><span style="color: #3a81c3;">}</span>
<span style="color: #715ab1;">y</span> = x.copy<span style="color: #3a81c3;">()</span>
</pre>
</div>
<p class="verse">
一、y.remove('key2')<br />
y 和 x 均受影响<br />
<br />
二、y['key1'] = 'value3'<br />
y 受影响，x 不受<br />
<br />
deepcopy 避免了该问题，无论 y 怎么处理，x 都不会变。<br />
</p>
</div>
</li>

<li><a id="orgbd00e27"></a>fromkeys<br />
<div class="outline-text-5" id="text-orgbd00e27">
<p>
使用给定的键建立字典，值默认都为 None
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">dict</span>.fromkeys<span style="color: #3a81c3;">(</span><span style="color: #6c3163;">[</span><span style="color: #2d9574;">'name'</span>, <span style="color: #2d9574;">'age'</span><span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
<p>
也可自己提供值的默认值
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">dict</span>.fromkeys<span style="color: #3a81c3;">(</span><span style="color: #6c3163;">[</span><span style="color: #2d9574;">'name'</span>, <span style="color: #2d9574;">'age'</span><span style="color: #6c3163;">]</span>, <span style="color: #2d9574;">'unknown'</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</li>

<li><a id="org3934ea2"></a>get<br />
<div class="outline-text-5" id="text-org3934ea2">
<p>
更宽松的访问字典项方法
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">d</span>=<span style="color: #3a81c3;">{}</span>
d<span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'name'</span><span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; &#20986;&#38169;</span>
d.get<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'name'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; None</span>
</pre>
</div>
</div>
</li>

<li><a id="org1904252"></a>has_key<br />
<div class="outline-text-5" id="text-org1904252">
<pre class="example">
has_key 相当于 k in d。python3.0 不包含该方法。
</pre>
</div>
</li>

<li><a id="org7549001"></a>items &amp; iteritems<br />
<div class="outline-text-5" id="text-org7549001">
<p>
字典项以列表形式返回
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">d</span> = <span style="color: #3a81c3;">{</span><span style="color: #2d9574;">'key1'</span>: <span style="color: #2d9574;">'value1'</span>, <span style="color: #2d9574;">'key2'</span>: <span style="color: #2d9574;">'value2'</span><span style="color: #3a81c3;">}</span>
d.items<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [('key1', 'value1'), ('key2', 'value2')]</span>
<span style="color: #715ab1;">it</span> = d.iteritems<span style="color: #3a81c3;">()</span>
<span style="color: #3a81c3;">list</span><span style="color: #3a81c3;">(</span>it<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [('key1', 'value1'), ('key2', 'value2')]</span>
</pre>
</div>
</div>
</li>

<li><a id="org250d50b"></a>keys &amp; iterkeys<br />
<div class="outline-text-5" id="text-org250d50b">
<p>
键以列表形式返回
</p>
</div>
</li>

<li><a id="orgb1a8a4b"></a>values &amp; itervalues<br />
<div class="outline-text-5" id="text-orgb1a8a4b">
<p>
值以列表形式返回
</p>
</div>
</li>

<li><a id="org81eb3e6"></a>pop<br />
<div class="outline-text-5" id="text-org81eb3e6">
<p>
pop 用来获得对应于给定键的值，然后删除该项。
</p>
<div class="org-src-container">
<pre class="src src-python">d.pop<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'key1'</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</li>

<li><a id="orga438164"></a>popitem<br />
<div class="outline-text-5" id="text-orga438164">
<p class="verse">
类似于 list.pop<br />
因为字典没有顺序的概念，pop 出一个随机项。<br />
用处：若想一个接一个地处理并移除项，用该方法。<br />
</p>
</div>
</li>

<li><a id="orgc10285a"></a>setdefault<br />
<div class="outline-text-5" id="text-orgc10285a">
<div class="org-src-container">
<pre class="src src-python">d.setdefault<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'name'</span>, <span style="color: #2d9574;">'N/A'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#23383;&#20856;&#20013;&#26080;&#35813;&#38190;&#36820;&#22238;&#22914;&#19979;&#65306;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; 'N/A'</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#23383;&#20856;&#20013;&#26377;{'name': 'Gumby'}</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; 'Gumby'</span>
</pre>
</div>
</div>
</li>

<li><a id="orgf30c56c"></a>update<br />
<div class="outline-text-5" id="text-orgf30c56c">
<p>
利用一个字典项更新另外一个字典
</p>
<div class="org-src-container">
<pre class="src src-python">d.update<span style="color: #3a81c3;">(</span>x<span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#26356;&#26032;&#28304; d</span>
</pre>
</div>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org61ba760" class="outline-3">
<h3 id="org61ba760"><span class="section-number-3">2.6</span> 其他</h3>
<div class="outline-text-3" id="text-2-6">
</div>
<div id="outline-container-org35cfa95" class="outline-4">
<h4 id="org35cfa95"><span class="section-number-4">2.6.1</span> set</h4>
<div class="outline-text-4" id="text-2-6-1">
<p class="verse">
set 位于 sets 模块中。python2.3 以前需用 import sets。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">set</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163;">[</span>0,1,2,3,0,1,2,3,4,5<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">set &#26159;&#30001;&#24207;&#21015;(&#25110;&#20854;&#20182;&#21487;&#36845;&#20195;&#23545;&#35937;)&#26500;&#24314;&#30340;&#12290;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;set([0,1,2,3,4,5])#&#30456;&#21516;&#30340;&#25104;&#21592;&#20250;&#34987;&#24573;&#30053;&#12290;</span>
<span style="color: #3a81c3;">set</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163;">[</span><span style="color: #2d9574;">'fee'</span>, <span style="color: #2d9574;">'fie'</span>, <span style="color: #2d9574;">'foe'</span><span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;set(['foe', 'fee', 'fie'])#&#19982;&#23383;&#20856;&#19968;&#26679;&#65292;&#39034;&#24207;&#26159;&#26410;&#30693;&#30340;</span>
</pre>
</div>
</div>
<ul class="org-ul">
<li><a id="orge6beef6"></a>集合操作<br />
<div class="outline-text-5" id="text-orge6beef6">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">a</span> = <span style="color: #3a81c3;">set</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163;">[</span>1,2,3<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
<span style="color: #715ab1;">b</span> = <span style="color: #3a81c3;">set</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163;">[</span>2,3,4<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
a | b
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;set([1,2,3,4])</span>
<span style="color: #715ab1;">c</span> = a &amp; b
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;set([2,3])</span>
c.issubset<span style="color: #3a81c3;">(</span>a<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;True</span>
c &gt;= a
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;False</span>
a.intersection<span style="color: #3a81c3;">(</span>b<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;set([2,3])</span>
a.difference<span style="color: #3a81c3;">(</span>b<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;set([1])</span>
a-b
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;set([1])</span>
a.symmetric_difference<span style="color: #3a81c3;">(</span>b<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;set([1,4])</span>
a.copy<span style="color: #3a81c3;">()</span> <span style="color: #3a81c3; font-weight: bold;">is</span> a
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;False</span>
</pre>
</div>
</div>
</li>
</ul>
</div>
<div id="outline-container-orgdf52d44" class="outline-4">
<h4 id="orgdf52d44"><span class="section-number-4">2.6.2</span> heap</h4>
<div class="outline-text-4" id="text-2-6-2">
<p class="verse">
优先序列的一种，以任意顺序追加元素。使用 pop 方法获取最小元素。<br />
效率要比列表的 min 方法高。<br />
堆算法：i 位置处的元素总是比 2*i 以及 2*i+1 位置处的元素小。<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">heappush(heap, x)</td>
<td class="org-left">将 x 加入堆</td>
</tr>

<tr>
<td class="org-left">heappop(heap)</td>
<td class="org-left">将堆中最小元素返回</td>
</tr>

<tr>
<td class="org-left">heapify(list)</td>
<td class="org-left">将列表转为堆</td>
</tr>

<tr>
<td class="org-left">heapreplace(heap, x)</td>
<td class="org-left">pop 出最小元素，加入 x</td>
</tr>

<tr>
<td class="org-left">nlargest(n, iter)</td>
<td class="org-left">返回 iter 中第 n 大的元素</td>
</tr>

<tr>
<td class="org-left">nsmallest(n, iter)</td>
<td class="org-left">返回 iter 中第 n 小的元素</td>
</tr>
</tbody>
</table>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">from</span> heapq <span style="color: #3a81c3; font-weight: bold;">import</span> *
<span style="color: #3a81c3; font-weight: bold;">from</span> random <span style="color: #3a81c3; font-weight: bold;">import</span> shuffle
<span style="color: #715ab1;">data</span>=<span style="color: #3a81c3;">range</span><span style="color: #3a81c3;">(</span>10<span style="color: #3a81c3;">)</span>
shuffle<span style="color: #3a81c3;">(</span>data<span style="color: #3a81c3;">)</span>
heapify<span style="color: #3a81c3;">(</span>data<span style="color: #3a81c3;">)</span>
heappush<span style="color: #3a81c3;">(</span>data, 0.4<span style="color: #3a81c3;">)</span>
heap
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;[0, 0.4, 4, 5, 1, 8, 9, 6, 7, 3, 2]</span>
heappop<span style="color: #3a81c3;">(</span>data<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;0</span>
</pre>
</div>
<p>
heapq 中的 nlargest 和 nsmallest 使用堆算法从可迭代对象中获取最大最小值
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">data</span>=<span style="color: #3a81c3;">range</span><span style="color: #3a81c3;">(</span>10<span style="color: #3a81c3;">)</span>
shuffle<span style="color: #3a81c3;">(</span>data<span style="color: #3a81c3;">)</span>
nlargest<span style="color: #3a81c3;">(</span>1, data<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;9</span>
nsmallest<span style="color: #3a81c3;">(</span>1,data<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;0</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga5bc160" class="outline-4">
<h4 id="orga5bc160"><span class="section-number-4">2.6.3</span> deque</h4>
<div class="outline-text-4" id="text-2-6-3">
<p class="verse">
Double-ended queue 双端队列<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">from</span> collections <span style="color: #3a81c3; font-weight: bold;">import</span> deque
<span style="color: #715ab1;">q</span> = deque<span style="color: #3a81c3;">(</span><span style="color: #3a81c3;">range</span><span style="color: #6c3163;">(</span>5<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
q.append<span style="color: #3a81c3;">(</span>5<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#40664;&#35748;&#22312;&#38431;&#21015;&#21491;&#31471;&#36861;&#21152;</span>
q.appendleft<span style="color: #3a81c3;">(</span>6<span style="color: #3a81c3;">)</span>
q
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;deque([6,0,1,2,3,4,5])</span>
q.pop<span style="color: #3a81c3;">()</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#40664;&#35748;&#20174;&#38431;&#20237;&#21491;&#31471; pop &#20986;&#20803;&#32032;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;5</span>
q.popleft<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;6</span>
q.rotate<span style="color: #3a81c3;">(</span>3<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21491;&#31227;&#19977;&#20010;&#20803;&#32032;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;deque([2,3,4,0,1])</span>
q.rotate<span style="color: #3a81c3;">(</span>-1<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#24038;&#31227;&#19968;&#20010;&#20803;&#32032;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;deque([3,4,0,1,2])</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc04e4a8" class="outline-2">
<h2 id="orgc04e4a8"><span class="section-number-2">3</span> 语句</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orge953a1e" class="outline-3">
<h3 id="orge953a1e"><span class="section-number-3">3.1</span> 赋值语句</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org3ea9f75" class="outline-4">
<h4 id="org3ea9f75"><span class="section-number-4">3.1.1</span> 多个变量赋值</h4>
<div class="outline-text-4" id="text-3-1-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">x</span>, <span style="color: #715ab1;">y</span>, <span style="color: #715ab1;">z</span> = 1, 2, 3
</pre>
</div>
</div>
</div>

<div id="outline-container-org912a5e4" class="outline-4">
<h4 id="org912a5e4"><span class="section-number-4">3.1.2</span> 交换变量</h4>
<div class="outline-text-4" id="text-3-1-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">x</span>, <span style="color: #715ab1;">y</span> = y, x
</pre>
</div>
</div>
</div>
<div id="outline-container-org2d298c8" class="outline-4">
<h4 id="org2d298c8"><span class="section-number-4">3.1.3</span> 序列解包(sequence unpacking)</h4>
<div class="outline-text-4" id="text-3-1-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">values</span> = 1, 2, 3
values
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; (1, 2, 3)</span>
<span style="color: #715ab1;">x</span>, <span style="color: #715ab1;">y</span>, <span style="color: #715ab1;">z</span> = values
x
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; 1</span>
</pre>
</div>

<p>
常用于函数方法返回元组时
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">key</span>, <span style="color: #715ab1;">value</span> = scoundrel.popitem<span style="color: #3a81c3;">()</span>
</pre>
</div>

<p>
python 3.0 特殊解包
</p>
<div class="org-src-container">
<pre class="src src-python">a, b, rest* = <span style="color: #3a81c3;">[</span>1, 2, 3, 4<span style="color: #3a81c3;">]</span>
rest
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [3, 4]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4351a8f" class="outline-4">
<h4 id="org4351a8f"><span class="section-number-4">3.1.4</span> 链式赋值</h4>
<div class="outline-text-4" id="text-3-1-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">x</span> = <span style="color: #715ab1;">y</span> = somefunction<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#31561;&#21516;&#20110;</span>
<span style="color: #715ab1;">y</span> = somefunction<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">x</span> = y
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#19981;&#19968;&#23450;&#31561;&#20215;&#20110;</span>
<span style="color: #715ab1;">x</span> = somefunction<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">y</span> = somefunction<span style="color: #3a81c3;">()</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf97ac5b" class="outline-4">
<h4 id="orgf97ac5b"><span class="section-number-4">3.1.5</span> 增量赋值</h4>
<div class="outline-text-4" id="text-3-1-5">
<p>
与其他语言差不多+=、*=等
</p>
</div>
</div>
</div>

<div id="outline-container-org9ed0468" class="outline-3">
<h3 id="org9ed0468"><span class="section-number-3">3.2</span> if 语句</h3>
<div class="outline-text-3" id="text-3-2">
<p class="verse">
如下会被视为 False:<br />
False None 0 "" () [] {}<br />
其他非空值被视为 True<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4e3163;">True</span> == 1 <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; True</span>
<span style="color: #4e3163;">False</span> == 0 <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; True</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">+end_src**** bool &#20989;&#25968;</span>
 <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">+begin_src python</span>
 <span style="color: #3a81c3;">bool</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'test'</span><span style="color: #3a81c3;">)</span>
 <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; True</span>
 <span style="color: #3a81c3;">bool</span><span style="color: #3a81c3;">(</span>42<span style="color: #3a81c3;">)</span>
 <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; True</span>
 <span style="color: #3a81c3;">bool</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">''</span><span style="color: #3a81c3;">)</span>
 <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; False</span>
</pre>
</div>
</div>

<ul class="org-ul">
<li><a id="orga102e37"></a>if 语句写法<br />
<div class="outline-text-5" id="text-orga102e37">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">if</span> true:
.....
<span style="color: #3a81c3; font-weight: bold;">if</span> &#26465;&#20214; 1 <span style="color: #3a81c3; font-weight: bold;">and</span> &#26465;&#20214; 2:
<span style="color: #3a81c3; font-weight: bold;">and</span>, <span style="color: #3a81c3; font-weight: bold;">or</span>, <span style="color: #3a81c3; font-weight: bold;">not</span>
</pre>
</div>
</div>
</li>

<li><a id="org02e4b5a"></a>更多比较运算符<br />
<div class="outline-text-5" id="text-org02e4b5a">
<div class="org-src-container">
<pre class="src src-python">x <span style="color: #3a81c3; font-weight: bold;">is</span> y  <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">x&#12289;y &#26159;&#21516;&#19968;&#20010;&#23545;&#35937;</span>
x <span style="color: #3a81c3; font-weight: bold;">is</span> <span style="color: #3a81c3; font-weight: bold;">not</span> y
x <span style="color: #3a81c3; font-weight: bold;">in</span> y
x <span style="color: #3a81c3; font-weight: bold;">not</span> <span style="color: #3a81c3; font-weight: bold;">in</span> y
</pre>
</div>

<p>
注：0 &lt; age &lt; 100 的形式也是可以的
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#23383;&#31526;&#20018;&#21487;&#20197;&#26681;&#25454;&#23383;&#27597;&#39034;&#24207;&#36827;&#34892;&#27604;&#36739;</span>
<span style="color: #da8b55;">"a"</span>&lt;<span style="color: #da8b55;">"b"</span> =&gt; <span style="color: #4e3163;">True</span>
<span style="color: #3a81c3;">[</span>1,2<span style="color: #3a81c3;">]</span> &lt; <span style="color: #3a81c3;">[</span>2,1<span style="color: #3a81c3;">]</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#27604;&#36739;&#31532;&#19968;&#20010;&#20540;</span>
<span style="color: #3a81c3;">[</span>2, <span style="color: #6c3163;">[</span>1, 4<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">]</span> &lt; <span style="color: #3a81c3;">[</span>2, <span style="color: #6c3163;">[</span>1, 5<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">]</span>
</pre>
</div>
</div>
</li>
</ul>
</div>

<div id="outline-container-org9cae9de" class="outline-3">
<h3 id="org9cae9de"><span class="section-number-3">3.3</span> 断言语句</h3>
<div class="outline-text-3" id="text-3-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">age</span> = -1
<span style="color: #3a81c3; font-weight: bold;">assert</span> 0&lt;age&lt;100, <span style="color: #2d9574;">'message'</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;breakdown</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge22204b" class="outline-3">
<h3 id="orge22204b"><span class="section-number-3">3.4</span> while 语句</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">x</span>=1
<span style="color: #3a81c3; font-weight: bold;">while</span> x&lt;=100:
    <span style="color: #3a81c3; font-weight: bold;">print</span> x
    <span style="color: #715ab1;">x</span> += 1
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf1bcc6c" class="outline-3">
<h3 id="orgf1bcc6c"><span class="section-number-3">3.5</span> for 语句</h3>
<div class="outline-text-3" id="text-3-5">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">for</span> number <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #3a81c3;">(</span>1, 100<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> number
</pre>
</div>
<p>
range 包含下限 1，不包含上限 100<sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#24490;&#29615;&#36941;&#21382;&#23383;&#20856;</span>
<span style="color: #3a81c3; font-weight: bold;">for</span> key <span style="color: #3a81c3; font-weight: bold;">in</span> d:
    <span style="color: #3a81c3; font-weight: bold;">print</span> key, d<span style="color: #3a81c3;">[</span>key<span style="color: #3a81c3;">]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf087d49" class="outline-3">
<h3 id="orgf087d49"><span class="section-number-3">3.6</span> 拓展</h3>
<div class="outline-text-3" id="text-3-6">
</div>
<div id="outline-container-orgb6b9052" class="outline-4">
<h4 id="orgb6b9052"><span class="section-number-4">3.6.1</span> 列表推导式(轻量级循环)</h4>
<div class="outline-text-4" id="text-3-6-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">[</span>x*x <span style="color: #3a81c3; font-weight: bold;">for</span> x <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #6c3163;">(</span>10<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [0, 1, 4, 9, 25, 36, 49, 64, 81]</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21487;&#21152;&#26465;&#20214;&#65306;</span>
<span style="color: #3a81c3;">[</span>x*x <span style="color: #3a81c3; font-weight: bold;">for</span> x <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #6c3163;">(</span>10<span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">if</span> x % 3 ==0<span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;[0, 9, 36, 81]</span>

<span style="color: #3a81c3;">[</span><span style="color: #6c3163;">(</span>x, y<span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">for</span> x <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #6c3163;">(</span>3<span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">for</span> y <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #6c3163;">(</span>3<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;[(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1), (2, 2)]</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#31561;&#21516;&#20110;</span>
<span style="color: #715ab1;">result</span> = <span style="color: #3a81c3;">[]</span>
<span style="color: #3a81c3; font-weight: bold;">for</span> x <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #3a81c3;">(</span>3<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">for</span> y <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #3a81c3;">(</span>3<span style="color: #3a81c3;">)</span>:
result.append<span style="color: #3a81c3;">(</span><span style="color: #6c3163;">(</span>x, y<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org588c264" class="outline-4">
<h4 id="org588c264"><span class="section-number-4">3.6.2</span> 序列合并迭代(zip)</h4>
<div class="outline-text-4" id="text-3-6-2">
<p>
合并两个序列为一个元组列表
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">names</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'name1'</span>, <span style="color: #2d9574;">'name2'</span><span style="color: #3a81c3;">]</span>
<span style="color: #715ab1;">ages</span> = <span style="color: #3a81c3;">[</span>12, 45<span style="color: #3a81c3;">]</span>
<span style="color: #3a81c3;">zip</span><span style="color: #3a81c3;">(</span>names, ages<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [('name1', 12), ('name2', 45)]</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#35299;&#21253;&#20803;&#32452;&#65292;&#36941;&#21382;</span>
<span style="color: #3a81c3; font-weight: bold;">for</span> name, age <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">zip</span><span style="color: #3a81c3;">(</span>names, ages<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> name, <span style="color: #2d9574;">'is'</span>, age, <span style="color: #2d9574;">'years old'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org0e4819f" class="outline-4">
<h4 id="org0e4819f"><span class="section-number-4">3.6.3</span> 编号迭代(enumerate)</h4>
<div class="outline-text-4" id="text-3-6-3">
<p>
enumerate 函数可以在提供索引功能的序列中，迭代返回键值对。
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">for</span> index, string <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">enumerate</span><span style="color: #3a81c3;">(</span>strings<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #2d9574;">'xxx'</span> <span style="color: #3a81c3; font-weight: bold;">in</span> string:
    <span style="color: #715ab1;">strings</span><span style="color: #3a81c3;">[</span>index<span style="color: #3a81c3;">]</span> = <span style="color: #2d9574;">'[censored]'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd360130" class="outline-4">
<h4 id="orgd360130"><span class="section-number-4">3.6.4</span> 翻转和排序迭代(reversed, sorted)</h4>
<div class="outline-text-4" id="text-3-6-4">
<p class="verse">
reversed, sorted 与序列方法 reverse, sort 差不多，区别在于 reverse 和 sort 改变原调用对象<br />
sorted 函数返回列表<br />
reversed 函数返回一个可迭代对象<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">list</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3;">reversed</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">'Hello,World!'</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;'!dlroW,olleH'</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgda358be" class="outline-4">
<h4 id="orgda358be"><span class="section-number-4">3.6.5</span> for&#x2026;else 语句</h4>
<div class="outline-text-4" id="text-3-6-5">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">for</span> n <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #3a81c3;">(</span>99, 81, -1<span style="color: #3a81c3;">)</span>:
    <span style="color: #715ab1;">root</span> = sqrt<span style="color: #3a81c3;">(</span>n<span style="color: #3a81c3;">)</span>
    <span style="color: #3a81c3; font-weight: bold;">if</span> root == <span style="color: #3a81c3;">int</span><span style="color: #3a81c3;">(</span>root<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> n
	<span style="color: #3a81c3; font-weight: bold;">break</span>
<span style="color: #3a81c3; font-weight: bold;">else</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"Didn't find it!"</span>
</pre>
</div>
<p>
break 直接进入 else 语句块
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgdc276ce" class="outline-2">
<h2 id="orgdc276ce"><span class="section-number-2">4</span> 函数</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org7116a3b" class="outline-3">
<h3 id="org7116a3b"><span class="section-number-3">4.1</span> 定义函数</h3>
<div class="outline-text-3" id="text-4-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">fibs</span><span style="color: #3a81c3;">(</span>num<span style="color: #3a81c3;">)</span>:
    <span style="color: #da8b55;">'generate fib sequence'</span>
    <span style="color: #715ab1;">result</span> = <span style="color: #3a81c3;">[</span>0, 1<span style="color: #3a81c3;">]</span>
    <span style="color: #3a81c3; font-weight: bold;">for</span> i <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #3a81c3;">(</span>num-2<span style="color: #3a81c3;">)</span>:
	result.append<span style="color: #3a81c3;">(</span>result<span style="color: #6c3163;">[</span>-2<span style="color: #6c3163;">]</span> + result<span style="color: #6c3163;">[</span>-1<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
    <span style="color: #3a81c3; font-weight: bold;">return</span> result
</pre>
</div>
</div>
</div>
<div id="outline-container-orgecf41a7" class="outline-3">
<h3 id="orgecf41a7"><span class="section-number-3">4.2</span> 参数</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-orgfe88b16" class="outline-4">
<h4 id="orgfe88b16"><span class="section-number-4">4.2.1</span> 基本</h4>
<div class="outline-text-4" id="text-4-2-1">
<p class="verse">
函数内改变参数变量的值，不会改变外部传入变量的值。即值传递方式。<br />
可变的数据结构，如列表。即引用传递方式。<br />
</p>
</div>
</div>
<div id="outline-container-orgaa4def0" class="outline-4">
<h4 id="orgaa4def0"><span class="section-number-4">4.2.2</span> 不可变的数据结构，改变传入值的方法</h4>
<div class="outline-text-4" id="text-4-2-2">
<ul class="org-ul">
<li><p>
使用返回值
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">inc</span><span style="color: #3a81c3;">(</span>x<span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3; font-weight: bold;">return</span> x+1
</pre>
</div></li>

<li><p>
包在列表中传递
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">inc</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163;">[</span>x<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>: <span style="color: #715ab1;">x</span><span style="color: #3a81c3;">[</span>0<span style="color: #3a81c3;">]</span> = x<span style="color: #3a81c3;">[</span>0<span style="color: #3a81c3;">]</span> + 1
<span style="color: #715ab1;">foo</span> = <span style="color: #3a81c3;">[</span>10<span style="color: #3a81c3;">]</span>
inc<span style="color: #3a81c3;">(</span>foo<span style="color: #3a81c3;">)</span>
foo
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; 11</span>
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-org94abe11" class="outline-4">
<h4 id="org94abe11"><span class="section-number-4">4.2.3</span> 参数过多，顺序难记</h4>
<div class="outline-text-4" id="text-4-2-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">hello</span><span style="color: #3a81c3;">(</span>greeting, name<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'%s, %s'</span> % <span style="color: #3a81c3;">(</span>greeting, name<span style="color: #3a81c3;">)</span>

hello<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'Hello'</span>, <span style="color: #2d9574;">'world'</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21442;&#25968;&#39034;&#24207;&#38590;&#35760;&#26102;&#65292;&#20351;&#29992; &#21442;&#25968;&#21517;=&#20256;&#20837;&#20540; &#30340;&#24418;&#24335;</span>
hello<span style="color: #3a81c3;">(</span>greeting=<span style="color: #2d9574;">'Hello'</span>, name=<span style="color: #2d9574;">'world'</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf01ebd4" class="outline-4">
<h4 id="orgf01ebd4"><span class="section-number-4">4.2.4</span> 参数默认值</h4>
<div class="outline-text-4" id="text-4-2-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">hello2</span><span style="color: #3a81c3;">(</span>greeting=<span style="color: #2d9574;">'Hello'</span>, name=<span style="color: #2d9574;">'world'</span><span style="color: #3a81c3;">)</span>: <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#25552;&#20379;&#40664;&#35748;&#20540;</span>
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'%s, %s!'</span> % <span style="color: #3a81c3;">(</span>greeting, name<span style="color: #3a81c3;">)</span>
hello2<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Hello, world!</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org53e5c5f" class="outline-4">
<h4 id="org53e5c5f"><span class="section-number-4">4.2.5</span> 任意数量的参数</h4>
<div class="outline-text-4" id="text-4-2-5">
</div>
<ul class="org-ul">
<li><a id="org64555e3"></a>参数定义时加上'*'<br />
<div class="outline-text-5" id="text-org64555e3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">print_params</span><span style="color: #3a81c3;">(</span>title, *params<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> title, params<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#20256;&#20837;&#30340; params &#21442;&#25968;&#20250;&#20316;&#20026;&#20803;&#32452;&#20351;&#29992;</span>
print_params<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'Print params'</span>, <span style="color: #2d9574;">'param1'</span>, <span style="color: #2d9574;">'param2'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Print params</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Print params ('param1', 'param2')</span>

print_params<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'Nothing'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Nothing ()</span>
</pre>
</div>
</div>
</li>
<li><a id="org1032283"></a>参数定义时加上'**'<br />
<div class="outline-text-5" id="text-org1032283">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">print_params2</span><span style="color: #3a81c3;">(</span>**params<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> params<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#20256;&#20837;&#30340; params &#21442;&#25968;&#20250;&#20316;&#20026;&#23383;&#20856;&#20351;&#29992;</span>
print_params2<span style="color: #3a81c3;">(</span>x=1, y=2, z=3<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;( 'x' : 1, 'y' : 2, 'z' : 3)</span>
</pre>
</div>
</div>
</li>
</ul>
</div>
<div id="outline-container-orgd84a9ec" class="outline-4">
<h4 id="orgd84a9ec"><span class="section-number-4">4.2.6</span> 将元组和字典作为参数(以上逆过程)</h4>
<div class="outline-text-4" id="text-4-2-6">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#24207;&#21015;&#29992;&#27861;</span>
<span style="color: #3a81c3; font-weight: bold;">def</span>  <span style="color: #6c3163; font-weight: bold;">add</span><span style="color: #3a81c3;">(</span>x, y<span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3; font-weight: bold;">return</span> x + y
<span style="color: #715ab1;">params</span> = <span style="color: #3a81c3;">(</span>1, 2<span style="color: #3a81c3;">)</span>
add<span style="color: #3a81c3;">(</span>*params<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21152;&#19978;*</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;3</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#23383;&#20856;&#29992;&#27861;</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">hello3</span><span style="color: #3a81c3;">(</span>greeting=<span style="color: #2d9574;">'Hello'</span>, name=<span style="color: #2d9574;">'world'</span><span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'%s, %s!'</span> % <span style="color: #3a81c3;">(</span>greeting, name<span style="color: #3a81c3;">)</span>
<span style="color: #715ab1;">params</span> = <span style="color: #3a81c3;">{</span><span style="color: #2d9574;">'name'</span>: <span style="color: #2d9574;">'Sir Robin'</span>, <span style="color: #2d9574;">'greeting'</span>: <span style="color: #2d9574;">'Well met'</span><span style="color: #3a81c3;">}</span>
hello3<span style="color: #3a81c3;">(</span>**params<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21152;&#19978;**</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Well met, Sir Robin!</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7c49473" class="outline-4">
<h4 id="org7c49473"><span class="section-number-4">4.2.7</span> 变量作用域</h4>
<div class="outline-text-4" id="text-4-2-7">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">scope</span> = <span style="color: #3a81c3;">vars</span><span style="color: #3a81c3;">()</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">vars()&#36820;&#22238;&#20840;&#23616;&#21464;&#37327;&#30340;&#23383;&#20856;</span>
<span style="color: #715ab1;">x</span>=1
scope<span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'x'</span><span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;1</span>
<span style="color: #715ab1;">scope</span><span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'x'</span><span style="color: #3a81c3;">]</span> += 1
x
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;2</span>
</pre>
</div>
<p class="verse">
以上代码说明：<br />
赋值语句实际上是在一个全局变量字典中建立了一个键值对，<br />
只不过这个字典是对外隐藏的。这个“不可见”字典就是变量的作用域。<br />
能够创建变量作用域的代码段有 def、class、lamda。<br />
</p>
</div>
<ul class="org-ul">
<li><a id="orgb8db190"></a>函数内访问全局变量<br />
<div class="outline-text-5" id="text-orgb8db190">
<p>
在函数作用域内调用同名全局变量，需使用 globals()['globalName']
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">combine</span><span style="color: #3a81c3;">(</span>param<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> param + <span style="color: #3a81c3;">globals</span><span style="color: #3a81c3;">()[</span><span style="color: #2d9574;">'param'</span><span style="color: #3a81c3;">]</span>
<span style="color: #715ab1;">param</span> = <span style="color: #2d9574;">'berry'</span>
combine<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'Shrub'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Shrubberry</span>
</pre>
</div>
</div>
</li>

<li><a id="org9f009d9"></a>函数内改变全局变量<br />
<div class="outline-text-5" id="text-org9f009d9">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">x</span>=1
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">change_global</span><span style="color: #3a81c3;">()</span>:
    <span style="color: #3a81c3; font-weight: bold;">global</span> x
    <span style="color: #715ab1;">x</span> = x + 1
change_global<span style="color: #3a81c3;">()</span>
x
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;2</span>
</pre>
</div>
</div>
</li>
</ul>
</div>

<div id="outline-container-org7c0f4d7" class="outline-4">
<h4 id="org7c0f4d7"><span class="section-number-4">4.2.8</span> 递归</h4>
<div class="outline-text-4" id="text-4-2-8">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">power</span><span style="color: #3a81c3;">(</span>x, n<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">if</span> n == 0:
    <span style="color: #3a81c3; font-weight: bold;">return</span> 1
    <span style="color: #3a81c3; font-weight: bold;">else</span>:
    <span style="color: #3a81c3; font-weight: bold;">return</span> x * power<span style="color: #3a81c3;">(</span>x, n-1<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge25c6a3" class="outline-3">
<h3 id="orge25c6a3"><span class="section-number-3">4.3</span> 查看函数说明</h3>
<div class="outline-text-3" id="text-4-3">
<p>
fibs.__doc__ 可访问函数说明、help(fibs) 更好用
</p>
</div>
</div>
<div id="outline-container-orga65df0b" class="outline-3">
<h3 id="orga65df0b"><span class="section-number-3">4.4</span> 空返回值</h3>
<div class="outline-text-3" id="text-4-4">
<p>
函数如果无返回值，返回 None
</p>
</div>
</div>
<div id="outline-container-orgf5dce98" class="outline-3">
<h3 id="orgf5dce98"><span class="section-number-3">4.5</span> 闭包</h3>
<div class="outline-text-3" id="text-4-5">
</div>
<div id="outline-container-orgcc0fd18" class="outline-4">
<h4 id="orgcc0fd18"><span class="section-number-4">4.5.1</span> 快速预览</h4>
<div class="outline-text-4" id="text-4-5-1">
<p>
以下是一段简单的闭包代码示例：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">foo</span><span style="color: #3a81c3;">()</span>:
    <span style="color: #715ab1;">m</span>=3
    <span style="color: #715ab1;">n</span>=5
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">bar</span><span style="color: #3a81c3;">()</span>:
	<span style="color: #715ab1;">a</span>=4
	<span style="color: #3a81c3; font-weight: bold;">return</span> m+n+a
    <span style="color: #3a81c3; font-weight: bold;">return</span> bar

&gt;&gt;&gt;<span style="color: #715ab1;">bar</span> =  foo<span style="color: #3a81c3;">()</span>
&gt;&gt;&gt;bar<span style="color: #3a81c3;">()</span>
12
</pre>
</div>
<p class="verse">
说明：<br />
bar 在 foo 函数的代码块中定义。我们称 bar 是 foo 的内部函数。<br />
<br />
在 bar 的局部作用域中可以直接访问 foo 局部作用域中定义的 m、n 变量。<br />
简单的说，这种内部函数可以使用外部函数变量的行为，就叫闭包。<br />
<br />
那么闭包内部是如何来实现的呢？<br />
我们一步步来，先看两个 python 内置的 object: &lt;code&gt;和&lt;cell&gt;<br />
</p>
</div>
</div>
<div id="outline-container-org2461783" class="outline-4">
<h4 id="org2461783"><span class="section-number-4">4.5.2</span> code object</h4>
<div class="outline-text-4" id="text-4-5-2">
<p class="verse">
code object 是 python 代码经过编译后的对象。<br />
它用来存储一些与代码有关的信息以及 bytecode。<br />
<br />
以下代码示例，演示了如何通过编译产生 code object<br />
以及使用 exec 运行该代码，和使用 dis 方便地查看字节码。<br />
<br />
code object 还有很多的特性可以访问。详细请看官方文档。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> dis
<span style="color: #715ab1;">code_obj</span> = <span style="color: #3a81c3;">compile</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'sum([1,2,3])'</span>,  <span style="color: #2d9574;">''</span>, <span style="color: #2d9574;">'single'</span><span style="color: #3a81c3;">)</span>

&gt;&gt;&gt;<span style="color: #3a81c3; font-weight: bold;">exec</span><span style="color: #3a81c3;">(</span>code_obj<span style="color: #3a81c3;">)</span>
6

&gt;&gt;&gt; dis.dis<span style="color: #3a81c3;">(</span>code_obj<span style="color: #3a81c3;">)</span>
  1           0 LOAD_NAME                0 <span style="color: #3a81c3;">(</span><span style="color: #3a81c3;">sum</span><span style="color: #3a81c3;">)</span>
	      3 LOAD_CONST               0 <span style="color: #3a81c3;">(</span>1<span style="color: #3a81c3;">)</span>
	      6 LOAD_CONST               1 <span style="color: #3a81c3;">(</span>2<span style="color: #3a81c3;">)</span>
	      9 LOAD_CONST               2 <span style="color: #3a81c3;">(</span>3<span style="color: #3a81c3;">)</span>
	     12 BUILD_LIST                   3
	     15 CALL_FUNCTION          1
	     18 PRINT_EXPR
	     19 LOAD_CONST               3 <span style="color: #3a81c3;">(</span><span style="color: #4e3163;">None</span><span style="color: #3a81c3;">)</span>
	     22 RETURN_VALUE
</pre>
</div>
<p class="verse">
那么，这跟我们的例子有什么关系？<br />
</p>
<pre class="example">
&gt;&gt;&gt; foo.func_code
&lt;code object foo at 01FE92F0, file "&lt;pyshell#50&gt;", line 1&gt;
</pre>
<p class="verse">
我们可以看到，函数定义好之后，就可以通过[函数名.func_code]<br />
访问该函数的 code object，之后我们会用到它的一些特性。<br />
</p>
</div>
</div>
<div id="outline-container-org3c87155" class="outline-4">
<h4 id="org3c87155"><span class="section-number-4">4.5.3</span> cell object</h4>
<div class="outline-text-4" id="text-4-5-3">
<p class="verse">
cell 对象的引入，是为了实现被多个作用域引用的变量。<br />
对每一个这样的变量，都用一个 cell 对象来保存 <b>其值</b> 。<br />
<br />
拿之前的示例来说，m 和 n 既在 foo 函数的作用域中被引用，又在 bar<br />
函数的作用域中被引用，所以 m, n 引用的值，都会在一个 cell 对象中。<br />
<br />
可以通过内部函数的__closure__或者 func_closure 特性查看 cell 对象：<br />
</p>
<pre class="example">
&gt;&gt;&gt; bar = foo()
&gt;&gt;&gt; bar.__closure__
(&lt;cell at 0x01FE8DF0: int object at 0x0186D888&gt;, &lt;cell at 0x01F694B0: int object at 0x0186D870&gt;)
</pre>
<p class="verse">
这两个 int 型的 cell 分别存储了 m 和 n 的值。<br />
无论是在外部函数中定义，还是在内部函数中调用，引用的指向都是 cell 对象中的值。<br />
<br />
注：内部函数无法修改 cell 对象中的值，如果尝试修改 m 的值，编译器会认为 m 是函数<br />
bar 的局部变量，同时 foo 代码块中的 m 也会被认为是函数 foo 的局部变量，就会再把 m<br />
认作闭包变量，两个 m 分别在各自的作用域下起作用。<br />
</p>
</div>
</div>
<div id="outline-container-orgcf3b331" class="outline-4">
<h4 id="orgcf3b331"><span class="section-number-4">4.5.4</span> 闭包分析</h4>
<div class="outline-text-4" id="text-4-5-4">
<ul class="org-ul">
<li>使用 dis<sup><a id="fnr.3" class="footref" href="#fn.3">3</a></sup>模块分析 foo 的 bytecode。</li>
</ul>
<pre class="example">
2          0 LOAD_CONST              1 (3)
	    3 STORE_DEREF               0 (m)

3          6 LOAD_CONST              2 (5)
	    9 STORE_DEREF               1 (n)

4          12 LOAD_CLOSURE         0 (m)
	    15 LOAD_CLOSURE         1 (n)
	    18 BUILD_TUPLE              2
	    21 LOAD_CONST             3 (&lt;code object bar at 018D9848, file "&lt;pyshell#1&gt;", line 4&gt;)
	    24 MAKE_CLOSURE         0
	    27 STORE_FAST               0 (bar)

7          30 LOAD_FAST                 0 (bar)
	    33 RETURN_VALUE
</pre>
<p class="verse">
进行逐行分析：<br />
<br />
<b>LOAD_CONST  1 (3)</b> ：<br />
将 foo.func_code.co_consts <code>[1]</code> 的值"3"push 进栈。<br />
<br />
<b>STORE_DEREF  0 (m)</b> ：<br />
从栈顶 Pop 出"3"包装成 cell 对象存入 cell 与自由变量的存储区的第 0 槽。<br />
将 cell 对象的地址信息赋给变量 m(闭包变量名记录在 func_code.cellvars)。<br />
func_code.cellvars 的内容为('m', 'n')<br />
<br />
<b>LOAD_CLOSURE  0 (m)</b> ：<br />
将变量 m 的值 push 进栈，类似如下信息：<br />
&lt;cell at 0x01D572B0: int object at 0x0180D6F8&gt;<br />
<br />
<b>LOAD_CLOSURE  1 (n)</b> ：<br />
类似变量 m 的处理，不在累述。<br />
<br />
当前栈区状态：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">&lt;cell at 0x01D572B0: int object at 0x0180D6F8&gt;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">&lt;cell at 0x01D86510: int object at 0x0180D6E0&gt;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>
<p class="verse">
<br />
<b>BUILD_TUPLE  2</b> ：<br />
将栈顶的两项取出，创建元组，并将该元组 push 进栈。<br />
<br />
<b>LOAD_CONST  3</b> ：<br />
从 foo.func_code.co_consts <code>[3]</code> 取出，该项为内部函数 bar 的 code object 的地址，将其 push 进栈<br />
&lt;code object bar at 018D9848, file "&lt;pyshell#1&gt;", line 4&gt;<br />
<br />
栈区状态：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">&lt;code object bar at 018D9848, file "&lt;pyshell#1&gt;", line 4&gt;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">(&lt;cell at 0x01D572B0: int object at 0x0180D6F8&gt;, &lt;cell at 0x01D86510: int object at 0x0180D6E0&gt;)</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">&#x2026;</td>
</tr>
</tbody>
</table>
<p class="verse">
<br />
<b>MAKE_CLOSURE  0</b> ：<br />
创建一个函数对象，将位于栈顶的 code object(bar 函数的 code)地址信息赋<br />
给该函数对象的 func_code 特性；<br />
将栈顶第二项(包含 cell 对象地址的元组)赋给该函数对象的 func_closure 特性；<br />
最后将该函数对象地址信息 push 进栈。<br />
<br />
<b>STORE_FAST  0 (bar)</b> ：<br />
从栈顶取出之前创建的函数对象的地址信息赋给局部变量 bar(局部变量名记录在 func_code.co_varnames 中)<br />
func_code.co_varnames 的内容为('bar',)<br />
将变量 bar(记录在 func_code.cellvars <code>[0]</code> )绑定栈顶的函数对象地址。<br />
<b>LOAD_FAST  0 (bar)</b> ：<br />
将变量 bar 的值 push 进栈。<br />
<br />
<b>RETURN_VALUE</b><br />
返回栈顶项，print bar 可以看到&lt;function bar at 0x01D899F0&gt;<br />
<br />
</p>
<ul class="org-ul">
<li>再分析 bar 函数就简单了</li>
</ul>
<pre class="example">
5           0 LOAD_CONST            1 (4)
	     3 STORE_FAST               0 (a)

6           6 LOAD_DEREF               0 (m)
	     9 LOAD_DEREF               1 (n)
	     12 BINARY_ADD
	     13 LOAD_FAST               0 (a)
	     16 BINARY_ADD
	     17 RETURN_VALUE
</pre>
<p class="verse">
重点是 LOAD_DEREF，该方法主要是将 cell 对象中的 object 内容 push 进栈。大致过程如下：<br />
<br />
根据变量 m 的值找到包装在 cell 内的 int object 的地址信息<br />
m 的值：&lt;cell at 0x01D572B0: int object at 0x0180D6F8&gt;<br />
<br />
根据地址取出 int 值，push 进栈。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org029f06e" class="outline-3">
<h3 id="org029f06e"><span class="section-number-3">4.6</span> 函数柯里化</h3>
<div class="outline-text-3" id="text-4-6">
</div>
<div id="outline-container-org0430385" class="outline-4">
<h4 id="org0430385"><span class="section-number-4">4.6.1</span> 柯里化(Currying)</h4>
<div class="outline-text-4" id="text-4-6-1">
<p>
一个函数有多个参数，我们希望能固定其中几个参数的值。
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">from</span> functools <span style="color: #3a81c3; font-weight: bold;">import</span> partial
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">foo</span><span style="color: #3a81c3;">(</span>a,b,c<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">return</span> a+b+c

<span style="color: #715ab1;">foo2</span> = partial<span style="color: #3a81c3;">(</span>foo, b=2<span style="color: #3a81c3;">)</span>
foo2<span style="color: #3a81c3;">(</span>a=1, c=3<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;6</span>
</pre>
</div>
<p class="verse">
看上去这跟提供参数默认值的情况类似。但默认值只能固定<br />
为单个值，而柯里化能通过泛化出很多个函数，每个函数用<br />
不同的固定值，来看一下 <b>应用场景</b> ：<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">from</span> functools <span style="color: #3a81c3; font-weight: bold;">import</span> partial
<span style="color: #715ab1;">bin2dec</span> = partial<span style="color: #3a81c3;">(</span><span style="color: #3a81c3;">int</span>, base=2<span style="color: #3a81c3;">)</span>
<span style="color: #715ab1;">hex2dec</span> = partial<span style="color: #3a81c3;">(</span><span style="color: #3a81c3;">int</span>, base=16<span style="color: #3a81c3;">)</span>
</pre>
</div>
<p class="verse">
原 int 方法的定义为：int( x[, base])，base 参数的默认为 10<br />
经过柯里化之后，可以用如下方式调用：<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">int</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'15'</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;15  using default base 10</span>
bin2dec<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'01011'</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;11</span>
hex2dec<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'67'</span><span style="color: #3a81c3;">)</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;103</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbf8844e" class="outline-4">
<h4 id="orgbf8844e"><span class="section-number-4">4.6.2</span> 反柯里化(Uncurrying)</h4>
<div class="outline-text-4" id="text-4-6-2">
<p class="verse">
顾名思义，柯里化的逆过程。<br />
将多个只含单个参数的函数模拟成一个多参数函数。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">foo</span><span style="color: #3a81c3;">(</span>a<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">bar</span><span style="color: #3a81c3;">(</span>b<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">return</span> a+b
    <span style="color: #3a81c3; font-weight: bold;">return</span> bar
</pre>
</div>
<p>
你可以像这样调用：foo(1)(4)或(foo(1))(4)，都能得到正确的结果 5。
</p>
<ul class="org-ul">
<li>那么反柯里化有什么用？</li>
</ul>
<p class="verse">
一些函数式编程语言，就是利用反柯里化来实现多参数函数。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org8310e5a" class="outline-3">
<h3 id="org8310e5a"><span class="section-number-3">4.7</span> 拓展</h3>
<div class="outline-text-3" id="text-4-7">
</div>
<div id="outline-container-org419b3a7" class="outline-4">
<h4 id="org419b3a7"><span class="section-number-4">4.7.1</span> 斐波那契数列</h4>
<div class="outline-text-4" id="text-4-7-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">fibs</span> = <span style="color: #3a81c3;">[</span>0, 1<span style="color: #3a81c3;">]</span>
<span style="color: #3a81c3; font-weight: bold;">for</span> i <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #3a81c3;">(</span>8<span style="color: #3a81c3;">)</span>:
    fibs.append<span style="color: #3a81c3;">(</span>fibs<span style="color: #6c3163;">[</span>-2<span style="color: #6c3163;">]</span> + fibs<span style="color: #6c3163;">[</span>-1<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
fibs
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#25277;&#35937;&#25104;</span>
fibs<span style="color: #3a81c3;">(</span>num<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org0dd81d7" class="outline-4">
<h4 id="org0dd81d7"><span class="section-number-4">4.7.2</span> map/reduce/filter</h4>
<div class="outline-text-4" id="text-4-7-2">
</div>
<ul class="org-ul">
<li><a id="org33d9ebc"></a>map<br />
<div class="outline-text-5" id="text-org33d9ebc">
<p>
map(func, seq1, seq2, &#x2026;])
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">map</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">lambda</span> x,y: x+y, <span style="color: #6c3163;">[</span>1,2,3,4,5<span style="color: #6c3163;">]</span>, <span style="color: #6c3163;">[</span>6,7,8,9,10<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">seq1 &#23545;&#24212; arg1, seq2 &#23545;&#24212; arg2</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;[7, 9, 11, 13, 15]</span>
</pre>
</div>
</div>
</li>
<li><a id="org72a3cab"></a>reduce<br />
<div class="outline-text-5" id="text-org72a3cab">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">reduce</span><span style="color: #3a81c3;">(</span>func, seq<span style="color: #3a81c3;">)</span>
&#31561;&#21516;&#20110; func<span style="color: #3a81c3;">(</span>func<span style="color: #6c3163;">(</span>func<span style="color: #2d9574;">(</span>seq<span style="color: #67b11d;">[</span>0<span style="color: #67b11d;">]</span>, seq<span style="color: #67b11d;">[</span>1<span style="color: #67b11d;">]</span><span style="color: #2d9574;">)</span>, seq<span style="color: #2d9574;">[</span>2<span style="color: #2d9574;">]</span><span style="color: #6c3163;">)</span>...<span style="color: #3a81c3;">)</span>
eg:
<span style="color: #3a81c3;">reduce</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">lambda</span> x, y: x+y, <span style="color: #6c3163;">[</span>1, 2, 3, 4, 5<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;15</span>
</pre>
</div>
</div>
</li>
<li><a id="org34dc982"></a>filter<br />
<div class="outline-text-5" id="text-org34dc982">
<p class="verse">
filter(func, seq)<br />
func 需返回布尔值<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">filter</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">lambda</span> x: x&gt;3 <span style="color: #3a81c3; font-weight: bold;">and</span> <span style="color: #4e3163;">True</span> <span style="color: #3a81c3; font-weight: bold;">or</span> <span style="color: #4e3163;">False</span>, <span style="color: #6c3163;">[</span>1,2,3,4,5<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;[4,5]</span>
<span style="color: #3a81c3;">filter</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">lambda</span> x: <span style="color: #4e3163;">True</span> <span style="color: #3a81c3; font-weight: bold;">if</span> x&gt;3 <span style="color: #3a81c3; font-weight: bold;">else</span> <span style="color: #4e3163;">False</span>, <span style="color: #6c3163;">[</span>1,2,3,4,5<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;[4,5]</span>
</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org8ba4022" class="outline-2">
<h2 id="org8ba4022"><span class="section-number-2">5</span> 类</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgb66bd42" class="outline-3">
<h3 id="orgb66bd42"><span class="section-number-3">5.1</span> 定义类</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">Person</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">setName</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span>, name<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">self</span>.name = name

    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">getName</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.name

    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">greet</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"Hello, world! I'm %s"</span> % <span style="color: #3a81c3; font-weight: bold;">self</span>.name
</pre>
</div>
</div>
<div id="outline-container-org00c6393" class="outline-4">
<h4 id="org00c6393"><span class="section-number-4">5.1.1</span> self 参数</h4>
<div class="outline-text-4" id="text-5-1-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">A</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">a</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'Hello'</span>

<span style="color: #715ab1;">i</span> = A<span style="color: #3a81c3;">()</span>
i.a
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&lt;bound method A.a of &lt;__main__.A instance at 0x01E26648&gt;&gt;</span>
i.a<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Hello</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#31561;&#21516;&#20110;</span>
A.a<span style="color: #3a81c3;">(</span>i<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Hello</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org42c1f7d" class="outline-4">
<h4 id="org42c1f7d"><span class="section-number-4">5.1.2</span> 函数的变量绑定</h4>
<div class="outline-text-4" id="text-5-1-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">A</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">a</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'Hello'</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">b</span><span style="color: #3a81c3;">()</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'World'</span>

<span style="color: #715ab1;">i</span>=A<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">i.a</span>=b<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">i.a &#26159;&#19968;&#20010;&#29305;&#24615;&#65292;&#21487;&#20197;&#32465;&#23450;&#20219;&#20309;&#26041;&#27861;</span>
i.a
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&lt;function b at 0x01E279B0&gt;</span>
i.a<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;World</span>
A.a<span style="color: #3a81c3;">(</span>i<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Hello</span>

<span style="color: #715ab1;">i2</span>=A<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">c</span>=i2.a<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">c &#26159;&#26041;&#27861;&#21464;&#37327;</span>
c
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&lt;bound method A.b of &lt;__main__.A instance at 0x01E2F8A0&gt;&gt;</span>
c<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Hello</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc8611ee" class="outline-4">
<h4 id="orgc8611ee"><span class="section-number-4">5.1.3</span> 私有成员</h4>
<div class="outline-text-4" id="text-5-1-3">
<p class="verse">
python 不直接支持私有成员。<br />
需要程序员自己把握从外部调用实例成员的时机<br />
小技巧：加上双下划线__，使方法变为对外不可见<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">Secretive</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__inaccessible</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"You can't find me"</span>
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">accessible</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"You can find me"</span>
	<span style="color: #3a81c3; font-weight: bold;">self</span>.__inaccessible<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">i</span>=Secretive<span style="color: #3a81c3;">()</span>
i.__inaccessible<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Error</span>
i.accessible<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;You can find me</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;You can't find me</span>
</pre>
</div>
</div>
<ul class="org-ul">
<li><a id="org855d511"></a>内幕<br />
<div class="outline-text-5" id="text-org855d511">
<p>
所有的以双下划线开头的成员方法"__方法名"，都被转成"_类名__方法名"
</p>
<div class="org-src-container">
<pre class="src src-python">Secretive._Secretive__inaccessible
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&lt;unbound method Secretive.__inaccessible&gt;</span>
i._Secretive__inaccessible<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;You can't find me</span>
</pre>
</div>
</div>
</li>
<li><a id="orga222139"></a>使用单下划线<br />
<div class="outline-text-5" id="text-orga222139">
<p class="verse">
这更像是一种习惯或者约定，程序员看到'_'开头的方法时，就不应该再从外部访问该方法。<br />
在使用 import 导入的时候，这些成员也不会被列出。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">_privateMethod</span><span style="color: #3a81c3;">()</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"You should not invoke this from outside"</span>
</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-org6ce9f13" class="outline-3">
<h3 id="org6ce9f13"><span class="section-number-3">5.2</span> 类成员变量(非实例成员)</h3>
<div class="outline-text-3" id="text-5-2">
<p>
定义一个 Class 时，类空间域中的代码都会执行。
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">C</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"Class C"</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#20250;&#34987;&#25191;&#34892;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Class C</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">A</span>:
    <span style="color: #715ab1;">count</span> = 0<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#23450;&#20041;&#20102;&#19968;&#20010;&#31867;&#25104;&#21592; number &#24182;&#21021;&#22987;&#21270;&#20026; 0&#65292;&#26377;&#28857;&#31867;&#20284;&#20110;&#20854;&#20182;&#35821;&#35328;&#30340;&#38745;&#24577;&#25104;&#21592;</span>
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">init</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #715ab1;">A.count</span> += 1

<span style="color: #715ab1;">m1</span>=A<span style="color: #3a81c3;">()</span>
m1.init<span style="color: #3a81c3;">()</span>
A.count
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;1</span>

<span style="color: #715ab1;">m2</span>=A<span style="color: #3a81c3;">()</span>
m2.init<span style="color: #3a81c3;">()</span>
A.count
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;2</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#23454;&#20363;&#20316;&#29992;&#22495;&#21516;&#26679;&#36866;&#29992;</span>
m1.count
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;2</span>
m2.count
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;2</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#23454;&#20363;&#20316;&#29992;&#22495;&#24050;&#20998;&#24320;</span>
<span style="color: #715ab1;">m1.count</span> = 5<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21019;&#24314;&#20102; m1 &#30340;&#25104;&#21592;&#21464;&#37327; count&#65292;m1.count &#19981;&#20877;&#32465;&#23450;&#31867;&#21464;&#37327; A.count</span>
m1.count
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;5</span>
m2.count
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;2</span>
m1.__dict__
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;{'count': 5}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org839a59b" class="outline-3">
<h3 id="org839a59b"><span class="section-number-3">5.3</span> 类静态方法和类方法</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">StaticMethodTest</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">staticMeth</span><span style="color: #3a81c3;">()</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'calling static method'</span>
    <span style="color: #715ab1;">staticMeth</span>=<span style="color: #3a81c3;">staticmethod</span><span style="color: #3a81c3;">(</span>staticMeth<span style="color: #3a81c3;">)</span>
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">classMeth</span><span style="color: #3a81c3;">(</span>cls<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'calling class method'</span>
    <span style="color: #715ab1;">classMeth</span>=<span style="color: #3a81c3;">classmethod</span><span style="color: #3a81c3;">(</span>classMeth<span style="color: #3a81c3;">)</span>
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">instanceMeth</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'calling instance method'</span>

<span style="color: #715ab1;">s</span> = StaticMethodTest<span style="color: #3a81c3;">()</span>
s.staticMeth<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;calling static method</span>
s.classMeth<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;calling class method</span>
s.instanceMeth<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;calling instance method</span>
StaticMethodTest.staticMeth<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;calling static method</span>
StaticMethodTest.classMeth<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;calling class method</span>
StaticMethodTest.instanceMeth<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; unbounded method error</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #000000; background-color: #dec;">#dec</span><span style="color: #2aa1ae; background-color: #ecf3ec;">orators &#26032;&#35821;&#27861;</span>
<span style="color: #715ab1;">__metaclass__</span>=<span style="color: #3a81c3;">type</span>
  <span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">StaticMethodTest</span>:
      <span style="color: #ba2f59; font-weight: bold;">@staticmethod</span>
      <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">staticMeth</span><span style="color: #3a81c3;">()</span>:
	  <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'calling static method'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd379c73" class="outline-3">
<h3 id="orgd379c73"><span class="section-number-3">5.4</span> 属性</h3>
<div class="outline-text-3" id="text-5-4">
</div>
<div id="outline-container-org00647d7" class="outline-4">
<h4 id="org00647d7"><span class="section-number-4">5.4.1</span> 适用新式类</h4>
<div class="outline-text-4" id="text-5-4-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">__metaclass__</span>=<span style="color: #3a81c3;">type</span>
<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">Retangle</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__init__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">self</span>.width=0
	<span style="color: #3a81c3; font-weight: bold;">self</span>.height=0
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">setSize</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span>, size<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">self</span>.width, <span style="color: #3a81c3; font-weight: bold;">self</span>.height=size
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">getSize</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.width, <span style="color: #3a81c3; font-weight: bold;">self</span>.height
    <span style="color: #715ab1;">size</span> = <span style="color: #3a81c3;">property</span><span style="color: #3a81c3;">(</span>getSize, setSize<span style="color: #3a81c3;">)</span>

<span style="color: #715ab1;">r</span> = Retangle<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">r.width</span>=10
<span style="color: #715ab1;">r.height</span>=5
r.size
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;(10, 5)</span>
<span style="color: #715ab1;">r.size</span> = 150, 100
r.width
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;150</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf7d057c" class="outline-4">
<h4 id="orgf7d057c"><span class="section-number-4">5.4.2</span> 适用旧式类</h4>
<div class="outline-text-4" id="text-5-4-2">
<ul class="org-ul">
<li>__getattr__(self,name)</li>
<li>__setattr__(self,name,value)</li>
<li>__delattr__(self,name)</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">Retangle</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__setattr__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span>, name, value<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">if</span> name ==<span style="color: #2d9574;">'size'</span>:
	    <span style="color: #3a81c3; font-weight: bold;">self</span>.width, <span style="color: #3a81c3; font-weight: bold;">self</span>.height = value
	<span style="color: #3a81c3; font-weight: bold;">else</span>:
	    <span style="color: #3a81c3; font-weight: bold;">self</span>.__dict__<span style="color: #3a81c3;">[</span>name<span style="color: #3a81c3;">]</span> = value
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__getattr__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span>,name<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">if</span> name == <span style="color: #2d9574;">'size'</span>:
	    <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.width, <span style="color: #3a81c3; font-weight: bold;">self</span>.height
	<span style="color: #3a81c3; font-weight: bold;">else</span>:
	    <span style="color: #3a81c3; font-weight: bold;">raise</span> <span style="color: #ba2f59; font-weight: bold;">AttributeError</span>
</pre>
</div>
<p class="verse">
注：只有特性不存在时，才会调用__getattr__。<br />
本例中 self.size 特性不存在，__getattr__会被调用。<br />
如果访问 width 特性，则不会调用__getattr__。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgad7c284" class="outline-3">
<h3 id="orgad7c284"><span class="section-number-3">5.5</span> 继承</h3>
<div class="outline-text-3" id="text-5-5">
</div>
<div id="outline-container-org07e0a6d" class="outline-4">
<h4 id="org07e0a6d"><span class="section-number-4">5.5.1</span> 定义子类</h4>
<div class="outline-text-4" id="text-5-5-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">Parent</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">init</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"Init Parent done"</span>

<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">ChildA</span><span style="color: #3a81c3;">(</span>Parent<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">init</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#37325;&#20889;&#29238;&#31867;&#30340; init &#26041;&#27861;</span>
	<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"Init Child done"</span>

<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">ChildB</span><span style="color: #3a81c3;">(</span>Parent<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">pass</span>

<span style="color: #715ab1;">p</span> = Parent<span style="color: #3a81c3;">()</span>
p.init<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Init Parent done</span>
<span style="color: #715ab1;">a</span> = ChildA<span style="color: #3a81c3;">()</span>
a.init<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Init Chile done</span>
<span style="color: #715ab1;">b</span> = ChildB<span style="color: #3a81c3;">()</span>
b.init<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Init Parent done</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org99ae781" class="outline-4">
<h4 id="org99ae781"><span class="section-number-4">5.5.2</span> 查询类继承关系</h4>
<div class="outline-text-4" id="text-5-5-2">
<ul class="org-ul">
<li>issubclass(sub, parent) 判断两个类是否为父子关系</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">issubclass</span><span style="color: #3a81c3;">(</span>ChildA, Parent<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;True</span>
</pre>
</div>
<ul class="org-ul">
<li>sub.__bases__ 查找一个类的父类</li>
</ul>
<div class="org-src-container">
<pre class="src src-python">ChildA
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&lt;class __main__.ChildB at 0x01E44EA0&gt;</span>
ChildA.__bases__<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#26597;&#25214;&#29238;&#31867;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;(&lt;class __main__.Parent at 0x01E1F340&gt;,)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge7ec5a8" class="outline-4">
<h4 id="orge7ec5a8"><span class="section-number-4">5.5.3</span> 查询对象的类别</h4>
<div class="outline-text-4" id="text-5-5-3">
<ul class="org-ul">
<li>isinstance(instance, class) 判断对象是否属于某类</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">isinstance</span><span style="color: #3a81c3;">(</span>a, ChildA<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;True</span>
<span style="color: #3a81c3;">isinstance</span><span style="color: #3a81c3;">(</span>a, Parent<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;True</span>
</pre>
</div>
<ul class="org-ul">
<li>instance or instance.__class__ 查询对象属于哪个类</li>
</ul>
<div class="org-src-container">
<pre class="src src-python">a
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&lt;__main__.ChildA instance at 0x01E181C0&gt;</span>
a.__class__
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&lt;class __main__.ChildA at 0x01E32030&gt;</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org6e8059a" class="outline-3">
<h3 id="org6e8059a"><span class="section-number-3">5.6</span> 多重继承</h3>
<div class="outline-text-3" id="text-5-6">
<p class="verse">
经典类指的是没有继承任何基类直接定义的类。<br />
新式类指的是基类为"object"的类。<br />
- 特性搜寻算法(MRO)<br />
[旧]深度优先，从左到右进行搜索。<br />
[新]广度优先，从继承层次下层从左到右开始搜索。<br />
</p>
<p>
   <img src="../resources/python/MultipleInheritance.png" alt="MultipleInheritance.png" />
经典类算法：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">gc</span>=GC<span style="color: #3a81c3;">()</span>
gc.foo<span style="color: #3a81c3;">()</span> <span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">GC==&gt;C1==&gt;P1</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;called P1-foo()</span>
gc.bar<span style="color: #3a81c3;">()</span> <span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">GC==&gt;C1==&gt;P1==&gt;P2</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;called P2-bar()</span>
C2.bar<span style="color: #3a81c3;">(</span>gc<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#25165;&#20250;&#35843;&#29992; C2 &#20013;&#30340; bar</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;called C2-bar()</span>
</pre>
</div>
<p class="verse">
问题在于 C2 在继承树上与 GC 更亲近，一般的思维习惯是调用 C2<br />
<br />
新式类算法：<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">gc</span>=GC<span style="color: #3a81c3;">()</span>
gc.foo<span style="color: #3a81c3;">()</span> <span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">GC==&gt;C1==&gt;C2==&gt;P1</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;called P1-foo()</span>
gc.bar<span style="color: #3a81c3;">()</span> <span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">GC==&gt;C1==&gt;C2</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;called C2-bar()</span>
</pre>
</div>
<p>
新式类可使用__mro__特性查看 mro 顺序
</p>
<div class="org-src-container">
<pre class="src src-python">GC.__mro__
<span style="color: #3a81c3;">(</span>&lt;<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #2d9574;">'__main__.GC'</span>&gt;, &lt;<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #2d9574;">'__main__.C1'</span>&gt;, &lt;<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #2d9574;">'__main__.C2'</span>&gt;, &lt;<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #2d9574;">'__main__.P1'</span>&gt;, &lt;<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #2d9574;">'__main__.P2'</span>&gt;, &lt;<span style="color: #3a81c3;">type</span> <span style="color: #2d9574;">'object'</span>&gt;<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org56cd1e5" class="outline-3">
<h3 id="org56cd1e5"><span class="section-number-3">5.7</span> 接口和内省</h3>
<div class="outline-text-3" id="text-5-7">
<p class="verse">
<b>Python 不需要单独定义接口或抽象类</b><br />
Python 变量 a，无所谓它是什么类型。调用 a.func 时，<br />
只要保证对象 a 中存在特性 func 就能正常调用。<br />
这就是 Python 强大的内省机制(即在运行时，获取对象的全部信息)。<br />
</p>
<ul class="org-ul">
<li>hasattr 检查特性是否存在</li>
</ul>
<div class="org-src-container">
<pre class="src src-python">  <span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">A</span>:
      <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">printNote</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	  <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"A"</span>
<span style="color: #715ab1;">a</span> = A<span style="color: #3a81c3;">()</span>
<span style="color: #3a81c3;">hasattr</span><span style="color: #3a81c3;">(</span>a, <span style="color: #2d9574;">'printNote'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;True</span>
<span style="color: #3a81c3;">hasattr</span><span style="color: #3a81c3;">(</span>a,<span style="color: #2d9574;">'print'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;False</span>
</pre>
</div>
<ul class="org-ul">
<li>getattr(obj, 'attr', None) 获取特性信息。第三个参数表示找不到该属性时，返回的值 。</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#29978;&#33267;&#21487;&#20197;&#26816;&#26597;&#26159;&#21542;&#21487;&#35843;&#29992;</span>
<span style="color: #3a81c3;">getattr</span><span style="color: #3a81c3;">(</span>a,<span style="color: #2d9574;">'printNote'</span>,<span style="color: #4e3163;">None</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">3.0 &#20013;&#24050;&#19981;&#20877;&#20351;&#29992;, getattr &#21487;&#20197;&#20351;&#29992;&#40664;&#35748;&#20540;&#65292;&#27492;&#22788;&#26159; None</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&lt;bound method A.printNote of &lt;__main__.A instance at 0x01DA4C88&gt;&gt;</span>

<span style="color: #3a81c3;">setattr</span><span style="color: #3a81c3;">(</span>a,<span style="color: #2d9574;">'name'</span>,<span style="color: #2d9574;">'Mr.Gumby'</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#30456;&#23545;&#24212;&#30340;&#26041;&#27861; Setattr</span>
&gt;&gt;&gt;a.name
<span style="color: #2d9574;">'Mr.Gumby'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcecd3d2" class="outline-3">
<h3 id="orgcecd3d2"><span class="section-number-3">5.8</span> 类的特殊特性总结</h3>
<div class="outline-text-3" id="text-5-8">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">特性</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">__dict__</td>
<td class="org-left">类名字空间的特性字典</td>
</tr>

<tr>
<td class="org-left">__doc__</td>
<td class="org-left">类的文档说明字符串</td>
</tr>

<tr>
<td class="org-left">__name__</td>
<td class="org-left">类的名称</td>
</tr>

<tr>
<td class="org-left">__module__</td>
<td class="org-left">类的模块名</td>
</tr>

<tr>
<td class="org-left">__bases__</td>
<td class="org-left">该类所有父类组成的元组</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-org9a7234c" class="outline-2">
<h2 id="org9a7234c"><span class="section-number-2">6</span> 异常</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org4610089" class="outline-3">
<h3 id="org4610089"><span class="section-number-3">6.1</span> 抛出异常</h3>
<div class="outline-text-3" id="text-6-1">
<p>
使用 raise 语句抛出异常
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">raise</span> <span style="color: #ba2f59; font-weight: bold;">Exception</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'Error occured'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Traceback (most recent call last):</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;  File "&lt;pyshell#96&gt;", line 1, in &lt;module&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;    raise Exception('Error occured')</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Exception: Error occured</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb8e5d75" class="outline-3">
<h3 id="orgb8e5d75"><span class="section-number-3">6.2</span> 内建异常类</h3>
<div class="outline-text-3" id="text-6-2">
<p class="verse">
参考手册“Built-in Exceptions”一节。<br />
内建异常都在 exceptions 模块<br />
</p>
</div>
</div>
<div id="outline-container-org0002e70" class="outline-3">
<h3 id="org0002e70"><span class="section-number-3">6.3</span> 自定义异常类</h3>
<div class="outline-text-3" id="text-6-3">
<p>
只需创建类时，继承 Exception 基类即可。
</p>
</div>
</div>
<div id="outline-container-org478fc19" class="outline-3">
<h3 id="org478fc19"><span class="section-number-3">6.4</span> 捕捉异常</h3>
<div class="outline-text-3" id="text-6-4">
<ul class="org-ul">
<li>try/except 语句</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> exceptions
<span style="color: #3a81c3; font-weight: bold;">try</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> 5/0
<span style="color: #3a81c3; font-weight: bold;">except</span> <span style="color: #ba2f59; font-weight: bold;">ZeroDivisionError</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">"Error: modulo by zero"</span>
<span style="color: #3a81c3; font-weight: bold;">except</span> <span style="color: #3a81c3;">(</span><span style="color: #ba2f59; font-weight: bold;">TypeError</span>, <span style="color: #ba2f59; font-weight: bold;">NameError</span><span style="color: #3a81c3;">)</span>, e:<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#22810;&#20010;&#24322;&#24120;&#65292;&#25918;&#20837;&#20803;&#32452;&#20013;&#25429;&#25417;&#65292;e &#26159;&#24322;&#24120;&#23454;&#20363;</span>
    <span style="color: #3a81c3; font-weight: bold;">print</span> e
</pre>
</div>
<p>
注：3.0 中改为 except(TypeError, NameError) as e
</p>
<ul class="org-ul">
<li>try/except/else 语句</li>
</ul>
<p class="verse">
当未捕捉到异常时，执行 else 语句块<br />
</p>
<ul class="org-ul">
<li>try/except/finally</li>
</ul>
<p>
finally 语句块无论是否捕捉到异常都会被执行，多用于清理资源。
</p>
</div>
</div>
<div id="outline-container-orgcba519e" class="outline-3">
<h3 id="orgcba519e"><span class="section-number-3">6.5</span> 常用异常类列表</h3>
<div class="outline-text-3" id="text-6-5">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">类名</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Excepition</td>
<td class="org-left">异常基类</td>
</tr>

<tr>
<td class="org-left">AttributeError</td>
<td class="org-left">特性引用或赋值失败</td>
</tr>

<tr>
<td class="org-left">IOError</td>
<td class="org-left">文件 IO 异常</td>
</tr>

<tr>
<td class="org-left">IndexError</td>
<td class="org-left">使用序列中不存在的索引</td>
</tr>

<tr>
<td class="org-left">KeyError</td>
<td class="org-left">使用映射中不存在的键</td>
</tr>

<tr>
<td class="org-left">NameError</td>
<td class="org-left">找不到特性(变量)名</td>
</tr>

<tr>
<td class="org-left">SyntaxError</td>
<td class="org-left">代码语法错误</td>
</tr>

<tr>
<td class="org-left">TypeError</td>
<td class="org-left">方法传入参数类型错误</td>
</tr>

<tr>
<td class="org-left">ValueError</td>
<td class="org-left">方法传入不合适的值，类型正确</td>
</tr>

<tr>
<td class="org-left">ZeroDivisionError</td>
<td class="org-left">除数为 0</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org928eb35" class="outline-3">
<h3 id="org928eb35"><span class="section-number-3">6.6</span> DB 相关异常列表</h3>
<div class="outline-text-3" id="text-6-6">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">异常</th>
<th scope="col" class="org-left">基类</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">StandardError</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">所有异常的基类</td>
</tr>

<tr>
<td class="org-left">Warning</td>
<td class="org-left">StandardError</td>
<td class="org-left">非致命错误时引发</td>
</tr>

<tr>
<td class="org-left">Error</td>
<td class="org-left">StandardError</td>
<td class="org-left">所有错误类型的基类</td>
</tr>

<tr>
<td class="org-left">InterfaceError</td>
<td class="org-left">Error</td>
<td class="org-left">接口错误</td>
</tr>

<tr>
<td class="org-left">DatabaseError</td>
<td class="org-left">Error</td>
<td class="org-left">与数据库相关的错误基类</td>
</tr>

<tr>
<td class="org-left">DataError</td>
<td class="org-left">DatabaseError</td>
<td class="org-left">与数据相关的问题，值超出范围</td>
</tr>

<tr>
<td class="org-left">OperationalError</td>
<td class="org-left">DatabaseError</td>
<td class="org-left">数据库内部操作错误</td>
</tr>

<tr>
<td class="org-left">IntegrityError</td>
<td class="org-left">DatabaseError</td>
<td class="org-left">关系完整性错误，如键检查失败</td>
</tr>

<tr>
<td class="org-left">InternalError</td>
<td class="org-left">DatabaseError</td>
<td class="org-left">数据库内部错误</td>
</tr>

<tr>
<td class="org-left">ProgrammingError</td>
<td class="org-left">DatabaseError</td>
<td class="org-left">用户编程错误，如未找到表</td>
</tr>

<tr>
<td class="org-left">NotSupportError</td>
<td class="org-left">DatabaseError</td>
<td class="org-left">请求不支持的特性，如回滚</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-orgacfa166" class="outline-2">
<h2 id="orgacfa166"><span class="section-number-2">7</span> 高级特性和隐藏特性</h2>
<div class="outline-text-2" id="text-7">
<p class="verse">
大多数隐藏特性，只对新式类起作用。可将赋值语句__metaclass__=type 放在模块<br />
的最开始，或者定义类时继承自 object 类，来定义新式类。3.0 起没有“旧式“类了。<br />
</p>
</div>
<div id="outline-container-orge79a24c" class="outline-3">
<h3 id="orge79a24c"><span class="section-number-3">7.1</span> __init__、__del__</h3>
<div class="outline-text-3" id="text-7-1">
<p class="verse">
分别对应构造和析构方法，构造函数是被使用的最多的隐藏方法。<br />
析构函数由于其内存释放的不确定性，调用时机未知，一般不建议使用。<br />
</p>
</div>
<div id="outline-container-orgb147df5" class="outline-4">
<h4 id="orgb147df5"><span class="section-number-4">7.1.1</span> 继承体系中的__init__</h4>
<div class="outline-text-4" id="text-7-1-1">
<p class="verse">
__init__和一般的方法一样，子类会重写父类的构造。<br />
为了调用父类的构造，一般有两种方法：<br />
</p>
<ul class="org-ul">
<li>调用未绑定的父类构造方法</li>
</ul>
<p class="verse">
该方法是 3.0 以前的老方法，属于历史遗留问题。<br />
使用 super 函数简单明了。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">Drived</span><span style="color: #3a81c3;">(</span>Base<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__init__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	Base.__init__<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#35843;&#29992;&#22522;&#31867;&#26500;&#36896;</span>
	<span style="color: #3a81c3; font-weight: bold;">self</span>.var1=5<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#33258;&#36523;&#29305;&#24615;&#36171;&#20540;</span>
</pre>
</div>
<ul class="org-ul">
<li>使用 super 函数</li>
</ul>
<p class="verse">
只适用于新式类。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">Drived</span><span style="color: #3a81c3;">(</span>Base<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__init__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3;">super</span><span style="color: #3a81c3;">(</span>Drived, <span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>.__init__<span style="color: #3a81c3;">()</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org62d40a1" class="outline-3">
<h3 id="org62d40a1"><span class="section-number-3">7.2</span> 集合相关__len__、__getitem__等</h3>
<div class="outline-text-3" id="text-7-2">
<p>
需要自行实现的隐藏方法有：
</p>
<ol class="org-ol">
<li>__len__(self)</li>
<li>__getitem__(self,key)</li>
<li>__setitem__(self,key,value)</li>
<li>__delitem__(self,key)</li>
</ol>

<p>
注意点：
</p>
<ul class="org-ul">
<li>键允许是负整数</li>
</ul>

<p class="verse">
完全自己实现，代价太大，而且不一定实现的很好。<br />
一般的做法：继承 UserList, UserString, UserDict<br />
最新版本的 python 中，可以继承内建类了。可以直接继承内建 list 类。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">CounterList</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3;">list</span><span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__init__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span>, *args<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3;">super</span><span style="color: #3a81c3;">(</span>CounterList, <span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>.__init__<span style="color: #3a81c3;">(</span>*args<span style="color: #3a81c3;">)</span>
	<span style="color: #3a81c3; font-weight: bold;">self</span>.counter = 0
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__getitem__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span>, index<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">self</span>.counter += 1
	<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3;">super</span><span style="color: #3a81c3;">(</span>CounterList, <span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>.__getitem__<span style="color: #3a81c3;">(</span>index<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1211bd0" class="outline-3">
<h3 id="org1211bd0"><span class="section-number-3">7.3</span> 迭代器__iter__</h3>
<div class="outline-text-3" id="text-7-3">
<p class="verse">
迭代器需要实现 next 方法，如果实现了__iter__方法，说明其是可迭代的。<br />
因为__iter__方法定义，需要返回一个迭代器。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">Fibs</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__init__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">self</span>.a = 0
	<span style="color: #3a81c3; font-weight: bold;">self</span>.b = 1
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">next</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">self</span>.a, <span style="color: #3a81c3; font-weight: bold;">self</span>.b = <span style="color: #3a81c3; font-weight: bold;">self</span>.b, <span style="color: #3a81c3; font-weight: bold;">self</span>.a+<span style="color: #3a81c3; font-weight: bold;">self</span>.b
	<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.a
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__iter__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">self</span>
<span style="color: #715ab1;">fibs</span> = Fibs<span style="color: #3a81c3;">()</span>
<span style="color: #3a81c3; font-weight: bold;">for</span> f <span style="color: #3a81c3; font-weight: bold;">in</span> fibs:<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">in &#20851;&#38190;&#23383;&#21518;&#38754;&#24212;&#36319;&#26377;&#21487;&#36845;&#20195;&#23545;&#35937;</span>
    <span style="color: #3a81c3; font-weight: bold;">if</span> f &gt;100:
	<span style="color: #3a81c3; font-weight: bold;">print</span> f
	<span style="color: #3a81c3; font-weight: bold;">break</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;144</span>
<span style="color: #715ab1;">it</span>=<span style="color: #3a81c3;">iter</span><span style="color: #3a81c3;">(</span>fibs<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">iter &#26041;&#27861;&#36820;&#22238;&#36845;&#20195;&#22120;</span>
it.<span style="color: #3a81c3;">next</span><span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;233</span>
fibs.<span style="color: #3a81c3;">next</span><span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;377</span>
</pre>
</div>
</div>
<div id="outline-container-orgbaa9279" class="outline-4">
<h4 id="orgbaa9279"><span class="section-number-4">7.3.1</span> 从迭代器得到序列</h4>
<div class="outline-text-4" id="text-7-3-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">TestIterator</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__init__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">self</span>.value=0
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">next</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">self</span>.value += 1
	<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.value &gt; 10: <span style="color: #3a81c3; font-weight: bold;">raise</span> <span style="color: #ba2f59; font-weight: bold;">StopIteration</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#27809;&#26377;&#36825;&#34892;&#65292;list &#20250;&#26080;&#38480;&#24490;&#29615;&#19979;&#21435;</span>
	<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">self</span>.value
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">__iter__</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">self</span>
<span style="color: #715ab1;">ti</span> = TestIterator<span style="color: #3a81c3;">()</span>
<span style="color: #3a81c3;">list</span><span style="color: #3a81c3;">(</span>ti<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; [1,2,3,4,5,6,7,8,9,10]</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org37744eb" class="outline-3">
<h3 id="org37744eb"><span class="section-number-3">7.4</span> 生成器 yield 语句</h3>
<div class="outline-text-3" id="text-7-4">
<p class="verse">
生成器为了帮助程序员写出非常优雅的代码而出现的。<br />
编写任何程序时不用生成器也是可以的。<br />
生成器是一个包含 yield 语句的函数，当函数被调用时，函数体中的代码不会被执行，<br />
而返回一个生成器(类似于有 next()方法的迭代器)。每次调用 next()请求，会执行到<br />
yield 语句并返回一个值。return 语句意味着生成器要停止执行。<br />
多用于递归。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">simpleGen</span><span style="color: #3a81c3;">()</span>:
    <span style="color: #3a81c3; font-weight: bold;">yield</span> 1
    <span style="color: #3a81c3; font-weight: bold;">yield</span> 2
    <span style="color: #3a81c3; font-weight: bold;">return</span>
    <span style="color: #3a81c3; font-weight: bold;">yield</span> 3

<span style="color: #715ab1;">myG</span>=simpleGen<span style="color: #3a81c3;">()</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">myG &#20026;&#29983;&#25104;&#22120;</span>
myG.<span style="color: #3a81c3;">next</span><span style="color: #3a81c3;">()</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">next &#35843;&#29992;&#21040; yield &#35821;&#21477;&#24471;&#21040;&#36820;&#22238;&#20540;&#65292;&#24182;&#19988;&#20013;&#27490;&#20989;&#25968;&#36816;&#34892;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;1</span>
myG.<span style="color: #3a81c3;">next</span><span style="color: #3a81c3;">()</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#32487;&#32493;&#20989;&#25968;&#36816;&#34892;&#65292;&#30693;&#36947;&#19979;&#19968;&#20010; yield &#35821;&#21477;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;2</span>
myG.<span style="color: #3a81c3;">next</span><span style="color: #3a81c3;">()</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#24050;&#26080;&#26410;&#25191;&#34892;&#30340; yield &#35821;&#21477;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;StopIteration exception</span>
</pre>
</div>
<p class="verse">
for 循环会自动调用 next()<br />
for 循环捕捉到 StopIteration 异常时停止。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">for</span> each <span style="color: #3a81c3; font-weight: bold;">in</span> simpleGen<span style="color: #3a81c3;">()</span>:
	<span style="color: #3a81c3; font-weight: bold;">print</span> each
1
2
</pre>
</div>
<ul class="org-ul">
<li>通过生成器直接生成列表</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">list</span><span style="color: #3a81c3;">(</span>simpleGen<span style="color: #6c3163;">()</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;[1,2]</span>
</pre>
</div>
<ul class="org-ul">
<li>列表推导式和生成推导式</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">g</span> = <span style="color: #3a81c3;">(</span>x*x <span style="color: #3a81c3; font-weight: bold;">for</span> x <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #6c3163;">(</span>2,5<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">g &#26159;&#19968;&#20010;&#29983;&#25104;&#22120;</span>
g.<span style="color: #3a81c3;">next</span><span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;4</span>
<span style="color: #3a81c3;">[</span>x*x <span style="color: #3a81c3; font-weight: bold;">for</span> x <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #6c3163;">(</span>2,5<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;[4,9,16]</span>
</pre>
</div>
<ul class="org-ul">
<li>list(生成器): 可以使生成器立即求值</li>
</ul>
</div>
<div id="outline-container-orgec079bb" class="outline-4">
<h4 id="orgec079bb"><span class="section-number-4">7.4.1</span> send 方法</h4>
<div class="outline-text-4" id="text-7-4-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">repeater</span><span style="color: #3a81c3;">(</span>value<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">while</span> <span style="color: #4e3163;">True</span>:
	<span style="color: #715ab1;">new</span> = <span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">yield</span> value<span style="color: #3a81c3;">)</span>
	<span style="color: #3a81c3; font-weight: bold;">if</span> new <span style="color: #3a81c3; font-weight: bold;">is</span> <span style="color: #3a81c3; font-weight: bold;">not</span> <span style="color: #4e3163;">None</span>: <span style="color: #715ab1;">value</span> = new

<span style="color: #715ab1;">r</span> = repeater<span style="color: #3a81c3;">(</span>42<span style="color: #3a81c3;">)</span>
r.<span style="color: #3a81c3;">next</span><span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;42</span>
r.send<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"hello world"</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">yield &#35821;&#21477;&#21518;&#30340;&#21464;&#37327;&#34987;&#36171;&#20540;&#20026;'hello world'</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;'hello world'</span>
r.<span style="color: #3a81c3;">next</span><span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;'hello world'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb5b74a9" class="outline-4">
<h4 id="orgb5b74a9"><span class="section-number-4">7.4.2</span> throw、close 方法</h4>
<div class="outline-text-4" id="text-7-4-2">
<p class="verse">
throw 用于在生成器内(yield)引发一个异常。<br />
close 用于关闭生成器，关闭之后执行 next 会接收到 StopIteration 异常。<br />
</p>
</div>
</div>
<div id="outline-container-org355fe97" class="outline-4">
<h4 id="org355fe97"><span class="section-number-4">7.4.3</span> 旧版的对应方法</h4>
<div class="outline-text-4" id="text-7-4-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">flatten</span><span style="color: #3a81c3;">(</span>nested<span style="color: #3a81c3;">)</span>:
    <span style="color: #715ab1;">result</span>=<span style="color: #3a81c3;">[]</span>
    <span style="color: #3a81c3; font-weight: bold;">try</span>:
	<span style="color: #3a81c3; font-weight: bold;">for</span> sublist <span style="color: #3a81c3; font-weight: bold;">in</span> nested:
	    <span style="color: #3a81c3; font-weight: bold;">for</span> element <span style="color: #3a81c3; font-weight: bold;">in</span> flatten<span style="color: #3a81c3;">(</span>sublist<span style="color: #3a81c3;">)</span>:
		result.append<span style="color: #3a81c3;">(</span>element<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#23545;&#24212; yield element</span>
    <span style="color: #3a81c3; font-weight: bold;">except</span> <span style="color: #ba2f59; font-weight: bold;">TypeError</span>:
	result.append<span style="color: #3a81c3;">(</span>nested<span style="color: #3a81c3;">)</span>
    <span style="color: #3a81c3; font-weight: bold;">return</span> result
</pre>
</div>
</div>
</div>
<div id="outline-container-org0d1a4ca" class="outline-4">
<h4 id="org0d1a4ca"><span class="section-number-4">7.4.4</span> 借助生成器解决八皇后问题</h4>
<div class="outline-text-4" id="text-7-4-4">
<p>
判断最后一行，指定列号位置放入皇后后是否与之前的皇后位产生冲突
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">state[0]=3 &#34920;&#31034;&#31532;&#19968;&#34892;&#31532;&#22235;&#21015;</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">conflict</span><span style="color: #3a81c3;">(</span>state, nextX<span style="color: #3a81c3;">)</span>:
    <span style="color: #da8b55;">'state &#26159;&#24050;&#25918;&#32622;&#22909;&#30340;&#30343;&#21518;&#30340;&#20301;&#32622;&#20449;&#24687;&#65292;nextX &#20026;&#26032;&#22686;&#30343;&#21518;&#30340;&#34892;&#20301;&#32622;(&#23545;&#20110;&#31354; state &#20063;&#33021;&#27491;&#24120;&#36816;&#20316;)'</span>
    <span style="color: #715ab1;">nextY</span> = <span style="color: #3a81c3;">len</span><span style="color: #3a81c3;">(</span>state<span style="color: #3a81c3;">)</span>
    <span style="color: #3a81c3; font-weight: bold;">for</span> i <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #3a81c3;">(</span>0, nextY<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">abs</span><span style="color: #3a81c3;">(</span>nextX-state<span style="color: #6c3163;">[</span>i<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">(</span>0, nextY-i<span style="color: #3a81c3;">)</span>:
	    <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #4e3163;">True</span>
    <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #4e3163;">False</span>
</pre>
</div>
<p>
递归从第一行开始逐行放入皇后，并判断是否与之前摆放完成的皇后们产生冲突
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">queens</span><span style="color: #3a81c3;">(</span>n, state=<span style="color: #6c3163;">()</span><span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">for</span> pos <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">range</span><span style="color: #3a81c3;">(</span>n<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3; font-weight: bold;">not</span> conflict<span style="color: #3a81c3;">(</span>state, pos<span style="color: #3a81c3;">)</span>:
	    <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">len</span><span style="color: #3a81c3;">(</span>state<span style="color: #3a81c3;">)</span> == n-1:<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#34920;&#31034;&#20165;&#26368;&#21518;&#19968;&#20010;&#20301;&#32622;&#26410;&#25918;&#32622;&#30343;&#21518;&#65292;&#36882;&#24402;&#30340;&#26368;&#32456;&#23618;</span>
		<span style="color: #3a81c3; font-weight: bold;">yield</span> <span style="color: #3a81c3;">(</span>pos,<span style="color: #3a81c3;">)</span>
	    <span style="color: #3a81c3; font-weight: bold;">else</span>:
		<span style="color: #3a81c3; font-weight: bold;">for</span> result <span style="color: #3a81c3; font-weight: bold;">in</span> queens<span style="color: #3a81c3;">(</span>n, state + <span style="color: #6c3163;">(</span>pos,<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>:<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#24403;&#26368;&#21518;&#19968;&#23618; yield &#20986;&#20869;&#23481;&#21518;&#65292;&#27492;&#22788; result &#25165;&#20250;&#26377;&#32467;&#26524;&#12290;</span>
		    <span style="color: #3a81c3; font-weight: bold;">yield</span> <span style="color: #3a81c3;">(</span>pos,<span style="color: #3a81c3;">)</span> + result

<span style="color: #3a81c3;">list</span><span style="color: #3a81c3;">(</span>queens<span style="color: #6c3163;">(</span>4, <span style="color: #2d9574;">(</span>1,<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;[(3,0,2)]</span>
<span style="color: #3a81c3;">list</span><span style="color: #3a81c3;">(</span>queens<span style="color: #6c3163;">(</span>4<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;[(1,3,0,2), (2,0,3,1)]</span>
</pre>
</div>
<p>
让输出变的漂亮一些
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">prettyprint</span><span style="color: #3a81c3;">(</span>state<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">line</span><span style="color: #3a81c3;">(</span>x, length<span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #2d9574;">'. '</span>*x + <span style="color: #2d9574;">'X '</span> + <span style="color: #2d9574;">'. '</span>*<span style="color: #3a81c3;">(</span>length-x-1<span style="color: #3a81c3;">)</span>
    <span style="color: #3a81c3; font-weight: bold;">for</span> x <span style="color: #3a81c3; font-weight: bold;">in</span> state:
	<span style="color: #3a81c3; font-weight: bold;">print</span> line<span style="color: #3a81c3;">(</span>x, <span style="color: #3a81c3;">len</span><span style="color: #6c3163;">(</span>state<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>

<span style="color: #3a81c3; font-weight: bold;">import</span> random
prettyprint<span style="color: #3a81c3;">(</span>random.choice<span style="color: #6c3163;">(</span><span style="color: #3a81c3;">list</span><span style="color: #2d9574;">(</span>queens<span style="color: #67b11d;">(</span>4<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;</span>
. X . .
. . . X
X . . .
. . X .

</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org56a3522" class="outline-2">
<h2 id="org56a3522"><span class="section-number-2">8</span> 模块</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orgf383541" class="outline-3">
<h3 id="orgf383541"><span class="section-number-3">8.1</span> 导入自定义模块</h3>
<div class="outline-text-3" id="text-8-1">
<ul class="org-ul">
<li>向 sys.path 中追加(不常用)</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> sys
sys.path.append<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'/Home/python'</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
<ul class="org-ul">
<li>或者直接将模块放置在 python 的查找目录</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">print</span><span style="color: #3a81c3;">(</span>sys.path<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21487;&#26597;&#30475;&#24403;&#21069; python &#26597;&#35810;&#30446;&#24405;</span>
pprint.pprint<span style="color: #3a81c3;">(</span>sys.path<span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">pprint &#25552;&#20379;&#26356;&#21152;&#26234;&#33021;&#30340;&#25171;&#21360;&#36755;&#20986;</span>
</pre>
</div>
<p>
推荐放置在 site-packages 目录下
</p>
<ul class="org-ul">
<li>使用系统环境变量 PYTHONPATH</li>
</ul>
<p class="verse">
Windows 用户变量中加入 PYTHONPATH 项<br />
Linux 下在.bashrc 中追加：<br />
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #3a81c3;">export</span> <span style="color: #715ab1;">PYTHONPATH</span>=$<span style="color: #715ab1;">PYTHONPATH</span>:~/Home/python
</pre>
</div>

<ul class="org-ul">
<li>模块更新后，重载，使用 reload()方法</li>
</ul>
</div>
</div>

<div id="outline-container-org4c5b1bd" class="outline-3">
<h3 id="org4c5b1bd"><span class="section-number-3">8.2</span> 仅导入定义，不运行模块内程序</h3>
<div class="outline-text-3" id="text-8-2">
<p>
可在模块可执行代码前加上判断：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">__name__</span> ==<span style="color: #2d9574;">'__main__'</span>: test<span style="color: #3a81c3;">()</span>
</pre>
</div>
<p>
导入的模块的__name__值为模块名。
</p>
<div class="org-src-container">
<pre class="src src-python">hello3.<span style="color: #3a81c3;">__name__</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;'hello3'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org66c5c9e" class="outline-3">
<h3 id="org66c5c9e"><span class="section-number-3">8.3</span> 包</h3>
<div class="outline-text-3" id="text-8-3">
<p class="verse">
包就是包含模块的文件夹，要将普通的文件夹变为 python 包，<br />
需要在文件夹下新建一个__init__.py 的文件。<br />
导入包中模块的方式如下：<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> package
<span style="color: #3a81c3; font-weight: bold;">import</span> package.module1
<span style="color: #3a81c3; font-weight: bold;">from</span> package <span style="color: #3a81c3; font-weight: bold;">import</span> module2
</pre>
</div>
</div>
</div>
<div id="outline-container-org2cccc63" class="outline-3">
<h3 id="org2cccc63"><span class="section-number-3">8.4</span> 查看模块说明</h3>
<div class="outline-text-3" id="text-8-4">
<p>
首先，需要 import 对应模块，以内建 copy 模块为例
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> copy
</pre>
</div>
</div>
<div id="outline-container-orgec1ce45" class="outline-4">
<h4 id="orgec1ce45"><span class="section-number-4">8.4.1</span> dir 查看</h4>
<div class="outline-text-4" id="text-8-4-1">
<p>
dir 列出模块中的类、函数和变量。
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">[</span>n <span style="color: #3a81c3; font-weight: bold;">for</span> n <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">dir</span><span style="color: #6c3163;">(</span>copy<span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3; font-weight: bold;">not</span> n.startswith<span style="color: #6c3163;">(</span><span style="color: #2d9574;">'_'</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">]</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#27492;&#22788;&#29992;&#21015;&#34920;&#25512;&#23548;&#24335;&#36807;&#28388;&#25481;&#20102;&#31995;&#32479;&#29992;&#30340;__&#24320;&#22836;&#30340;&#20989;&#25968;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;['Error', 'PyStringMap', 'copy', 'deepcopy', 'dispatch_table', 'error', 'name', 't', 'weakref']</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7d957dc" class="outline-4">
<h4 id="org7d957dc"><span class="section-number-4">8.4.2</span> __all__变量</h4>
<div class="outline-text-4" id="text-8-4-2">
<div class="org-src-container">
<pre class="src src-python">copy.<span style="color: #3a81c3;">__all__</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;['Error', 'copy', 'deepcopy']</span>
</pre>
</div>
<p class="verse">
__all__是在源代码 copy.py 中被设置成'Error', 'copy', 'deepcopy'<br />
__all__用来定义 public interface<br />
<br />
如果使用 from copy import *的话，只能直接使用__all__中的函数。<br />
如要使用 PyStringMap，有两种方式：<br />
1) copy.PyStringMap<br />
2) from copy import PyStringMap 之后调用 PyStringMap 即可<br />
<br />
编写自己的模块时，最好要指定__all__，如果未指定，import *会导入所有<br />
非下划线开头的特性。<br />
</p>
</div>
</div>
<div id="outline-container-org7c63ea1" class="outline-4">
<h4 id="org7c63ea1"><span class="section-number-4">8.4.3</span> help 和__doc__</h4>
<div class="outline-text-4" id="text-8-4-3">
<p>
help 更详细一些，会有函数签名。
</p>
</div>
</div>
<div id="outline-container-orgc43f2d5" class="outline-4">
<h4 id="orgc43f2d5"><span class="section-number-4">8.4.4</span> 查看源代码</h4>
<div class="outline-text-4" id="text-8-4-4">
<p class="verse">
__file__变量存放着源代码的路径<br />
一些模块没有__file__变量，可能是用 C 语言写的。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgfb79bf2" class="outline-3">
<h3 id="orgfb79bf2"><span class="section-number-3">8.5</span> 核心模块</h3>
<div class="outline-text-3" id="text-8-5">
</div>
<div id="outline-container-org95c6fdf" class="outline-4">
<h4 id="org95c6fdf"><span class="section-number-4">8.5.1</span> sys</h4>
<div class="outline-text-4" id="text-8-5-1">
<p class="verse">
sys.argv 获取执行程序所输入的参数列表<br />
sys.exit(0) 退出程序，返回程序运行正常的返回值 0<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">sys.path</td>
<td class="org-left">sys.platform</td>
<td class="org-left">sys.stdin/stdout/stderr</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orga1a5960" class="outline-4">
<h4 id="orga1a5960"><span class="section-number-4">8.5.2</span> os</h4>
<div class="outline-text-4" id="text-8-5-2">
<p class="verse">
os.path 子模块，负责当前操作系统的路径操作。常用 os.path.split、os.path.join。<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">environ</td>
<td class="org-left">返回系统环境变量字典</td>
</tr>

<tr>
<td class="org-left">system(cmd)</td>
<td class="org-left">新建一个子 shell，执行系统命令行</td>
</tr>

<tr>
<td class="org-left">sep</td>
<td class="org-left">路径中目录间分隔符</td>
</tr>

<tr>
<td class="org-left">pathsep</td>
<td class="org-left">各路径之间的分隔符</td>
</tr>

<tr>
<td class="org-left">linesep</td>
<td class="org-left">行分隔符</td>
</tr>
</tbody>
</table>
<p class="verse">
system(r'c:/"test app.exe"')需要将带空格的目录或文件名用引号包起来，系统才能正常识别<br />
解决方案 startfile(path)，例：os.startfile(r'c:/test app.exe')<br />
另外，system 函数根据操作系统不同执行方式也不同：<br />
</p>
<ul class="org-ul">
<li>windows 启动外部程序后，当前 python 程序仍会继续执行</li>
<li>linux 启动外部程序后，当前 python 程序中断，外部程序执行完后，继续执行。</li>
</ul>
</div>
</div>

<div id="outline-container-org69b28ca" class="outline-4">
<h4 id="org69b28ca"><span class="section-number-4">8.5.3</span> fileinput</h4>
<div class="outline-text-4" id="text-8-5-3">
<div class="org-src-container">
<pre class="src src-python">&#32473; py &#25991;&#20214;&#34892;&#26411;&#36861;&#21152;&#34892;&#21495;&#30340;&#20363;&#23376;&#65306;
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">numberlines.py</span>
<span style="color: #3a81c3; font-weight: bold;">import</span> fileinput
<span style="color: #3a81c3; font-weight: bold;">for</span> line <span style="color: #3a81c3; font-weight: bold;">in</span> fileinput.<span style="color: #3a81c3;">input</span><span style="color: #3a81c3;">(</span>inplace=<span style="color: #4e3163;">True</span><span style="color: #3a81c3;">)</span>:
    <span style="color: #715ab1;">line</span> = line.rstrip<span style="color: #3a81c3;">()</span>
    <span style="color: #715ab1;">num</span> = fileinput.lineno<span style="color: #3a81c3;">()</span>
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'%-50s # %2i'</span> % <span style="color: #3a81c3;">(</span>line, num<span style="color: #3a81c3;">)</span>
</pre>
</div>
<p>
对自身进行编辑：
</p>
<div class="org-src-container">
<pre class="src src-sh">python  numberlines.py numberlines.py
</pre>
</div>
<p class="verse">
fileinput.input 用于遍历多个输入流中的行，返回可迭代的对象。<br />
可以用 for 循环，迭代对列表中的每一行进行处理。<br />
</p>
<p>
常用方法列表：
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">filename</td>
<td class="org-left">返回当前文件名</td>
</tr>

<tr>
<td class="org-left">lineno</td>
<td class="org-left">累积总行数</td>
</tr>

<tr>
<td class="org-left">filelineno</td>
<td class="org-left">返回当前文件行数</td>
</tr>

<tr>
<td class="org-left">isfirstline</td>
<td class="org-left">检查是否是文件第一行</td>
</tr>

<tr>
<td class="org-left">isstdin</td>
<td class="org-left">当前文件为 sys.stdin 时返回 true</td>
</tr>

<tr>
<td class="org-left">nextfile</td>
<td class="org-left">关闭当前文件，移动到下一个文件</td>
</tr>

<tr>
<td class="org-left">close</td>
<td class="org-left">关闭序列，结束迭代</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org5ad2aed" class="outline-4">
<h4 id="org5ad2aed"><span class="section-number-4">8.5.4</span> time</h4>
<div class="outline-text-4" id="text-8-5-4">
<p class="verse">
包含 9 个整数的元组表示一个时间。<br />
(年, 月, 日, 时, 分, 秒, 周(0~6), 一年中的第几天(366), 夏令时(0,1,-1))<br />
重要的函数列表：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">asctime([tuple])</td>
<td class="org-left">将时间元组转换为字符串</td>
</tr>

<tr>
<td class="org-left">strptime(string[, format]</td>
<td class="org-left">将字符串解析成时间元组</td>
</tr>

<tr>
<td class="org-left">localtime([secs])</td>
<td class="org-left">将 1970 年起(具体与平台有关)秒数转换为日期元组</td>
</tr>

<tr>
<td class="org-left">mktime(tuple)</td>
<td class="org-left">将时间元组转换为秒数</td>
</tr>

<tr>
<td class="org-left">sleep(secs)</td>
<td class="org-left">休眠 secs 秒</td>
</tr>

<tr>
<td class="org-left">time()</td>
<td class="org-left">当前时间(1970 年起的秒数，平台相关</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org96b1a1a" class="outline-4">
<h4 id="org96b1a1a"><span class="section-number-4">8.5.5</span> random</h4>
<div class="outline-text-4" id="text-8-5-5">
<p class="verse">
random 生成的是伪随机数。要获取真正的随机性，需调用 os 模块的 urandom 函数<br />
random 模块常用函数列表：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">random()</td>
<td class="org-left">返回[0,1)之间的随机实数 n</td>
</tr>

<tr>
<td class="org-left">getrandbits(n)</td>
<td class="org-left">以长整型的方式返回一个随机二进制数(位数为 n)</td>
</tr>

<tr>
<td class="org-left">uniform(a, b)</td>
<td class="org-left">返回[a,b)之间的随机实数 n</td>
</tr>

<tr>
<td class="org-left">randrange([start,]  stop [,step] )</td>
<td class="org-left">返回 range[start, stop)中的随机整数，step 必须为整数</td>
</tr>

<tr>
<td class="org-left">choice(seq)</td>
<td class="org-left">随机返回序列中的一个元素</td>
</tr>

<tr>
<td class="org-left">shuffle(seq[, random])</td>
<td class="org-left">将序列进行随机排列</td>
</tr>

<tr>
<td class="org-left">sample(seq, n)</td>
<td class="org-left">从序列中选出 n 个随机元素，同时保证不会选出同一个元素</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org32a6bc7" class="outline-4">
<h4 id="org32a6bc7"><span class="section-number-4">8.5.6</span> shelve</h4>
<div class="outline-text-4" id="text-8-5-6">
<p>
简单的文件数据库方案。
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> shelve
<span style="color: #715ab1;">s</span> = shelve.<span style="color: #3a81c3;">open</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'D:\\test.dat'</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21019;&#24314;&#31616;&#21333; DB &#25991;&#20214;</span>
<span style="color: #715ab1;">s</span><span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'x'</span><span style="color: #3a81c3;">]</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'a'</span>, <span style="color: #2d9574;">'b'</span>, <span style="color: #2d9574;">'c'</span><span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">s['x'].append('d')&#26080;&#25928;</span>

<span style="color: #715ab1;">temp</span> = s<span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'x'</span><span style="color: #3a81c3;">]</span>
temp.append<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'d'</span><span style="color: #3a81c3;">)</span>
<span style="color: #715ab1;">s</span><span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'x'</span><span style="color: #3a81c3;">]</span> = temp<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#24517;&#39035;&#32473; s['x']&#29305;&#24615;&#37325;&#26032;&#36171;&#20540;&#20462;&#25913;&#25165;&#33021;&#20889;&#20837; DB &#25991;&#20214;</span>
s.close<span style="color: #3a81c3;">()</span>

<span style="color: #715ab1;">s</span> = shelve.<span style="color: #3a81c3;">open</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'D:\\test.dat'</span><span style="color: #3a81c3;">)</span>
s
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;{'x' : ['a', 'b', 'c', 'd']}</span>
</pre>
</div>
<p>
pickle 模块与 shelve 密切相关(自动序列化相关)。
</p>
</div>
</div>
<div id="outline-container-org98ad69c" class="outline-4">
<h4 id="org98ad69c"><span class="section-number-4">8.5.7</span> re(regular expression)</h4>
<div class="outline-text-4" id="text-8-5-7">
<p>
重要函数列表：
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">compile(pattern[, flags])</td>
<td class="org-left">根据正则表达式字符串创建模式对象</td>
</tr>

<tr>
<td class="org-left">search(pattern, string[, flags])</td>
<td class="org-left">在字符串中寻找与模式匹配的第一个子字符串</td>
</tr>

<tr>
<td class="org-left">findall(pattern, string</td>
<td class="org-left">列出匹配的所有子字符串</td>
</tr>

<tr>
<td class="org-left">match(pattern, string[, flags])</td>
<td class="org-left">从给定字符串的开头开始匹配正则表达式</td>
</tr>

<tr>
<td class="org-left">split(pattern, string[, maxsplits=0]</td>
<td class="org-left">根据模式的匹配项分割字符串</td>
</tr>

<tr>
<td class="org-left">sub(pat, repl, string[, count=0])</td>
<td class="org-left">将所有 pat 模式匹配的项用 repl 替换</td>
</tr>

<tr>
<td class="org-left">escape(string)</td>
<td class="org-left">将正则表达式特殊字符转义</td>
</tr>
</tbody>
</table>
<p class="verse">
complie 可以实现一次性创建模式对象，其余方法不必在单独创建模式对象<br />
如 pat.search(string)、pat.match(string)<br />
</p>
</div>
<ul class="org-ul">
<li><a id="org51c9e15"></a>组的运用<br />
<div class="outline-text-5" id="text-org51c9e15">
<p class="verse">
r'www\.(.+)\.com$'<br />
组 0 表示整个字符串，组 1 表示(.+)的部分。<br />
关于组的重要函数：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">group([group1, &#x2026;])</td>
<td class="org-left">获取给定子模式的匹配项</td>
</tr>

<tr>
<td class="org-left">start([group])</td>
<td class="org-left">返回给定组的匹配项的开始位置</td>
</tr>

<tr>
<td class="org-left">end([group])</td>
<td class="org-left">返回结束位置</td>
</tr>

<tr>
<td class="org-left">span([group])</td>
<td class="org-left">返回给定组的开始和结束位置</td>
</tr>
</tbody>
</table>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">m</span> = match<span style="color: #3a81c3;">(</span>r<span style="color: #2d9574;">'www\.(.*)\..{3}'</span>, <span style="color: #2d9574;">'www.python.org'</span><span style="color: #3a81c3;">)</span>
m.group<span style="color: #3a81c3;">(</span>1<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;'python'</span>
m.start<span style="color: #3a81c3;">(</span>1<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;4</span>
m.end<span style="color: #3a81c3;">(</span>1<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;10</span>
m.span<span style="color: #3a81c3;">(</span>1<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;(4, 10)</span>
</pre>
</div>
<ul class="org-ul">
<li>运用组进行字符串替换(有用)</li>
</ul>
<pre class="example">
考虑将'*something*'替换成'&lt;em&gt;something&lt;/em&gt;'
</pre>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">emphasis_pattern</span> = r<span style="color: #2d9574;">'\*([^\*]+)\*'</span>
re.sub<span style="color: #3a81c3;">(</span>emphasis_pattern, r<span style="color: #2d9574;">'&lt;em&gt;\1&lt;/em&gt;'</span>, <span style="color: #2d9574;">'Hello, *world*!'</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">\1 &#20195;&#34920;&#32452; 1</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;'Hello, &lt;em&gt;world&lt;/em&gt;!'</span>
</pre>
</div>
<ul class="org-ul">
<li>陷阱</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">emphasis_pattern</span> = r<span style="color: #2d9574;">'\*([.+])\*'</span>
re.sub<span style="color: #3a81c3;">(</span>emphasis_pattern, r<span style="color: #2d9574;">'&lt;em&gt;\1&lt;/em&gt;'</span>, <span style="color: #2d9574;">'*This* is a *test*'</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;'&lt;em&gt;This* is a *test&lt;/em&gt;'</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#20462;&#25913;&#29256;&#27491;&#21017;&#34920;&#36798;&#24335;&#22914;&#19979;&#65306;</span>
<span style="color: #715ab1;">emphasis_pattern</span> = r<span style="color: #2d9574;">'\*([.+?])\*'</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#32452;&#20013;&#21152;&#19978;&#19968;&#20010;? &#34920;&#31034;&#23613;&#21487;&#33021;&#23569;&#30340;&#21305;&#37197;</span>
</pre>
</div>
</div>
</li>
<li><a id="org93ffc76"></a>Amazing Template System<br />
<div class="outline-text-5" id="text-org93ffc76">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">template.py</span>
<span style="color: #3a81c3; font-weight: bold;">import</span> fileinput, re
<span style="color: #715ab1;">field_pat</span> = re.<span style="color: #3a81c3;">compile</span><span style="color: #3a81c3;">(</span>r<span style="color: #2d9574;">'\[(.+?)\]'</span><span style="color: #3a81c3;">)</span>
<span style="color: #715ab1;">scope</span> = <span style="color: #3a81c3;">{}</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">replacement</span><span style="color: #3a81c3;">(</span>match<span style="color: #3a81c3;">)</span>:
    <span style="color: #715ab1;">code</span>=match.group<span style="color: #3a81c3;">(</span>1<span style="color: #3a81c3;">)</span>
    <span style="color: #3a81c3; font-weight: bold;">try</span>:
	<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3;">str</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3;">eval</span><span style="color: #6c3163;">(</span>code, scope<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
    <span style="color: #3a81c3; font-weight: bold;">except</span> <span style="color: #ba2f59; font-weight: bold;">SyntaxError</span>:
	<span style="color: #3a81c3; font-weight: bold;">exec</span> code <span style="color: #3a81c3; font-weight: bold;">in</span> scope
	<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #2d9574;">''</span>

<span style="color: #715ab1;">lines</span> = <span style="color: #3a81c3;">[]</span>
<span style="color: #3a81c3; font-weight: bold;">for</span> line <span style="color: #3a81c3; font-weight: bold;">in</span> fileinput.<span style="color: #3a81c3;">input</span><span style="color: #3a81c3;">()</span>:
    lines.append<span style="color: #3a81c3;">(</span>line<span style="color: #3a81c3;">)</span>
<span style="color: #715ab1;">text</span> = <span style="color: #2d9574;">' '</span>.join<span style="color: #3a81c3;">(</span>lines<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">print</span> field_pat.sub<span style="color: #3a81c3;">(</span>replacement, text<span style="color: #3a81c3;">)</span>
</pre>
</div>
<pre class="example">
#test.txt
[x=2]
[y=3]
The sum of [x] and [y] is [x+y].
</pre>
<div class="org-src-container">
<pre class="src src-python">python template.py test.txt
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;The sum of 2 and 3 is 5</span>
</pre>
</div>
<ul class="org-ul">
<li>execfile()可直接执行含 python 语法定义的文本文件</li>
<li>string 模块中的 Template 类提供了非常完美的模板系统</li>
</ul>
</div>
</li>
<li><a id="orgccce888"></a>一些提示<br />
<div class="outline-text-5" id="text-orgccce888">
<ul class="org-ul">
<li>pattern 选项(规定出现次数)</li>
</ul>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">(pattern)?</td>
<td class="org-left">pattern 为可选项</td>
</tr>

<tr>
<td class="org-left">(pattern)*</td>
<td class="org-left">允许重复 0 次或者多次</td>
</tr>

<tr>
<td class="org-left">(pattern)+</td>
<td class="org-left">允许重复 1 次或者多次</td>
</tr>

<tr>
<td class="org-left">(pattern){m,n}</td>
<td class="org-left">允许重复 m~n 次</td>
</tr>
</tbody>
</table>
<ul class="org-ul">
<li>字符串开头和结尾</li>
</ul>
<p class="verse">
^和$分别表示匹配开头和结尾。<br />
'^http'只匹配 http 开头的字符串<br />
</p>
<ul class="org-ul">
<li>关于正则表达式的可读性(VERBOSE flag)</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">emphasis_pattern</span> = re.<span style="color: #3a81c3;">compile</span><span style="color: #3a81c3;">(</span>r<span style="color: #2d9574;">'''</span>
<span style="color: #2d9574;">    \*    #Beginning emphasis tag -- an asterisk</span>
<span style="color: #2d9574;">    (      #Begin group for capturing phrase</span>
<span style="color: #2d9574;">    [^\*]+    #Capture anything except asterisks</span>
<span style="color: #2d9574;">    )      #End group</span>
<span style="color: #2d9574;">    \*    #Ending emphasis tag</span>
<span style="color: #2d9574;">    '''</span>, re.VERBOSE<span style="color: #3a81c3;">)</span>
</pre>
</div>
<p>
VERBOSE 标记会忽略空白字符、tab、注释等等
</p>
</div>
</li>
</ul>
</div>
<div id="outline-container-org3002368" class="outline-4">
<h4 id="org3002368"><span class="section-number-4">8.5.8</span> ConfigParser</h4>
<div class="outline-text-4" id="text-8-5-8">
<p>
配置文件：
</p>
<pre class="example">
[numbers]
pi: 3.1415926535897931
[messages]
greeting: Welcome
</pre>
<p>
读取配置文件：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">from</span> ConfigParser <span style="color: #3a81c3; font-weight: bold;">import</span> ConfigParser
<span style="color: #715ab1;">CONFIGFILE</span> = <span style="color: #2d9574;">"testconfig.txt"</span>
<span style="color: #715ab1;">config</span> = ConfigParser<span style="color: #3a81c3;">()</span>
config.read<span style="color: #3a81c3;">(</span>CONFIGFILE<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">print</span> config.get<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'messages'</span>, <span style="color: #2d9574;">'greeting'</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">print</span> config.getfloat<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'numbers'</span>, <span style="color: #2d9574;">'pi'</span><span style="color: #3a81c3;">)</span> * <span style="color: #3a81c3;">(</span>4**2<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga6fe3a0" class="outline-4">
<h4 id="orga6fe3a0"><span class="section-number-4">8.5.9</span> Logging</h4>
<div class="outline-text-4" id="text-8-5-9">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> logging
logging.basicConfig<span style="color: #3a81c3;">(</span>level=logging.INFO, filename=<span style="color: #2d9574;">'Mylog.log'</span><span style="color: #3a81c3;">)</span>
logging.info<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'Starting program'</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org6264dd0" class="outline-3">
<h3 id="org6264dd0"><span class="section-number-3">8.6</span> 其他常用模块</h3>
<div class="outline-text-3" id="text-8-6">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">模块名</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">cmath</td>
<td class="org-left">复数运算</td>
</tr>

<tr>
<td class="org-left">webbrowser</td>
<td class="org-left">可指定 URL 打开网页浏览器</td>
</tr>

<tr>
<td class="org-left">logging</td>
<td class="org-left">记录日志用</td>
</tr>

<tr>
<td class="org-left">itertools</td>
<td class="org-left">迭代工具</td>
</tr>

<tr>
<td class="org-left">bisect</td>
<td class="org-left">实现了二元查找</td>
</tr>

<tr>
<td class="org-left">functools</td>
<td class="org-left">包含 map, filter, reduce</td>
</tr>

<tr>
<td class="org-left">operator</td>
<td class="org-left">内建的基本运算方法都在此模块</td>
</tr>

<tr>
<td class="org-left">inspect</td>
<td class="org-left">对象查看器</td>
</tr>

<tr>
<td class="org-left">exceptions</td>
<td class="org-left">异常处理</td>
</tr>

<tr>
<td class="org-left">webbrowser</td>
<td class="org-left">网络浏览器相关</td>
</tr>

<tr>
<td class="org-left">difflib</td>
<td class="org-left">序列间的比较</td>
</tr>

<tr>
<td class="org-left">hashlib</td>
<td class="org-left">根据字符串计算'签名'，多用在加密和安全性</td>
</tr>

<tr>
<td class="org-left">csv</td>
<td class="org-left">处理 csv 文件</td>
</tr>

<tr>
<td class="org-left">datetime</td>
<td class="org-left">time 不能满足要求时使用，接口更直观</td>
</tr>

<tr>
<td class="org-left">cmd</td>
<td class="org-left">用它编写命令行解释器，可以自定义命令</td>
</tr>
</tbody>
</table>
<p>
测试分析模块
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">timeit</td>
<td class="org-left">衡量代码片段运行时间的工具，用于性能测试</td>
</tr>

<tr>
<td class="org-left">profile</td>
<td class="org-left">用于代码片段效率的全面分析</td>
</tr>

<tr>
<td class="org-left">trace</td>
<td class="org-left">判断哪些代码执行了，哪些未执行</td>
</tr>

<tr>
<td class="org-left">dis</td>
<td class="org-left">反汇编模块，查看对应的汇编代码</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org3f9f300" class="outline-3">
<h3 id="org3f9f300"><span class="section-number-3">8.7</span> 集成其他语言模块</h3>
<div class="outline-text-3" id="text-8-7">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">语言</th>
<th scope="col" class="org-left">解决方案</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">C/C++</td>
<td class="org-left">SWIG</td>
</tr>

<tr>
<td class="org-left">.Net</td>
<td class="org-left">IronPython</td>
</tr>

<tr>
<td class="org-left">Java</td>
<td class="org-left">JPython</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org0ee8ceb" class="outline-3">
<h3 id="org0ee8ceb"><span class="section-number-3">8.8</span> 可在 PyPI 上寻找 python 的最新的拓展包</h3>
</div>
</div>
<div id="outline-container-org5560b5e" class="outline-2">
<h2 id="org5560b5e"><span class="section-number-2">9</span> 文件</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-orgc948632" class="outline-3">
<h3 id="orgc948632"><span class="section-number-3">9.1</span> Open</h3>
<div class="outline-text-3" id="text-9-1">
<p>
open(name[, module[, buffering]]) 返回一个文件对象
</p>
<ul class="org-ul">
<li>name 文件名</li>
<li>module 文件模式(可选)</li>
</ul>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">'r'</td>
<td class="org-left">读模式</td>
</tr>

<tr>
<td class="org-left">'w'</td>
<td class="org-left">写模式</td>
</tr>

<tr>
<td class="org-left">'a'</td>
<td class="org-left">追加模式</td>
</tr>

<tr>
<td class="org-left">'b'</td>
<td class="org-left">二进制模式(可添加到其他模式中使用)</td>
</tr>

<tr>
<td class="org-left">'+'</td>
<td class="org-left">读写模式(可添加到其他模式中使用)</td>
</tr>
</tbody>
</table>
<p>
默认为读模式
</p>
<ul class="org-ul">
<li>buffering 缓冲(可选)</li>
</ul>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">0</td>
<td class="org-left">不使用内存缓冲，直接读写硬盘</td>
</tr>

<tr>
<td class="org-left">1 或者任何负数</td>
<td class="org-left">使用内存缓冲，并且使用默认缓冲区大小</td>
</tr>

<tr>
<td class="org-left">大于 1 的数</td>
<td class="org-left">缓冲区大小(单位：字节)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgf659e73" class="outline-3">
<h3 id="orgf659e73"><span class="section-number-3">9.2</span> 文件对象的基本方法</h3>
<div class="outline-text-3" id="text-9-2">
</div>
<div id="outline-container-org149c43c" class="outline-4">
<h4 id="org149c43c"><span class="section-number-4">9.2.1</span> 读和写</h4>
<div class="outline-text-4" id="text-9-2-1">
<p>
在一次 open-close 的区块内，使用 Write 会重写文件内容。
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">f</span> = <span style="color: #3a81c3;">open</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'test.txt'</span>, <span style="color: #2d9574;">'w'</span><span style="color: #3a81c3;">)</span>
f.write<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'Append text.'</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#37325;&#20889;&#25991;&#20214;&#20869;&#23481;</span>
f.write<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'Append text2.'</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#36861;&#21152;&#20869;&#23481;</span>
f.close
</pre>
</div>
<p class="verse">
读取操作 read，不带参数时读取全文，带数字参数时，<br />
读取指定的字符数，并且记录当前位置，下次调用 read 时，<br />
从该位置继续读取。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">f</span> = <span style="color: #3a81c3;">open</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'test.txt'</span>, <span style="color: #2d9574;">'r'</span><span style="color: #3a81c3;">)</span><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">r &#20063;&#21487;&#19981;&#21152;&#65292;&#40664;&#35748;&#26159;&#35835;&#21462;&#27169;&#24335;&#25171;&#24320;</span>
f.read<span style="color: #3a81c3;">(</span>4<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;'Appe'</span>
f.read<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;'nd text.'</span>
f.close<span style="color: #3a81c3;">()</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge35343f" class="outline-4">
<h4 id="orge35343f"><span class="section-number-4">9.2.2</span> Pipe</h4>
<div class="outline-text-4" id="text-9-2-2">
<p>
管道符号的意义：将前一个命令的 stdout 作为下一个命令的 stdin 执行
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;"># </span><span style="color: #2aa1ae; background-color: #ecf3ec;">somescript.py</span>
<span style="color: #3a81c3; font-weight: bold;">import</span> sys
<span style="color: #715ab1;">text</span> = sys.stdin.read<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">words</span> = text.split<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">wordcount</span> = <span style="color: #3a81c3;">len</span><span style="color: #3a81c3;">(</span>words<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'Wordcount:'</span>, wordcount
</pre>
</div>
<pre class="example">
# somefile.txt
abc def
ghi
</pre>
<div class="org-src-container">
<pre class="src src-sh">cat somefile.txt | python somescript.py
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;Wordcount:3</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaeeeb7d" class="outline-4">
<h4 id="orgaeeeb7d"><span class="section-number-4">9.2.3</span> 随机访问(seek 和 tell)</h4>
<div class="outline-text-4" id="text-9-2-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">seek(offset[, whenrc])</td>
<td class="org-left">当前位置移动到 offset 处, whenrc:默认 0 从文件开头计算偏移，1 从前次的位置，2 从文件结尾</td>
</tr>

<tr>
<td class="org-left">tell()</td>
<td class="org-left">返回当前文件的位置(返回值类型：长整型)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgee7c86a" class="outline-4">
<h4 id="orgee7c86a"><span class="section-number-4">9.2.4</span> 按行读写</h4>
<div class="outline-text-4" id="text-9-2-4">
<ul class="org-ul">
<li>file.readline() 从当前位置开始直到一个换行符出现(换行符也会被读取)</li>
</ul>
<p class="verse">
可选非负整数作为参数，指定可以读取的最大字符数。<br />
readlines 返回包含所有行的列表<br />
</p>
<ul class="org-ul">
<li>file.writelines() 参数可以是字符串序列或者 None。没有 writeline 方法， 因为可以使用 write。</li>
</ul>
</div>
</div>
<div id="outline-container-org9738697" class="outline-4">
<h4 id="org9738697"><span class="section-number-4">9.2.5</span> 总是关闭文件</h4>
<div class="outline-text-4" id="text-9-2-5">
<ul class="org-ul">
<li>可在 finally 关闭文件</li>
<li>Python 2.5 中引入的 with 语句</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">with</span> <span style="color: #3a81c3;">open</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"somefile.txt"</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">as</span> somefile:
    do_something<span style="color: #3a81c3;">(</span>somefile<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">with &#35821;&#21477;&#22359;&#32467;&#26463;&#26102;&#65292;&#20851;&#38381; somefile&#65292;&#31561;&#21516;&#20110; finally &#25928;&#26524;</span>
</pre>
</div>
<p>
事实上，支持__enter__和__exit__方法的对象，都能使用 with 语句。
</p>
</div>
</div>
</div>
<div id="outline-container-org82d305d" class="outline-3">
<h3 id="org82d305d"><span class="section-number-3">9.3</span> 迭代处理读取内容</h3>
<div class="outline-text-3" id="text-9-3">
<p>
先定义一个处理字符串的方法，后面都会用到：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">process</span><span style="color: #3a81c3;">(</span>string<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'Processing: '</span>, string
</pre>
</div>
</div>
<div id="outline-container-orgf6b3e3c" class="outline-4">
<h4 id="orgf6b3e3c"><span class="section-number-4">9.3.1</span> while 循环处理每个字符</h4>
<div class="outline-text-4" id="text-9-3-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">f</span> = <span style="color: #3a81c3;">open</span><span style="color: #3a81c3;">(</span>filename<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">while</span> <span style="color: #4e3163;">True</span>:
    <span style="color: #715ab1;">char</span> = f.read<span style="color: #3a81c3;">(</span>1<span style="color: #3a81c3;">)</span>
    <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3; font-weight: bold;">not</span> char: <span style="color: #3a81c3; font-weight: bold;">break</span>
    process<span style="color: #3a81c3;">(</span>char<span style="color: #3a81c3;">)</span>
f.close<span style="color: #3a81c3;">()</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdb98f8d" class="outline-4">
<h4 id="orgdb98f8d"><span class="section-number-4">9.3.2</span> while 循环处理每一行</h4>
<div class="outline-text-4" id="text-9-3-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">f</span> = <span style="color: #3a81c3;">open</span><span style="color: #3a81c3;">(</span>filename<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">while</span> <span style="color: #4e3163;">True</span>:
    <span style="color: #715ab1;">line</span> = f.readline<span style="color: #3a81c3;">()</span>
    <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3; font-weight: bold;">not</span> line: <span style="color: #3a81c3; font-weight: bold;">break</span>
    process<span style="color: #3a81c3;">(</span>line<span style="color: #3a81c3;">)</span>
f.close<span style="color: #3a81c3;">()</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcc335eb" class="outline-4">
<h4 id="orgcc335eb"><span class="section-number-4">9.3.3</span> 一次性读取所有内容</h4>
<div class="outline-text-4" id="text-9-3-3">
<p>
文件不大时使用，非常方便。
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">f</span> = <span style="color: #3a81c3;">open</span><span style="color: #3a81c3;">(</span>filename<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">for</span> char <span style="color: #3a81c3; font-weight: bold;">in</span> f.read<span style="color: #3a81c3;">()</span>:
    process<span style="color: #3a81c3;">(</span>char<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">or</span>
<span style="color: #3a81c3; font-weight: bold;">for</span> line <span style="color: #3a81c3; font-weight: bold;">in</span> f.readlines<span style="color: #3a81c3;">()</span>:
    process<span style="color: #3a81c3;">(</span>line<span style="color: #3a81c3;">)</span>
f.close
</pre>
</div>
</div>
</div>
<div id="outline-container-org48f4716" class="outline-4">
<h4 id="org48f4716"><span class="section-number-4">9.3.4</span> fileinput</h4>
<div class="outline-text-4" id="text-9-3-4">
<p>
fileinput 是既方便又没有一次性读取的内存占用问题的解决方案。
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> fileinput
<span style="color: #3a81c3; font-weight: bold;">for</span> line <span style="color: #3a81c3; font-weight: bold;">in</span> fileinput.<span style="color: #3a81c3;">input</span><span style="color: #3a81c3;">(</span>filename<span style="color: #3a81c3;">)</span>:
    process<span style="color: #3a81c3;">(</span>line<span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org364bde3" class="outline-4">
<h4 id="org364bde3"><span class="section-number-4">9.3.5</span> 2.2 版起可迭代的文件对象</h4>
<div class="outline-text-4" id="text-9-3-5">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">f</span> = <span style="color: #3a81c3;">open</span><span style="color: #3a81c3;">(</span>filename<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">for</span> line <span style="color: #3a81c3; font-weight: bold;">in</span> f:
    process<span style="color: #3a81c3;">(</span>line<span style="color: #3a81c3;">)</span>
f.close
</pre>
</div>
<p>
可以更懒，只要 open 文件是只读模式， <b>关闭文件不是必须的！</b>
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">for</span> line <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">open</span><span style="color: #3a81c3;">(</span>filename<span style="color: #3a81c3;">)</span>:
    process<span style="color: #3a81c3;">(</span>line<span style="color: #3a81c3;">)</span>
</pre>
</div>
<p>
关闭文件交给 python 去完成了。
</p>
<ul class="org-ul">
<li>stdin 也是可迭代的类文件对象</li>
<li>list(open(filename)与 readlines 达到的效果一样</li>
<li>firstline, secondline = open(filename) 直接解包放入变量中</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-org24dd384" class="outline-2">
<h2 id="org24dd384"><span class="section-number-2">10</span> 网络</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-orga005000" class="outline-3">
<h3 id="orga005000"><span class="section-number-3">10.1</span> socket</h3>
<div class="outline-text-3" id="text-10-1">
</div>
<div id="outline-container-org0601645" class="outline-4">
<h4 id="org0601645"><span class="section-number-4">10.1.1</span> 构造</h4>
<div class="outline-text-4" id="text-10-1-1">
<p>
socket 对象可选参数列表：
</p>
<ol class="org-ol">
<li>地址族 默认 socket.AF_INET</li>
<li>流  默认 socket.SOCK_STREAM(基于 TCP) 或者 数据报 socket.SOCK_DGRAM(基于 UDP)</li>
<li>使用的协议 默认 0</li>
</ol>
</div>
</div>
<div id="outline-container-org012458f" class="outline-4">
<h4 id="org012458f"><span class="section-number-4">10.1.2</span> Server</h4>
<div class="outline-text-4" id="text-10-1-2">
<ul class="org-ul">
<li>bind 绑定地址，参数为(host, port)元组</li>
<li>listen 只有一个参数，指定允许排队等待的连接数目</li>
<li>accept</li>
</ul>
<p class="verse">
该方法会阻塞直到有客户端连接，而后返回一个(client, address)的元组。<br />
当前 accept 处理完之后，会调用另一个 accept()，即队列方式。<br />
注意：使用这种方式称为同步网络编程。<br />
</p>
</div>
</div>
<div id="outline-container-org0154444" class="outline-4">
<h4 id="org0154444"><span class="section-number-4">10.1.3</span> send, recv</h4>
<div class="outline-text-4" id="text-10-1-3">
<ul class="org-ul">
<li>send 参数传入字符串</li>
<li>recv 参数传入接收数据的最大字符数，1024 是个较好的选择。</li>
</ul>
</div>
</div>
<div id="outline-container-orga2887ed" class="outline-4">
<h4 id="orga2887ed"><span class="section-number-4">10.1.4</span> 简单示例</h4>
<div class="outline-text-4" id="text-10-1-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">socket server test</span>
<span style="color: #3a81c3; font-weight: bold;">import</span> socket
<span style="color: #715ab1;">s</span> = socket.socket<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">host</span> = socket.gethostname<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">port</span> =1234

s.bind<span style="color: #3a81c3;">(</span><span style="color: #6c3163;">(</span>host, port<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
s.listen<span style="color: #3a81c3;">(</span>5<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">while</span> <span style="color: #4e3163;">True</span>:
    <span style="color: #715ab1;">c</span>, <span style="color: #715ab1;">addr</span> = s.accept<span style="color: #3a81c3;">()</span>
    <span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'Got connection from'</span>, addr
    c.send<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'Thank you for connectin'</span><span style="color: #3a81c3;">)</span>
    c.close<span style="color: #3a81c3;">()</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">socket client test</span>
<span style="color: #3a81c3; font-weight: bold;">import</span> socket
<span style="color: #715ab1;">s</span> = socket.socket<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">host</span> = socket.gethostname<span style="color: #3a81c3;">()</span>
<span style="color: #715ab1;">port</span> = 1234

s.connect<span style="color: #3a81c3;">(</span><span style="color: #6c3163;">(</span>host, port<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3; font-weight: bold;">print</span> s.recv<span style="color: #3a81c3;">(</span>1024<span style="color: #3a81c3;">)</span>
s.close<span style="color: #3a81c3;">()</span>
</pre>
</div>
<p>
命令行调用结果：
</p>
<ul class="org-ul">
<li><p>
Server 端
</p>

<div class="figure">
<p><img src="../resources/python/SocketServerResult.png" alt="SocketServerResult.png" />
</p>
</div></li>
<li><p>
Client 端：
</p>

<div class="figure">
<p><img src="../resources/python/SocketClientResult.png" alt="SocketClientResult.png" />
</p>
</div></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org70b6407" class="outline-3">
<h3 id="org70b6407"><span class="section-number-3">10.2</span> urllib, urllib2</h3>
<div class="outline-text-3" id="text-10-2">
<p class="verse">
这两个模块几乎可以把任何 URL 所指向的东西用做程序的输入。<br />
urllib2 更好一些，需要使用 http 验证、cookie 或者要为自己的协议<br />
写扩展程序时，使用 urllib2。<br />
</p>
<ul class="org-ul">
<li>urllib.urlopen(url) 返回一个类文件对象</li>
<li>urllib.urlretrieve(url, filename) 将 url 获取的内容保存成本地文件</li>
</ul>
<p class="verse">
注意：filename 默认 None，不指定的话，文件会临时存放在某位置，<br />
用 open 函数可以打开它。清理临时文件，调用 urlcleanup 函数。<br />
</p>
<p>
urllib 的其他一些功能：
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">quote(string[, safe])</td>
<td class="org-left">负责转移成 url 字符串</td>
</tr>

<tr>
<td class="org-left">quote_plus(string[, safe])</td>
<td class="org-left">在 quote 的基础上，将空格转为'+'</td>
</tr>

<tr>
<td class="org-left">unquote(string)</td>
<td class="org-left">与 quote 相反</td>
</tr>

<tr>
<td class="org-left">unquote_plus(string)</td>
<td class="org-left">与 quote_plus 相反</td>
</tr>

<tr>
<td class="org-left">urlencode(query[, doseq]</td>
<td class="org-left">把映射或者包含两个元素的元组的序列转换成 URL 格式字符串</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org1ef02aa" class="outline-3">
<h3 id="org1ef02aa"><span class="section-number-3">10.3</span> webservice</h3>
</div>
<div id="outline-container-org2cb1237" class="outline-3">
<h3 id="org2cb1237"><span class="section-number-3">10.4</span> 其他网络模块</h3>
<div class="outline-text-3" id="text-10-4">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">asyncore</td>
<td class="org-left">异步 socket 处理程序</td>
</tr>

<tr>
<td class="org-left">asynchat</td>
<td class="org-left">asynchat 的加强版</td>
</tr>

<tr>
<td class="org-left">cgi</td>
<td class="org-left">基本的 CGI 支持</td>
</tr>

<tr>
<td class="org-left">Cookie</td>
<td class="org-left">Cookie 对象操作，主要用于服务器</td>
</tr>

<tr>
<td class="org-left">cookielib</td>
<td class="org-left">客户端 cookie 支持</td>
</tr>

<tr>
<td class="org-left">email</td>
<td class="org-left">E-mail 消息支持</td>
</tr>

<tr>
<td class="org-left">ftplib</td>
<td class="org-left">FTP 客户端模块</td>
</tr>

<tr>
<td class="org-left">httplib</td>
<td class="org-left">HTTP 客户端模块</td>
</tr>

<tr>
<td class="org-left">imaplib</td>
<td class="org-left">IMAP4 客户端模块</td>
</tr>

<tr>
<td class="org-left">mailbox</td>
<td class="org-left">读取几种邮箱的格式</td>
</tr>

<tr>
<td class="org-left">nntplib</td>
<td class="org-left">NNTP 客户端模块</td>
</tr>

<tr>
<td class="org-left">poplib</td>
<td class="org-left">POP 客户端模块</td>
</tr>

<tr>
<td class="org-left">robotparser</td>
<td class="org-left">支持解析 Web 服务器的 robot 文件</td>
</tr>

<tr>
<td class="org-left">SimpleXMLRPCServer</td>
<td class="org-left">简单的 XML-RPC 服务器</td>
</tr>

<tr>
<td class="org-left">smtpd</td>
<td class="org-left">SMTP 服务器模块</td>
</tr>

<tr>
<td class="org-left">smtplib</td>
<td class="org-left">SMTP 客户端模块</td>
</tr>

<tr>
<td class="org-left">telnetlib</td>
<td class="org-left">Telnet 客户端模块</td>
</tr>

<tr>
<td class="org-left">urlparse</td>
<td class="org-left">支持解析 URL</td>
</tr>

<tr>
<td class="org-left">xmlrpclib</td>
<td class="org-left">XML-RPC 的客户端支持</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org09fbdde" class="outline-2">
<h2 id="org09fbdde"><span class="section-number-2">11</span> 测试</h2>
<div class="outline-text-2" id="text-11">
</div>
<div id="outline-container-orgcef2b1c" class="outline-3">
<h3 id="orgcef2b1c"><span class="section-number-3">11.1</span> 调试</h3>
<div class="outline-text-3" id="text-11-1">
</div>
<div id="outline-container-org87a71e8" class="outline-4">
<h4 id="org87a71e8"><span class="section-number-4">11.1.1</span> 命令行方式</h4>
<div class="outline-text-4" id="text-11-1-1">
<p>
启动调试器 python -m pdb test.py
</p>
</div>
</div>
<div id="outline-container-org5c70108" class="outline-4">
<h4 id="org5c70108"><span class="section-number-4">11.1.2</span> IDLE 方式</h4>
<div class="outline-text-4" id="text-11-1-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">__DEBUG</span> = <span style="color: #4e3163;">True</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">test</span><span style="color: #3a81c3;">()</span>:
    <span style="color: #715ab1;">a</span> = 5
    <span style="color: #3a81c3; font-weight: bold;">if</span> __DEBUG:
	<span style="color: #3a81c3; font-weight: bold;">import</span> pdb
	pdb.set_trace<span style="color: #3a81c3;">()</span>
    <span style="color: #715ab1;">b</span> = 4
    <span style="color: #3a81c3; font-weight: bold;">print</span> a + b
</pre>
</div>
<pre class="example">
pdb.run('mymodule.test()')
&gt; &lt;string&gt;(1)&lt;module&gt;()
(Pdb) c
&gt; d:\home\temp\mymodule.py(7)test()
-&gt; b = 4
(Pdb) l
  2     def test():
  3         a = 5
  4         if __DEBUG:
  5             import pdb
  6             pdb.set_trace()
  7  -&gt;     b = 4
  8         print a + b
  9
[EOF]
</pre>
</div>
</div>
<div id="outline-container-org5b09b04" class="outline-4">
<h4 id="org5b09b04"><span class="section-number-4">11.1.3</span> 常用指令</h4>
<div class="outline-text-4" id="text-11-1-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">命令</td>
<td class="org-left">用途</td>
</tr>

<tr>
<td class="org-left">break 或 b</td>
<td class="org-left">设置断点</td>
</tr>

<tr>
<td class="org-left">continue   或 c</td>
<td class="org-left">继续执行程序</td>
</tr>

<tr>
<td class="org-left">list 或 l</td>
<td class="org-left">查看当前行的代码段</td>
</tr>

<tr>
<td class="org-left">step 或 s</td>
<td class="org-left">进入函数</td>
</tr>

<tr>
<td class="org-left">return 或 r</td>
<td class="org-left">执行代码直到从当前函数返回</td>
</tr>

<tr>
<td class="org-left">exit 或 q</td>
<td class="org-left">中止并退出</td>
</tr>

<tr>
<td class="org-left">next 或 n</td>
<td class="org-left">执行下一行</td>
</tr>

<tr>
<td class="org-left">pp</td>
<td class="org-left">打印变量的值</td>
</tr>

<tr>
<td class="org-left">help</td>
<td class="org-left">帮助</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org1b61b1a" class="outline-3">
<h3 id="org1b61b1a"><span class="section-number-3">11.2</span> doctest</h3>
<div class="outline-text-3" id="text-11-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">mytest.py</span>
<span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">square</span><span style="color: #3a81c3;">(</span>x<span style="color: #3a81c3;">)</span>:
    <span style="color: #da8b55;">'''</span>
<span style="color: #da8b55;">    Square a number and returns the result.</span>

<span style="color: #da8b55;">    &gt;&gt;&gt; square(2)</span>
<span style="color: #da8b55;">    4</span>
<span style="color: #da8b55;">    &gt;&gt;&gt; square(3)</span>
<span style="color: #da8b55;">    8</span>
<span style="color: #da8b55;">    '''</span>
    <span style="color: #3a81c3; font-weight: bold;">return</span> x*x

<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">__name__</span>==<span style="color: #2d9574;">'__main__'</span>:
    <span style="color: #3a81c3; font-weight: bold;">import</span> doctest, mytest
    doctest.testmod<span style="color: #3a81c3;">(</span>mytest<span style="color: #3a81c3;">)</span>
</pre>
</div>
<p>
以上例子，doctest.testmod 会检查文档中'&gt;&gt;&gt;'，并执行例子进行检查。
</p>
<pre class="example">
$ python mytest.py

**********************************************************************
File "/home/chrischen/temp/mytest.py", line 7, in mytest.square
Failed example:
    square(3)
Expected:
    8
Got:
    9
**********************************************************************
1 items had failures:
   1 of   2 in mytest.square
***Test Failed*** 1 failures.
</pre>
<p>
python mytest.py -v 可以获得更多输出。
</p>
</div>
</div>
<div id="outline-container-orgd880107" class="outline-3">
<h3 id="orgd880107"><span class="section-number-3">11.3</span> unittest</h3>
<div class="outline-text-3" id="text-11-3">
<p>
假设要写一个模块，my_math，测试其中计算乘积的函数 product。&lt;
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> unittest, my_math
<span style="color: #3a81c3; font-weight: bold;">class</span> <span style="color: #ba2f59; font-weight: bold;">ProductTestCase</span><span style="color: #3a81c3;">(</span>unittest.TestCase<span style="color: #3a81c3;">)</span>:
    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">testIntegers</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">for</span> x <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">xrange</span><span style="color: #3a81c3;">(</span>-10, 10<span style="color: #3a81c3;">)</span>:
	    <span style="color: #3a81c3; font-weight: bold;">for</span> y <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">xrange</span><span style="color: #3a81c3;">(</span>-10, 10<span style="color: #3a81c3;">)</span>:
		<span style="color: #715ab1;">p</span>=my_math.product<span style="color: #3a81c3;">(</span>x, y<span style="color: #3a81c3;">)</span>
		<span style="color: #3a81c3; font-weight: bold;">self</span>.failUnless<span style="color: #3a81c3;">(</span>p == x*y, <span style="color: #2d9574;">'Integer multiplication failed'</span><span style="color: #3a81c3;">)</span>

    <span style="color: #3a81c3; font-weight: bold;">def</span> <span style="color: #6c3163; font-weight: bold;">testFloats</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">self</span><span style="color: #3a81c3;">)</span>:
	<span style="color: #3a81c3; font-weight: bold;">for</span> x <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">xrange</span><span style="color: #3a81c3;">(</span>-10, 10<span style="color: #3a81c3;">)</span>:
	    <span style="color: #3a81c3; font-weight: bold;">for</span> y <span style="color: #3a81c3; font-weight: bold;">in</span> <span style="color: #3a81c3;">xrange</span><span style="color: #3a81c3;">(</span>-10, 10<span style="color: #3a81c3;">)</span>:
		<span style="color: #715ab1;">x</span> = x/10.0
		<span style="color: #715ab1;">y</span> = y/10.0
		<span style="color: #715ab1;">p</span> = my_math.product<span style="color: #3a81c3;">(</span>x, y<span style="color: #3a81c3;">)</span>
		<span style="color: #3a81c3; font-weight: bold;">self</span>.failUnless<span style="color: #3a81c3;">(</span>p == x*y, <span style="color: #2d9574;">'Float multiplication failed'</span><span style="color: #3a81c3;">)</span>

    <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">__name__</span> == <span style="color: #2d9574;">'__main__'</span>: unittest.main<span style="color: #3a81c3;">()</span>
</pre>
</div>
<p class="verse">
unittest.main()负责实例化所有 unittest.TestCase 的子类，运行所有名字以 test 开头的函数。<br />
failUnless 检查结果给出错误提示。下表列出其他的检查方法：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">assert_(expr[, msg]), failUnless</td>
<td class="org-left">如果表达式为假则失败</td>
</tr>

<tr>
<td class="org-left">failIf(expr[, msg])</td>
<td class="org-left">与 assert 相反</td>
</tr>

<tr>
<td class="org-left">assertEqual(x, y[, msg]), failUnlessEqual</td>
<td class="org-left">两个值不同则失败</td>
</tr>

<tr>
<td class="org-left">assertNotEqual(x, y[,msg]), failIfEqual</td>
<td class="org-left">两个值相同则失败</td>
</tr>

<tr>
<td class="org-left">assertAlmostEqual(x,y[, places[,msg]]), failUnlessAlmostEqual</td>
<td class="org-left">类似于 assertEqual，处理 float 的方式上不同</td>
</tr>

<tr>
<td class="org-left">assertNotAlmostEqual(x,y[, places[,msg]]), failIfAlmostEqual</td>
<td class="org-left">与 assertAlmostEqual 相反</td>
</tr>

<tr>
<td class="org-left">assertRaises(exc, callable, &#x2026;), failUnlessRaises</td>
<td class="org-left">调用 callable，引发 exc 异常，则成功；否则失败</td>
</tr>

<tr>
<td class="org-left">fail([msg])</td>
<td class="org-left">无条件失败</td>
</tr>
</tbody>
</table>
<p>
unittest 模块会区分由异常引发的错误和调用 failUnless 而导致的失败。
</p>
</div>
</div>
<div id="outline-container-orge22d6c5" class="outline-3">
<h3 id="orge22d6c5"><span class="section-number-3">11.4</span> 代码检查</h3>
<div class="outline-text-3" id="text-11-4">
</div>
<div id="outline-container-org571167c" class="outline-4">
<h4 id="org571167c"><span class="section-number-4">11.4.1</span> PyLint</h4>
<div class="outline-text-4" id="text-11-4-1">
<p class="verse">
需先安装 astng 和 logilab-common<br />
安装方式都是：python setup.py install<br />
使用 pylint modulename：<br />
python my_math<br />
报告包含：Raw metrics、Statistics by type、Duplication、Messages by category、Messages、Global evaluation<br />
PyLint 的更多功能<br />
</p>
<ul class="org-ul">
<li>pyreverse: an UML diagram generator</li>
<li>symilar: an independent similarities checker</li>
<li><b>epylint</b>: Emacs and Flymake compatible Pylint</li>
<li>pylint-gui: a graphical interface</li>
</ul>
<p class="verse">
还可以选择 PyChecker，更老牌的代码检查工具。<br />
在 Python 中使用命令行工具的方式是使用 subprocess 模块。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org8977b3e" class="outline-3">
<h3 id="org8977b3e"><span class="section-number-3">11.5</span> 性能测试</h3>
<div class="outline-text-3" id="text-11-5">
</div>
<div id="outline-container-orgaa18a86" class="outline-4">
<h4 id="orgaa18a86"><span class="section-number-4">11.5.1</span> profile 模块(标准库)</h4>
<div class="outline-text-4" id="text-11-5-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> profile
<span style="color: #3a81c3; font-weight: bold;">from</span> my_math <span style="color: #3a81c3; font-weight: bold;">import</span> product
profile.run<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'product(1, 2)'</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
<p>
结果如下：
</p>
<pre class="example">
4 function calls in 0.024 seconds

Ordered by: standard name

ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1    0.024    0.024    0.024    0.024 :0(setprofile)
     1    0.000    0.000    0.000    0.000 &lt;string&gt;:1(&lt;module&gt;)
     1    0.000    0.000    0.000    0.000 my_math.py:1(product)
     1    0.000    0.000    0.024    0.024 profile:0(product(1, 2))
     0    0.000             0.000          profile:0(profiler)
</pre>
<ul class="org-ul">
<li>还可以以编程的方式分析结果</li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">import</span> pstats
<span style="color: #715ab1;">p</span> = pstats.Stats<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'my_math.profile'</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
<p>
对 p 对象进行分析即可。
</p>
<ul class="org-ul">
<li>另一个选择 hotshot 模块</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org6f77055" class="outline-3">
<h3 id="org6f77055"><span class="section-number-3">11.6</span> 其他可选工具</h3>
<div class="outline-text-3" id="text-11-6">
<p>
py.test, nose, trace.py(覆盖率), PyUnit(GUI 单元测试)
</p>
</div>
</div>
</div>
<div id="outline-container-org0d4fe58" class="outline-2">
<h2 id="org0d4fe58"><span class="section-number-2">12</span> 发布程序</h2>
<div class="outline-text-2" id="text-12">
</div>
<div id="outline-container-orgb90c06e" class="outline-3">
<h3 id="orgb90c06e"><span class="section-number-3">12.1</span> 制作安装脚本</h3>
<div class="outline-text-3" id="text-12-1">
<p>
使用 distutils 模块编写 setup.py
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">from</span> distutils.core <span style="color: #3a81c3; font-weight: bold;">import</span> setup
setup<span style="color: #3a81c3;">(</span>name=<span style="color: #2d9574;">'my_math'</span>,
      version=<span style="color: #2d9574;">'1.0'</span>,
      description=<span style="color: #2d9574;">'A simple example'</span>,
      author=<span style="color: #2d9574;">'ChrisChen'</span>,
      py_modules=<span style="color: #6c3163;">[</span><span style="color: #2d9574;">'my_math'</span><span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
<pre class="example">
python setup.py install
</pre>
<p class="verse">
setuptools 项目基于 distutils，但提供了更多的功能。<br />
另外，目前为止，没有标准的 Uninstall 命令。需要手动卸载。<br />
</p>
</div>
</div>
<div id="outline-container-org458dc93" class="outline-3">
<h3 id="org458dc93"><span class="section-number-3">12.2</span> 制作安装包</h3>
<div class="outline-text-3" id="text-12-2">
<ul class="org-ul">
<li>使用命令制作压缩包：</li>
</ul>
<pre class="example">
python setup.py sdist
</pre>
<ul class="org-ul">
<li>关于 MANIFEST 文件</li>
</ul>
<p class="verse">
在创建发布程序的时候，程序同时自动创建 MANIFEST 文件，该文件<br />
包含所有文件的列表。<br />
在此之前可以提供 MANIFEST.in 文件作为输入，此文件时 MANIFEST 的模板。<br />
可以用如下命令来指定需要包含的文件。<br />
</p>
<pre class="example">
include somedir/somefile.txt
include somedir/*
</pre>
<ul class="org-ul">
<li>MANIFEST 的更新</li>
</ul>
<p class="verse">
当需发布的文件目录发生改变时，需要手动删除由发布程序自动生成的 MANIFEST<br />
文件，要不然发布程序会直接读取之前的 MANIFEST 文件，而不会重新生成。<br />
</p>
<ul class="org-ul">
<li>Windows 发布</li>
</ul>
<pre class="example">
python setup.py bdist --format=wininst
</pre>
<p>
直接产生一个 win32exe 文件。注意用此方式发布的安装包非常基础。
</p>
<ul class="org-ul">
<li>Linux RPM 发布</li>
</ul>
<pre class="example">
python setup.py bdist --format=rpm
</pre>
</div>
</div>
<div id="outline-container-org36c6f00" class="outline-3">
<h3 id="org36c6f00"><span class="section-number-3">12.3</span> py2exe</h3>
<div class="outline-text-3" id="text-12-3">
<p class="verse">
py2exe 直接将 python 运行环境打包，用户不必单独安装 python 解释器。<br />
配合 Inno Setup 可完成“真正的安装程序”。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org2e79f14" class="outline-2">
<h2 id="org2e79f14"><span class="section-number-2">13</span> 实用的内建函数</h2>
<div class="outline-text-2" id="text-13">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">函数</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">dir([obj])</td>
<td class="org-left">显示对象的属性，参数省略时，显示全局变量名</td>
</tr>

<tr>
<td class="org-left">help([obj])</td>
<td class="org-left">显示对象的文档字符串</td>
</tr>

<tr>
<td class="org-left">int(obj)</td>
<td class="org-left">将一个对象转换为整形</td>
</tr>

<tr>
<td class="org-left">len(obj)</td>
<td class="org-left">返回对象的长度</td>
</tr>

<tr>
<td class="org-left">open(fn, mode)</td>
<td class="org-left">以相应的 mode 方式(r 读 w 写)打开一个文件名为 fn 的文件</td>
</tr>

<tr>
<td class="org-left">range([start,] stop [,step]</td>
<td class="org-left">返回整数列表，起始值 start，结束值 stop-1，步长 step</td>
</tr>

<tr>
<td class="org-left">raw_input([str])</td>
<td class="org-left">等待用户输入一个字符串，str 为提示信息</td>
</tr>

<tr>
<td class="org-left">str(obj)</td>
<td class="org-left">将一个对象转换为字符串</td>
</tr>

<tr>
<td class="org-left">type(obj)</td>
<td class="org-left">返回对象的类型(返回值本身是一个 type 对象)</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-orgcfa74aa" class="outline-3">
<h3 id="orgcfa74aa"><span class="section-number-3">13.1</span> pass</h3>
<div class="outline-text-3" id="text-13-1">
<p class="verse">
pass 函数什么事情都不做 用作预留占位符<br />
python 空代码块是非法的。需要如下做：<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">if</span> x==0:
    <span style="color: #3a81c3; font-weight: bold;">pass</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6c90c28" class="outline-3">
<h3 id="org6c90c28"><span class="section-number-3">13.2</span> del</h3>
<div class="outline-text-3" id="text-13-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">x</span>=1
<span style="color: #3a81c3; font-weight: bold;">del</span> x
x
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&#25253;&#38169;&#65292;del &#19981;&#20294;&#21024;&#38500;&#20869;&#23481;&#65292;&#20063;&#21024;&#38500;&#21464;&#37327;&#21517;</span>
<span style="color: #715ab1;">x</span>=1
<span style="color: #715ab1;">y</span>=x
<span style="color: #3a81c3; font-weight: bold;">del</span> x
y
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;1 &#21407;&#22240;&#65306;&#35813;&#24773;&#20917; del &#21482;&#21024;&#38500;&#20102;&#21517;&#31216;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org148672d" class="outline-3">
<h3 id="org148672d"><span class="section-number-3">13.3</span> exec 和 eval</h3>
<div class="outline-text-3" id="text-13-3">
<ul class="org-ul">
<li>exec</li>
</ul>
<p class="verse">
exec 执行字符串中的 python 语句<br />
(风险极大，慎重，并且是很严重的安全漏洞)<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">exec</span> <span style="color: #2d9574;">"print 'Hello,world!'"</span>
</pre>
</div>
<p>
字符串代码，单独一个命名空间
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">scope</span>=<span style="color: #3a81c3;">{}</span>
<span style="color: #3a81c3; font-weight: bold;">exec</span> <span style="color: #2d9574;">'sqrt = 1'</span> <span style="color: #3a81c3; font-weight: bold;">in</span> scope
scope<span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'sqrt'</span><span style="color: #3a81c3;">]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;1</span>
<span style="color: #3a81c3;">len</span><span style="color: #3a81c3;">(</span>scope<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;2</span>
scope.keys<span style="color: #3a81c3;">()</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt; ['sqrt', '__builtins__']</span>
</pre>
</div>
<ul class="org-ul">
<li>eval</li>
</ul>
<p class="verse">
eval 会计算 python 表达式(字符串形式书写)，返回结果值<br />
赋值语句不能使用 eval(抛出 SyntaxError)，只能用 exec 执行<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">eval</span><span style="color: #3a81c3;">(</span><span style="color: #3a81c3;">raw_input</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">'Enter an arithmetic expression: '</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
</pre>
</div>

<p>
eval 同样也可使用命名空间
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #715ab1;">scope</span> = <span style="color: #3a81c3;">{}</span>
<span style="color: #715ab1;">scope</span><span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'x'</span><span style="color: #3a81c3;">]</span> = 2
<span style="color: #715ab1;">scope</span><span style="color: #3a81c3;">[</span><span style="color: #2d9574;">'y'</span><span style="color: #3a81c3;">]</span> = 3
<span style="color: #3a81c3;">eval</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'x * y'</span>, scope<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;6</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org57647a5" class="outline-2">
<h2 id="org57647a5"><span class="section-number-2">14</span> ipython magicfunc</h2>
<div class="outline-text-2" id="text-14">
</div>
<div id="outline-container-orgf1c5192" class="outline-3">
<h3 id="orgf1c5192"><span class="section-number-3">14.1</span> 常用</h3>
<div class="outline-text-3" id="text-14-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">%quickref</td>
<td class="org-left">Display the IPython Quick Reference Card</td>
</tr>

<tr>
<td class="org-left">%magic</td>
<td class="org-left">Display detailed documentation for all of the available magic commands</td>
</tr>

<tr>
<td class="org-left">%debug</td>
<td class="org-left">Enter the interactive debugger at the bottom of the last exception traceback</td>
</tr>

<tr>
<td class="org-left">%hist</td>
<td class="org-left">Print command input (and optionally output) history</td>
</tr>

<tr>
<td class="org-left">%pdb</td>
<td class="org-left">Automatically enter debugger after any exception</td>
</tr>

<tr>
<td class="org-left">%paste</td>
<td class="org-left">Execute pre-formatted Python code from clipboard</td>
</tr>

<tr>
<td class="org-left">%cpaste</td>
<td class="org-left">Open a special prompt for manually pasting Python code to be executed</td>
</tr>

<tr>
<td class="org-left">%reset</td>
<td class="org-left">Delete all variables / names defined in interactive namespace</td>
</tr>

<tr>
<td class="org-left">%page</td>
<td class="org-left">OBJECT Pretty print the object and display it through a pager</td>
</tr>

<tr>
<td class="org-left">%run</td>
<td class="org-left">script.py Run a Python script inside IPython</td>
</tr>

<tr>
<td class="org-left">%prun</td>
<td class="org-left">statement Execute statement with cProfile and report the profiler output</td>
</tr>

<tr>
<td class="org-left">%time</td>
<td class="org-left">statement Report the execution time of single statement</td>
</tr>

<tr>
<td class="org-left">%timeit</td>
<td class="org-left">statement Run a statement multiple times to compute an emsemble average execution time.</td>
</tr>

<tr>
<td class="org-left">%who, %who_ls, %whos</td>
<td class="org-left">Display variables defined in interactive namespace, with varying levels of information / verbosity</td>
</tr>

<tr>
<td class="org-left">%xdel</td>
<td class="org-left">variable Delete a variable and attempt to clear any references to the object in the IPython internals</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org5fe3092" class="outline-3">
<h3 id="org5fe3092"><span class="section-number-3">14.2</span> log</h3>
<div class="outline-text-3" id="text-14-2">
<p>
%logstart, %logoff, %logon, %logstate, %logstop
</p>
</div>
</div>

<div id="outline-container-orgc182599" class="outline-3">
<h3 id="orgc182599"><span class="section-number-3">14.3</span> system-related</h3>
<div class="outline-text-3" id="text-14-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">!cmd</td>
<td class="org-left">Execute cmd in the system shell</td>
</tr>

<tr>
<td class="org-left">output = !cmd args</td>
<td class="org-left">Run cmd and store the stdout in output</td>
</tr>

<tr>
<td class="org-left">%alias alias_name cmd</td>
<td class="org-left">Define an alias for a system (shell) command</td>
</tr>

<tr>
<td class="org-left">%bookmark</td>
<td class="org-left">Utilize IPython’s directory bookmarking system</td>
</tr>

<tr>
<td class="org-left">%cd</td>
<td class="org-left">Change system working directory to passed directory</td>
</tr>

<tr>
<td class="org-left">%pwd</td>
<td class="org-left">Return the current system working directory</td>
</tr>

<tr>
<td class="org-left">%pushd directory</td>
<td class="org-left">Place current directory on stack and change to target directory</td>
</tr>

<tr>
<td class="org-left">%popd</td>
<td class="org-left">Change to directory popped off the top of the stack</td>
</tr>

<tr>
<td class="org-left">%dirs</td>
<td class="org-left">Return a list containing the current directory stack</td>
</tr>

<tr>
<td class="org-left">%dhist</td>
<td class="org-left">Print the history of visited directories</td>
</tr>

<tr>
<td class="org-left">%env</td>
<td class="org-left">Return the system environment variables as a dict</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org815541d" class="outline-3">
<h3 id="org815541d"><span class="section-number-3">14.4</span> debuger</h3>
<div class="outline-text-3" id="text-14-4">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Command</td>
<td class="org-left">Action</td>
</tr>

<tr>
<td class="org-left">h(elp)</td>
<td class="org-left">Display command list</td>
</tr>

<tr>
<td class="org-left">help command</td>
<td class="org-left">Show documentation for command</td>
</tr>

<tr>
<td class="org-left">c(ontinue)</td>
<td class="org-left">Resume program execution</td>
</tr>

<tr>
<td class="org-left">q(uit)</td>
<td class="org-left">Exit debugger without executing any more code</td>
</tr>

<tr>
<td class="org-left">b(reak)</td>
<td class="org-left">number Set breakpoint at number in current file</td>
</tr>

<tr>
<td class="org-left">b path/to/file.py:number</td>
<td class="org-left">Set breakpoint at line number in specified file</td>
</tr>

<tr>
<td class="org-left">s(tep)</td>
<td class="org-left">Step into function call</td>
</tr>

<tr>
<td class="org-left">n(ext)</td>
<td class="org-left">Execute current line and advance to next line at current level</td>
</tr>

<tr>
<td class="org-left">u(p) / d(own)</td>
<td class="org-left">Move up/down in function call stack</td>
</tr>

<tr>
<td class="org-left">a(rgs)</td>
<td class="org-left">Show arguments for current function</td>
</tr>

<tr>
<td class="org-left">debug statement</td>
<td class="org-left">Invoke statement statement in new (recursive) debugger</td>
</tr>

<tr>
<td class="org-left">l(ist) statement</td>
<td class="org-left">Show current position and context at current level of stack</td>
</tr>

<tr>
<td class="org-left">w(here)</td>
<td class="org-left">Print full stack trace with context at current position</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org3c55767" class="outline-3">
<h3 id="org3c55767"><span class="section-number-3">14.5</span> %lprun</h3>
<div class="outline-text-3" id="text-14-5">
<pre class="example">
%lprun -f func1 -f func2 statement_to_profile
</pre>
</div>
</div>
</div>

<div id="outline-container-org0db8454" class="outline-2">
<h2 id="org0db8454"><span class="section-number-2">15</span> 一些提示</h2>
<div class="outline-text-2" id="text-15">
</div>
<div id="outline-container-org01af2c0" class="outline-4">
<h4 id="org01af2c0"><span class="section-number-4">15.0.1</span> 关于变量作用域</h4>
<div class="outline-text-4" id="text-15-0-1">
<p class="verse">
python2.1 以前，支持三种作用域，分别为局部、全局、内置作用域<br />
2.1 实现了对闭包的支持，引入了嵌套作用域。<br />
变量的查找顺序为 LEGB(Local, Enclosing, Global, Built-in)<br />
</p>
</div>
</div>
<div id="outline-container-org77a45b2" class="outline-4">
<h4 id="org77a45b2"><span class="section-number-4">15.0.2</span> input 与 raw_input</h4>
<div class="outline-text-4" id="text-15-0-2">
<p class="verse">
input 只支持合法的 python 表达式<br />
raw_input 所有输入以字符串形式作为原始数据 尽可能使用 raw_input<br />
</p>
</div>
</div>
<div id="outline-container-org9e8e483" class="outline-4">
<h4 id="org9e8e483"><span class="section-number-4">15.0.3</span> 长字符串 跨越多行</h4>
<div class="outline-text-4" id="text-15-0-3">
<p class="verse">
使用三个单引号或者三个双引号<br />
''' blablabla<br />
blablabla&#x2026;'''<br />
注：三引号内的单引号和双引号，可以不用转义符号<br />
</p>
</div>
</div>
<div id="outline-container-orga140292" class="outline-4">
<h4 id="orga140292"><span class="section-number-4">15.0.4</span> 普通字符串忽略代码中的换行符</h4>
<div class="outline-text-4" id="text-15-0-4">
<p>
换行处加上\
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #da8b55;">" 1 + 2 + \</span>
<span style="color: #da8b55;">4 + 5"</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;"1 + 2 + 4 + 5"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7c09ec5" class="outline-4">
<h4 id="org7c09ec5"><span class="section-number-4">15.0.5</span> 关于表示路径的转义</h4>
<div class="outline-text-4" id="text-15-0-5">
<div class="org-src-container">
<pre class="src src-python">r<span style="color: #da8b55;">'C:\TestFolder\test.txt'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge93d676" class="outline-4">
<h4 id="orge93d676"><span class="section-number-4">15.0.6</span> Unicode 字符串</h4>
<div class="outline-text-4" id="text-15-0-6">
<div class="org-src-container">
<pre class="src src-python">u<span style="color: #da8b55;">'Hello World!'</span>
</pre>
</div>
<p>
在 python 3.0 以上，所有字符串都为 unicode 字符串
</p>
</div>
</div>
<div id="outline-container-orgf603b24" class="outline-4">
<h4 id="orgf603b24"><span class="section-number-4">15.0.7</span> 使用逗号打印多个表达式</h4>
<div class="outline-text-4" id="text-15-0-7">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">print</span> <span style="color: #2d9574;">'Age'</span>, 42, <span style="color: #2d9574;">'?'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbd039b6" class="outline-4">
<h4 id="orgbd039b6"><span class="section-number-4">15.0.8</span> ASCII 码转换</h4>
<div class="outline-text-4" id="text-15-0-8">
<p>
chr(n) &amp; ord(c)
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3;">chr</span><span style="color: #3a81c3;">(</span>number<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&#23545;&#24212;&#30340; char</span>
<span style="color: #3a81c3;">ord</span><span style="color: #3a81c3;">(</span>char<span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">#</span><span style="color: #2aa1ae; background-color: #ecf3ec;">=&gt;&#23545;&#24212;&#30340; ASCII &#30721;&#32534;&#21495;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf3aef49" class="outline-4">
<h4 id="orgf3aef49"><span class="section-number-4">15.0.9</span> 检查特性是否为字符串</h4>
<div class="outline-text-4" id="text-15-0-9">
<p class="verse">
通过和字符串拼接来检查参数类型是否为字符串<br />
以下代码检查参数如果是字符串，是则抛出异常。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #3a81c3; font-weight: bold;">try</span>: var + <span style="color: #2d9574;">' '</span>
<span style="color: #3a81c3; font-weight: bold;">except</span> <span style="color: #ba2f59; font-weight: bold;">TypeError</span>: <span style="color: #3a81c3; font-weight: bold;">pass</span>
<span style="color: #3a81c3; font-weight: bold;">else</span>: <span style="color: #3a81c3; font-weight: bold;">raise</span> <span style="color: #ba2f59; font-weight: bold;">TypeError</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcf61738" class="outline-4">
<h4 id="orgcf61738"><span class="section-number-4">15.0.10</span> python 虚拟环境</h4>
<div class="outline-text-4" id="text-15-0-10">
<p>
可使用 virtualenv，适用情况：
</p>
<ol class="org-ol">
<li>使用多个 python 版本进行开发，环境变量只能设一个。</li>
<li>site-packages 在多人共享的开发机上，没有写入权限。</li>
</ol>
</div>
</div>
<div id="outline-container-org2236444" class="outline-4">
<h4 id="org2236444"><span class="section-number-4">15.0.11</span> 推荐工具包</h4>
<div class="outline-text-4" id="text-15-0-11">
<p>
ipython, pip, virtualenv, pylint(logilab_astng, logilab_common), py2exe, pyQt
</p>
<ul class="org-ul">
<li>pip 常用命令</li>
</ul>
<p class="verse">
pip install SomePackage==1.0<br />
pip show &#x2013;files SomePackage<br />
pip list &#x2013;outdated<br />
pip install &#x2013;upgrade SomePackage<br />
pip uninstall SomePackage<br />
</p>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">&#33050;&#27880;: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
最常用的例子：'\\'.join(dirs)
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
range(1,100)实际是 1~99
</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3">3</a></sup> <div class="footpara"><p class="footpara">
函数经过编译的 bytecode，实际上放在 func.func_code.co_code 中，dis 模块对其做了解析，使其更容易阅读。
</p></div></div>


</div>
</div></div>
</body>
</html>
